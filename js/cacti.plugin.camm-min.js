Ext.overrideIf=function(a,c){if(c){var b=a.prototype;for(var d in c){if(!b[d]){b[d]=c[d]}}}};Ext.PagingToolbar.override({updateInfo:function(){if(this.displayItem){var a=this.store.getCount();if(this.store.start_time===undefined){var c=0}else{var c=this.store.start_time.getElapsed()}var b=a==0?this.emptyMsg:String.format(this.displayMsg,this.cursor+1,this.cursor+a,this.store.getTotalCount(),Math.round(c/10)/100,Math.round(c/a*100)/100);this.displayItem.setText(b)}}});Ext.override(Ext.form.ComboBox,{setValue:function(a){if(this.store.getCount()==0){this.store.on("load",this.setValue.createDelegate(this,[a]),null,{single:true});return}var c=a;if(this.valueField){var b=this.findRecord(this.valueField,a);if(b){c=b.data[this.displayField]}else{if(this.valueNotFoundText!==undefined){c=this.valueNotFoundText}}}this.lastSelectionText=c;if(this.hiddenField){this.hiddenField.value=a}Ext.form.ComboBox.superclass.setValue.call(this,c);this.value=a}});Ext.override(Ext.form.FieldSet,{onCollapse:function(){Ext.form.FieldSet.superclass.onCollapse.apply(this,arguments);if(this.items){this.items.each(function(a){if(a instanceof Ext.form.Field){a.disable()}},this)}},onExpand:function(){Ext.form.FieldSet.superclass.onExpand.apply(this,arguments);if(this.items){this.items.each(function(a){if(a instanceof Ext.form.Field){a.enable()}},this)}}});Ext.override(Ext.Element,{findParent:function(k,d,c){var a=this.dom,j=document.body,g=0,f=Ext.DomQuery,l;d=d||50;if(typeof d!="number"){l=Ext.getDom(d);d=10}try{while(a&&a.nodeType==1&&g<d&&a!=j&&a!=l){if(f.is(a,k)){return c?Ext.get(a):a}g++;a=a.parentNode}}catch(h){}return null}});Ext.overrideIf(Array,{copy:function(){var c=[];for(var d=0,b=this.length;d<b;d++){c.push(this[d])}return c},indexOf:function(d,a){for(var e=+a||0,c=this.length;e<c;e++){if(this[e]===d){return e}}return -1},intersect:function(){if(!arguments.length){return[]}var e=this,b,d;for(var f=0,h=arguments.length;f<h;f++){d=[];b=arguments[f]||[];for(var g=0,c=e.length;g<c;g++){if(-1<b.indexOf(e[g])){d.push(e[g])}}e=d}return d.unique()},lastIndexOf:function(c,a){a=+a||0;var d=this.length;while(d-->a){if(this[d]===c){return d}}return -1},union:function(){var d=this.copy(),c;for(var e=0,g=arguments.length;e<g;e++){c=arguments[e]||[];for(var f=0,b=c.length;f<b;f++){d.push(c[f])}}return d.unique()},unique:function(){var c=[],d,b=this.length;for(d=0;d<b;d++){if(c.indexOf(this[d])<0){c.push(this[d])}}return c},contains:function(b){for(var a=0;a<this.length;++a){if(this[a]===b){return true}}return false},sub_contains:function(b){for(var a=0;a<this.length;++a){if(this[a][0]===b){return true}}return false}});Ext.namespace("Ext.ux.Andrie");Ext.ux.Andrie.pPageSize=function(a){Ext.apply(this,a)};Ext.extend(Ext.ux.Andrie.pPageSize,Ext.util.Observable,{beforeText:"Show",afterText:"",addBefore:"-",addAfter:null,dynamic:false,variations:[5,10,20,50,100,200,500,1000],comboCfg:undefined,position:11,init:function(a){this.pagingToolbar=a;this.pagingToolbar.pageSizeCombo=this;this.pagingToolbar.setPageSize=this.setPageSize.createDelegate(this);this.pagingToolbar.getPageSize=function(){return this.pageSize};this.pagingToolbar.on("render",this.onRender,this)},addSize:function(a){if(a>0){this.sizes.push([a])}},updateStore:function(){if(this.dynamic){var b=this.pagingToolbar.pageSize,e;b=(b>0)?b:1;this.sizes=[];var c=this.variations;for(var d=0,a=c.length;d<a;d++){this.addSize(b-c[c.length-1-d])}this.addToStore(b);for(var d=0,a=c.length;d<a;d++){this.addSize(b+c[d])}}else{if(!this.staticSizes){this.sizes=[];var c=this.variations;var b=0;for(var d=0,a=c.length;d<a;d++){this.addSize(b+c[d])}this.staticSizes=this.sizes.slice(0)}else{this.sizes=this.staticSizes.slice(0)}}this.combo.store.loadData(this.sizes);this.combo.collapse();this.combo.setValue(this.pagingToolbar.pageSize)},setPageSize:function(f,j){var k=this.pagingToolbar;this.combo.collapse();f=parseInt(f)||parseInt(this.combo.getValue());f=(f>0)?f:1;if(f==k.pageSize){return}else{if(f<k.pageSize){k.pageSize=f;var a=Math.round(k.cursor/f)+1;var h=(a-1)*f;var g=k.store;if(h>g.getTotalCount()){this.pagingToolbar.pageSize=f;this.pagingToolbar.doLoad(h-f)}else{g.suspendEvents();for(var b=0,c=h-k.cursor;b<c;b++){g.remove(g.getAt(0))}while(g.getCount()>f){g.remove(g.getAt(g.getCount()-1))}g.resumeEvents();g.fireEvent("datachanged",g);k.cursor=h;var e=k.getPageData();k.afterTextItem.setText(String.format(k.afterPageText,e.pages));k.inputItem.setValue(a);k.first.setDisabled(a==1);k.prev.setDisabled(a==1);k.next.setDisabled(a==e.pages);k.last.setDisabled(a==e.pages);k.updateInfo()}}else{this.pagingToolbar.pageSize=f;this.pagingToolbar.doLoad(Math.floor(this.pagingToolbar.cursor/this.pagingToolbar.pageSize)*this.pagingToolbar.pageSize)}}this.updateStore()},onRender:function(){this.combo=Ext.ComponentMgr.create(Ext.applyIf(this.comboCfg||{},{store:new Ext.data.SimpleStore({fields:["pageSize"],data:[]}),displayField:"pageSize",valueField:"pageSize",mode:"local",triggerAction:"all",width:50,xtype:"combo"}));this.combo.on("select",this.setPageSize,this);this.updateStore();if(this.addBefore){this.pagingToolbar.insert(this.position,this.addBefore);this.position++}if(this.beforeText){this.pagingToolbar.insert(this.position,this.beforeText);this.position++}this.pagingToolbar.insert(this.position,this.combo);this.position++;if(this.afterText){this.pagingToolbar.insert(this.position,this.afterText);this.position++}if(this.addAfter){this.pagingToolbar.insert(this.position,this.addAfter)}}});Ext.ux.Andrie.AutoRefresher=function(a){Ext.apply(this,a)};Ext.extend(Ext.ux.Andrie.AutoRefresher,Ext.util.Observable,{intervals:[[0.2],[0.5],[1],[5],[10],[15],[30],[60]],beforeText:"Ref-h",afterText:"m.",addBefore:"-",addAfter:null,position:11,init:function(a){this.Toolbar=a;if(a.store){this.store=a.store}a.on("render",this.onRender,this);this.store.startAutoRefresh=function(b){if(this.autoRefreshProcId){clearInterval(this.autoRefreshProcId)}this.autoRefreshProcId=setInterval(this.reload.createDelegate(this,[{}]),b*1000)};this.store.stopAutoRefresh=function(){if(this.autoRefreshProcId){clearInterval(this.autoRefreshProcId)}}},update:function(b){var a=b.getValue();if(a>0){this.store.startAutoRefresh(a*60)}else{this.store.stopAutoRefresh()}},public_update:function(a){if(a>0){if(this.intervals.sub_contains(a)){this.store.startAutoRefresh(a*60);this.combo.setValue(a)}}else{this.store.stopAutoRefresh()}},onRender:function(){this.intervals.unshift([""]);var a={maskRe:/^d*$/,store:new Ext.data.SimpleStore({fields:["autoRefresh"],data:this.intervals}),displayField:"autoRefresh",typeAhead:true,mode:"local",emptyText:"never",triggerAction:"all",selectOnFocus:true,width:50,listeners:{scope:this,keyup:function(d,c){var b=c.getKey();switch(b){case Ext.EventObject.ENTER:this.update(d)}}}};Ext.apply(a,this.comboCfg);this.combo=new Ext.form.ComboBox(a);this.combo.on("change",this.update,this);this.combo.on("select",this.update,this);if(this.addBefore){this.Toolbar.insert(this.position,this.addBefore);this.position++}if(this.beforeText){this.Toolbar.insert(this.position,this.beforeText);this.position++}this.Toolbar.insert(this.position,this.combo);this.position++;if(this.afterText){this.Toolbar.insert(this.position,this.afterText);this.position++}if(this.addAfter){this.Toolbar.insert(this.position,this.addAfter)}}});Ext.namespace("Ext.ux.grid");Ext.ux.grid.PageSizer=Ext.extend(Ext.CycleButton,{initialSize:this.initialSize||15,pageSizes:this.pageSizes||[10,15,20,25,30,50,75,100],addText:"&nbsp;rows per page",initComponent:function(){var c=[];var a=this.addText;var b=this.initialSize;Ext.each(this.pageSizes,function(d){c.push({text:"&nbsp;"+d+a,value:d,checked:d==b?true:false})});Ext.apply(this,{showText:true,prependText:"&nbsp;",forceIcon:"PageSizer_icon",items:c});Ext.ux.grid.PageSizer.superclass.initComponent.apply(this,arguments)},init:function(a){a.on("render",this.onInitView,this)},onInitView:function(a){a.insert(12,this);a.insert(12,"-");this.on("change",this.onPageSizeChanged,a)},onPageSizeChanged:function(a){this.pageSize=parseInt(a.getActiveItem().value);this.doLoad(0)}});if(Ext.ux.grid.PageSizer){Ext.ux.grid.PageSizer.prototype.addText="&nbsp;rows per page"}Ext.namespace("Ext.ux.layout");Ext.ux.layout.RowFitLayout=Ext.extend(Ext.layout.ContainerLayout,{monitorResize:true,trackChildEvents:["collapse","expand","hide","show"],renderAll:function(a,b){Ext.ux.layout.RowFitLayout.superclass.renderAll.apply(this,arguments);a.on("add",this.containerListener);a.on("remove",this.containerListener)},renderItem:function(f,a,d){Ext.ux.layout.RowFitLayout.superclass.renderItem.apply(this,arguments);for(var b=0,e=this.trackChildEvents.length;b<e;b++){f.on(this.trackChildEvents[b],this.itemListener)}f.animCollapse=false;f.rowFit={hasAbsHeight:false,relHeight:0,calcRelHeight:0,calcAbsHeight:0};if(f.height){if(typeof f.height=="string"&&f.height.indexOf("%")){f.rowFit.relHeight=parseInt(f.height)}else{f.setHeight(f.height);f.rowFit.hasAbsHeight=true}}},onLayout:function(g,h){Ext.ux.layout.RowFitLayout.superclass.onLayout.call(this,g,h);if(this.container.collapsed||!g.items||!g.items.length){return}var b=0,m=0,k=1,j=[],o=0;for(var e=0,a=g.items.length;e<a;e++){var l=g.items.itemAt(e);if(!l.isVisible()){continue}if(l.collapsed){b+=l.getFrameHeight()}else{if(l.rowFit.hasAbsHeight){b+=l.height}else{if(!l.rowFit.relHeight){o++}else{m+=l.rowFit.relHeight}j.push(l)}}}if(o==0&&m!=100){k=100/m}var q=h.getStyleSize().height-b,d=q;while(j.length){var l=j.shift(),f=l.rowFit.relHeight*k,p=0;if(!f){f=(100-m)/o}if(!j.length){p=d}else{p=Math.round(q*f/100)}if(p<0){p=0}l.rowFit.calcAbsHeight=p;l.rowFit.calcRelHeight=f;l.setHeight(p);d-=p}},itemListener:function(a){a.ownerCt.doLayout()},containerListener:function(a){a.doLayout()}});if(Ext.SplitBar.BasicLayoutAdapter){Ext.ux.layout.RowFitLayout.SplitAdapter=function(c){if(c&&c.el.dom.nextSibling){var b=Ext.getCmp(c.el.dom.nextSibling.id),a=Ext.getCmp(c.resizingEl.id);if(b){c.maxSize=(a.height||a.rowFit.calcAbsHeight)+b.getInnerHeight()-1}c.minSize=a.getFrameHeight()+1}};Ext.extend(Ext.ux.layout.RowFitLayout.SplitAdapter,Ext.SplitBar.BasicLayoutAdapter,{setElementSize:function(f,g,b){var e=Ext.getCmp(f.resizingEl.id);if(!e||e.collapsed||!e.isVisible()){return}if(e.rowFit.hasAbsHeight){e.setHeight(g)}else{if(f.el.dom.nextSibling){var d=Ext.getCmp(f.el.dom.nextSibling.id),l=g-e.rowFit.calcAbsHeight,c=d.rowFit,k=e.rowFit,h=k.calcRelHeight/k.calcAbsHeight,j=h*l;k.relHeight=k.calcRelHeight+j;if(c.hasAbsHeight){var a=d.height-l;d.height=a;d.setHeight(a)}else{c.relHeight=c.calcRelHeight-j}}}e.ownerCt.doLayout()}})}Ext.Container.LAYOUTS["row-fit"]=Ext.ux.layout.RowFitLayout;Ext.apply(Ext.DataView.prototype,{deselect:function(b,a){if(this.isSelected(b)){var b=this.getNode(b);this.selected.removeElement(b);if(this.last==b.viewIndex){this.last=false}Ext.fly(b).removeClass(this.selectedClass);if(!a){this.fireEvent("selectionchange",this,this.selected.elements)}}}});Ext.namespace("Ext.ux.Andrie");Ext.ux.Andrie.Select=function(a){if(a.transform&&typeof a.multiSelect=="undefined"){var b=Ext.getDom(a.transform);a.multiSelect=(Ext.isIE?b.getAttributeNode("multiple").specified:b.hasAttribute("multiple"))}a.hideTrigger2=a.hideTrigger2||a.hideTrigger;Ext.ux.Andrie.Select.superclass.constructor.call(this,a)};Ext.extend(Ext.ux.Andrie.Select,Ext.form.ComboBox,{multiSelect:false,minLength:0,minLengthText:"Minimum {0} items required",maxLength:Number.MAX_VALUE,maxLengthText:"Maximum {0} items allowed",clearTrigger:true,history:false,historyMaxLength:0,separator:",",displaySeparator:",",valueArray:[],rawValueArray:[],initComponent:function(){this.triggerConfig={tag:"span",cls:"x-form-twin-triggers",cn:[{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger1Class},{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger2Class}]};Ext.ux.Andrie.Select.superclass.initComponent.call(this);if(this.multiSelect){this.typeAhead=false;this.editable=false;this.triggerAction="all";this.selectOnFocus=false}if(this.history){this.forceSelection=false}if(this.value){this.setValue(this.value)}},hideTrigger1:true,getTrigger:Ext.form.TwinTriggerField.prototype.getTrigger,initTrigger:Ext.form.TwinTriggerField.prototype.initTrigger,trigger1Class:"x-form-clear-trigger",trigger2Class:"x-form-arrow-trigger",onTrigger2Click:function(){this.onTriggerClick()},onTrigger1Click:function(){this.clearValue()},initList:function(){if(!this.list){var a="x-combo-list";this.list=new Ext.Layer({shadow:this.shadow,cls:[a,this.listClass].join(" "),constrain:false});var b=this.listWidth||Math.max(this.wrap.getWidth(),this.minListWidth);this.list.setWidth(b);this.list.swallowEvent("mousewheel");this.assetHeight=0;if(this.title){this.header=this.list.createChild({cls:a+"-hd",html:this.title});this.assetHeight+=this.header.getHeight()}this.innerList=this.list.createChild({cls:a+"-inner"});this.innerList.on("mouseover",this.onViewOver,this);this.innerList.on("mousemove",this.onViewMove,this);this.innerList.setWidth(b-this.list.getFrameWidth("lr"));if(this.pageSize){this.footer=this.list.createChild({cls:a+"-ft"});this.pageTb=new Ext.PagingToolbar({store:this.store,pageSize:this.pageSize,renderTo:this.footer});this.assetHeight+=this.footer.getHeight()}if(!this.tpl){this.tpl='<tpl for="."><div class="'+a+'-item">{'+this.displayField+"}</div></tpl>"}this.view=new Ext.DataView({applyTo:this.innerList,tpl:this.tpl,singleSelect:true,multiSelect:this.multiSelect,simpleSelect:true,overClass:a+"-cursor",selectedClass:this.selectedClass,itemSelector:this.itemSelector||"."+a+"-item"});this.view.on("click",this.onViewClick,this);this.view.on("beforeClick",this.onViewBeforeClick,this);this.bindStore(this.store,true);if(this.valueArray.length){this.selectByValue(this.valueArray)}if(this.resizable){this.resizer=new Ext.Resizable(this.list,{pinned:true,handles:"se"});this.resizer.on("resize",function(e,c,d){this.maxHeight=d-this.handleHeight-this.list.getFrameWidth("tb")-this.assetHeight;this.listWidth=c;this.innerList.setWidth(c-this.list.getFrameWidth("lr"));this.restrictHeight()},this);this[this.pageSize?"footer":"innerList"].setStyle("margin-bottom",this.handleHeight+"px")}}},initEvents:function(){Ext.form.ComboBox.superclass.initEvents.call(this);this.keyNav=new Ext.KeyNav(this.el,{up:function(a){this.inKeyMode=true;this.hoverPrev()},down:function(a){if(!this.isExpanded()){this.onTriggerClick()}else{this.inKeyMode=true;this.hoverNext()}},enter:function(b){if(this.isExpanded()){this.inKeyMode=true;var a=this.view.indexOf(this.view.lastItem);this.onViewBeforeClick(this.view,a,this.view.getNode(a),b);this.onViewClick(this.view,a,this.view.getNode(a),b)}else{this.onSingleBlur()}return true},esc:function(a){this.collapse()},tab:function(a){this.collapse();return true},home:function(a){this.hoverFirst();return false},end:function(a){this.hoverLast();return false},scope:this,doRelay:function(c,b,a){if(a=="down"||this.scope.isExpanded()){return Ext.KeyNav.prototype.doRelay.apply(this,arguments)}if(a=="enter"||this.scope.isExpanded()){return Ext.KeyNav.prototype.doRelay.apply(this,arguments)}return true},forceKeyDown:true});this.queryDelay=Math.max(this.queryDelay||10,this.mode=="local"?10:250);this.dqTask=new Ext.util.DelayedTask(this.initQuery,this);if(this.typeAhead){this.taTask=new Ext.util.DelayedTask(this.onTypeAhead,this)}if(this.editable!==false){this.el.on("keyup",this.onKeyUp,this)}if(!this.multiSelect){if(this.forceSelection){this.on("blur",this.doForce,this)}this.on("focus",this.onSingleFocus,this);this.on("blur",this.onSingleBlur,this)}this.on("change",this.onChange,this)},doForce:function(){if(this.el.dom.value.length>0){if(this.el.dom.value==this.emptyText){this.clearValue()}else{if(!this.multiSelect){this.el.dom.value=this.lastSelectionText===undefined?"":this.lastSelectionText;this.applyEmptyText()}}}},onLoad:function(){if(!this.hasFocus){return}if(this.store.getCount()>0){this.expand();this.restrictHeight();if(this.lastQuery==this.allQuery){if(this.editable){this.el.dom.select()}this.selectByValue(this.value,true)}else{this.selectNext();if(this.typeAhead&&this.lastKey!=Ext.EventObject.BACKSPACE&&this.lastKey!=Ext.EventObject.DELETE){this.taTask.delay(this.typeAheadDelay)}}}else{this.collapse()}},onSelect:function(a,b){if(this.fireEvent("beforeselect",this,a,b)!==false){this.addValue(a.data[this.valueField||this.displayField]);this.fireEvent("select",this,a,b);if(!this.multiSelect){this.collapse()}}},onSingleFocus:function(){this.oldValue=this.getRawValue()},onSingleBlur:function(){var a=this.findRecord(this.displayField,this.getRawValue());if(a){this.select(this.store.indexOf(a))}if(String(this.oldValue)!=String(this.getRawValue())){this.setValue(this.getRawValue());this.fireEvent("change",this,this.oldValue,this.getRawValue())}this.oldValue=String(this.getRawValue())},onChange:function(){if(!this.clearTrigger){return}if(this.getValue()!=""){this.triggers[0].show()}else{this.triggers[0].hide()}},collapse:function(){this.hoverOut();Ext.ux.Andrie.Select.superclass.collapse.call(this)},expand:function(){Ext.ux.Andrie.Select.superclass.expand.call(this)},onViewOver:function(b,a){if(this.inKeyMode){return}},onViewBeforeClick:function(c,a,b,d){this.preClickSelections=this.view.getSelectedIndexes()},onViewClick:function(f,b,d,g){if(typeof b!="undefined"){var a=this.preClickSelections.indexOf(b);if(a!=-1&&this.multiSelect){this.removeValue(this.store.getAt(b).data[this.valueField||this.displayField]);if(this.inKeyMode){this.view.deselect(b,true)}this.hover(b,true)}else{var c=this.store.getAt(b);if(c){if(this.inKeyMode){this.view.select(b,true)}this.onSelect(c,b);this.hover(b,true)}}}if(f!==false){this.el.focus()}},addValue:function(b){if(!this.multiSelect){this.setValue(b);return}if(b instanceof Array){b=b[0]}b=String(b);if(this.valueArray.indexOf(b)==-1){var e=b;var c=this.findRecord(this.valueField||displayField,b);if(c){e=c.data[this.displayField];if(this.view){this.select(this.store.indexOf(c))}}else{if(this.forceSelection){return}}var a=Ext.apply([],this.valueArray);a.push(b);var d=Ext.apply([],this.rawValueArray);d.push(e);b=a.join(this.separator||",");e=d.join(this.displaySeparator||this.separator||",");this.commonChangeValue(b,e,a,d)}},removeValue:function(b){if(b instanceof Array){b=b[0]}b=String(b);if(this.valueArray.indexOf(b)!=-1){var e=b;var c=this.findRecord(this.valueField||displayField,b);if(c){e=c.data[this.displayField];if(this.view){this.deselect(this.store.indexOf(c))}}else{if(this.forceSelection){return}}var a=Ext.apply([],this.valueArray);a.remove(b);var d=Ext.apply([],this.rawValueArray);d.remove(e);b=a.join(this.separator||",");e=d.join(this.displaySeparator||this.separator||",");this.commonChangeValue(b,e,a,d)}},setValue:function(c){var b=[],h=[];if(c!==null){if(!(c instanceof Array)){if(this.separator&&this.separator!==true){c=c.split(String(this.separator))}else{c=[c]}}else{if(!this.multiSelect){c=c.slice(0,1)}}for(var d=0,a=c.length;d<a;d++){var f=c[d];var g=null;if(this.valueField){var e=this.findRecord(this.valueField||this.displayField,f);if(e){g=e.data[this.displayField]}else{if(this.forceSelection){continue}else{var e=this.findRecord(this.displayField,f);g=f;if(e){f=e.data[this.valueField]}}}}b.push(f);h.push(g)}}c=b.join(this.separator||",");g=h.join(this.displaySeparator||this.separator||",");this.commonChangeValue(c,g,b,h);if(this.history&&!this.multiSelect&&this.mode=="local"){this.addHistory(this.valueField?this.getValue():this.getRawValue())}if(this.view){this.view.clearSelections();this.selectByValue(this.valueArray)}},commonChangeValue:function(b,d,a,c){this.lastSelectionText=d;this.valueArray=a;this.rawValueArray=c;if(this.hiddenField){this.hiddenField.value=b}Ext.form.ComboBox.superclass.setValue.call(this,d);this.value=b;if(this.oldValueArray!=this.valueArray){this.fireEvent("change",this,this.oldValueArray,this.valueArray)}this.oldValueArray=Ext.apply([],this.valueArray)},validateValue:function(a){if(!Ext.ux.Andrie.Select.superclass.validateValue.call(this,a)){return false}if(this.valueArray.length<this.minLength){this.markInvalid(String.format(this.minLengthText,this.minLength));return false}if(this.valueArray.length>this.maxLength){this.markInvalid(String.format(this.maxLengthText,this.maxLength));return false}return true},clearValue:function(){this.commonChangeValue("","",[],[]);if(this.view){this.view.clearSelections()}Ext.ux.Andrie.Select.superclass.clearValue.call(this)},reset:function(){if(this.view){this.view.clearSelections()}Ext.ux.Andrie.Select.superclass.reset.call(this)},getValue:function(a){if(a){return typeof this.valueArray!="undefined"?this.valueArray:[]}return Ext.ux.Andrie.Select.superclass.getValue.call(this)},getRawValue:function(a){if(a){return typeof this.rawValueArray!="undefined"?this.rawValueArray:[]}return Ext.ux.Andrie.Select.superclass.getRawValue.call(this)},select:function(a,c){this.selectedIndex=a;if(!this.view){return}this.view.select(a,this.multiSelect);if(c!==false){var b=this.view.getNode(a);if(b){this.innerList.scrollChildIntoView(b,false)}}},deselect:function(a,c){this.selectedIndex=a;this.view.deselect(a,this.multiSelect);if(c!==false){var b=this.view.getNode(a);if(b){this.innerList.scrollChildIntoView(b,false)}}},selectByValue:function(c,g){this.hoverOut();if(c!==undefined&&c!==null){if(!(c instanceof Array)){c=[c]}var b=[];for(var d=0,a=c.length;d<a;d++){var f=c[d];var e=this.findRecord(this.valueField||this.displayField,f);if(e){this.select(this.store.indexOf(e),g);b.push(f)}}return b.join(",")}return false},selectFirst:function(){var a=this.store.getCount();if(a>0){this.select(0)}},selectLast:function(){var a=this.store.getCount();if(a>0){this.select(a)}},hover:function(a,d){if(!this.view){return}this.hoverOut();var c=this.view.getNode(a);this.view.lastItem=c;Ext.fly(c).addClass(this.view.overClass);if(d!==false){var b=this.view.getNode(a);if(b){this.innerList.scrollChildIntoView(b,false)}}},hoverOut:function(){if(!this.view){return}if(this.view.lastItem){Ext.fly(this.view.lastItem).removeClass(this.view.overClass);delete this.view.lastItem}},hoverNext:function(){if(!this.view){return}var b=this.store.getCount();if(b>0){if(!this.view.lastItem){this.hover(0)}else{var a=this.view.indexOf(this.view.lastItem);if(a<b-1){this.hover(a+1)}}}},hoverPrev:function(){if(!this.view){return}var b=this.store.getCount();if(b>0){if(!this.view.lastItem){this.hover(0)}else{var a=this.view.indexOf(this.view.lastItem);if(a!=0){this.hover(a-1)}}}},hoverFirst:function(){var a=this.store.getCount();if(a>0){this.hover(0)}},hoverLast:function(){var a=this.store.getCount();if(a>0){this.hover(a)}},addHistory:function(b){if(!b.length){return}var a=this.findRecord(this.valueField||this.displayField,b);if(a){this.store.remove(a)}else{var c={};if(this.valueField){c[this.valueField]=b}c[this.displayField]=b;a=new this.store.reader.recordType(c)}this.store.clearFilter();this.store.insert(0,a);this.pruneHistory()},pruneHistory:function(){if(this.historyMaxLength==0){return}if(this.store.getCount()>this.historyMaxLength){var c=this.store.getRange(this.historyMaxLength,this.store.getCount());for(var b=0,a=c.length;b<a;b++){this.store.remove(c[b])}}}});Ext.reg("select",Ext.ux.Andrie.Select);Ext.ns("Ext.ux.form");Ext.ux.form.DateTime=Ext.extend(Ext.form.Field,{defaultAutoCreate:{tag:"input",type:"hidden"},timeWidth:100,dtSeparator:" ",hiddenFormat:"Y-m-d H:i:s",otherToNow:true,timePosition:"right",dateFormat:"m/d/y",timeFormat:"g:i A",initComponent:function(){Ext.ux.form.DateTime.superclass.initComponent.call(this);this.validationTask=new Ext.util.DelayedTask(this.validate,this);var b=Ext.apply({},{id:this.id+"-date",format:this.dateFormat||Ext.form.DateField.prototype.format,width:this.timeWidth,selectOnFocus:this.selectOnFocus,validationEvent:false,listeners:{blur:{scope:this,fn:this.onBlur},focus:{scope:this,fn:this.onFocus}}},this.dateConfig);this.df=new Ext.form.DateField(b);delete (this.dateFormat);var a=Ext.apply({},{id:this.id+"-time",format:this.timeFormat||Ext.form.TimeField.prototype.format,width:this.timeWidth,selectOnFocus:this.selectOnFocus,validationEvent:false,listeners:{blur:{scope:this,fn:this.onBlur},focus:{scope:this,fn:this.onFocus}}},this.timeConfig);this.tf=new Ext.form.TimeField(a);delete (this.timeFormat);this.relayEvents(this.df,["focus","specialkey","invalid","valid"]);this.relayEvents(this.tf,["focus","specialkey","invalid","valid"])},filterValidation:function(a){if(!a.isNavKeyPress()){this.validationTask.delay(this.validationDelay)}},destroy:function(){if(this.df.rendered){this.df.destroy()}if(this.tf.rendered){this.tf.destroy()}Ext.ux.form.DateTime.superclass.destroy.call(this)},onRender:function(c,a){if(this.isRendered){return}Ext.ux.form.DateTime.superclass.onRender.call(this,c,a);var b;if("bellow"===this.timePosition){b=Ext.DomHelper.append(c,{tag:"table",style:"border-collapse:collapse",children:[{tag:"tr",children:[{tag:"td",style:"padding-bottom:1px",cls:"ux-datetime-date"}]},{tag:"tr",children:[{tag:"td",cls:"ux-datetime-time"}]}]},true)}else{b=Ext.DomHelper.append(c,{tag:"table",style:"border-collapse:collapse",children:[{tag:"tr",children:[{tag:"td",style:"padding-right:4px",cls:"ux-datetime-date"},{tag:"td",cls:"ux-datetime-time"}]}]},true)}this.tableEl=b;this.wrap=b.wrap({cls:"x-form-field-wrap"});this.wrap.on("mousedown",this.onMouseDown,this,{delay:10});this.df.render(b.child("td.ux-datetime-date"));this.tf.render(b.child("td.ux-datetime-time"));this.df.getEl().on("keyup",this.filterValidation,this);this.tf.getEl().on("keyup",this.filterValidation,this);if(Ext.isIE&&Ext.isStrict){b.select("input").applyStyles({top:0})}this.on("specialkey",this.onSpecialKey,this);this.df.el.swallowEvent(["keydown","keypress"]);this.tf.el.swallowEvent(["keydown","keypress"]);if("side"===this.msgTarget){var d=this.el.findParent(".x-form-element",10,true);this.errorIcon=d.createChild({cls:"x-form-invalid-icon"});this.df.errorIcon=this.errorIcon;this.tf.errorIcon=this.errorIcon}this.isRendered=true;this.validate()},adjustSize:Ext.BoxComponent.prototype.adjustSize,alignErrorIcon:function(){this.errorIcon.alignTo(this.tableEl,"tl-tr",[2,0])},initDateValue:function(){this.dateValue=this.otherToNow?new Date():new Date(1970,0,1,0,0,0)},initTimeValue:function(){this.timeValue=this.otherToNow?new Date():new Date(1970,0,1,0,0,0)},disable:function(){if(this.isRendered){this.df.disabled=this.disabled;this.df.onDisable();this.tf.onDisable()}this.disabled=true;this.df.disabled=true;this.tf.disabled=true;this.fireEvent("disable",this);return this},enable:function(){if(this.rendered){this.df.onEnable();this.tf.onEnable()}this.disabled=false;this.df.disabled=false;this.tf.disabled=false;this.fireEvent("enable",this);return this},focus:function(){this.df.focus()},getPositionEl:function(){return this.wrap},getResizeEl:function(){return this.wrap},getValue:function(){return(this.getDateTime())},isValid:function(){return this.df.isValid()&&this.tf.isValid()},isVisible:function(){return this.df.rendered&&this.df.getActionEl().isVisible()},onBlur:function(a){if(this.wrapClick){a.focus();this.wrapClick=false}if(a===this.df){this.updateDate()}else{this.updateTime()}this.updateHidden();(function(){if(!this.df.hasFocus&&!this.tf.hasFocus){var b=this.getValue();if(String(b)!==String(this.startValue)){this.fireEvent("change",this,b,this.startValue)}this.hasFocus=false;this.fireEvent("blur",this)}}).defer(100,this)},onFocus:function(){if(!this.hasFocus){this.hasFocus=true;this.startValue=this.getValue();this.fireEvent("focus",this)}},onMouseDown:function(a){this.wrapClick="td"===a.target.nodeName.toLowerCase()},onSpecialKey:function(b,c){var a=c.getKey();if(a==c.TAB){if(b===this.df&&!c.shiftKey){c.stopEvent();this.tf.focus()}if(b===this.tf&&c.shiftKey){c.stopEvent();this.df.focus()}}if(a==c.ENTER){this.updateValue()}},setDate:function(a){this.df.setValue(a)},setTime:function(a){this.tf.setValue(a)},setSize:function(a,b){if(!a){return}if("bellow"==this.timePosition){this.df.setSize(a,b);this.tf.setSize(a,b);if(Ext.isIE){this.df.el.up("td").setWidth(a);this.tf.el.up("td").setWidth(a)}}else{this.df.setSize(a-this.timeWidth-4,b);this.tf.setSize(this.timeWidth,b);if(Ext.isIE){this.df.el.up("td").setWidth(a-this.timeWidth-4);this.tf.el.up("td").setWidth(this.timeWidth)}}},setValue:function(c){if(!c&&true===this.emptyToNow){this.setValue(new Date());return}else{if(!c){this.setDate("");this.setTime("");this.updateValue();if(this.rendered){this.validate()}return}}c=c?c:new Date(1970,0,1,0,0,0);var a,b;if(c instanceof Date){this.setDate(c);this.setTime(c);this.dateValue=new Date(c);this.timeValue=new Date(c)}else{a=c.split(this.dtSeparator);this.setDate(a[0]);if(a[1]){this.setTime(a[1])}}this.updateValue();if(this.rendered){this.validate()}},setVisible:function(a){if(a){this.df.show();this.tf.show()}else{this.df.hide();this.tf.hide()}return this},show:function(){return this.setVisible(true)},hide:function(){return this.setVisible(false)},updateDate:function(){var a=this.df.getValue();if(a){if(!(this.dateValue instanceof Date)){this.initDateValue()}this.dateValue.setMonth(0);this.dateValue.setFullYear(a.getFullYear());this.dateValue.setMonth(a.getMonth());this.dateValue.setDate(a.getDate())}else{this.dateValue=""}},updateTime:function(){var a=this.tf.getValue();if(a){if(!(a instanceof Date)){a=Date.parseDate(a,this.tf.format)}if(!(this.timeValue instanceof Date)){this.initTimeValue()}this.timeValue.setHours(a.getHours());this.timeValue.setMinutes(a.getMinutes());this.timeValue.setSeconds(a.getSeconds())}else{this.timeValue=""}},getDateTime:function(){if(this.dateValue instanceof Date&&this.timeValue instanceof Date){var a=new Date();a.setHours(this.timeValue.getHours());a.setMinutes(this.timeValue.getMinutes());a.setSeconds(this.timeValue.getSeconds());a.setMonth(0);a.setFullYear(this.dateValue.getFullYear());a.setMonth(this.dateValue.getMonth());a.setDate(this.dateValue.getDate());return(a)}else{if(this.dateValue instanceof Date){return(new Date(this.dateValue))}}return("")},updateHidden:function(){if(this.isRendered){var b="";var a=this.getDateTime();if(a instanceof Date){b=a.format(this.hiddenFormat)}this.el.dom.value=b}},updateValue:function(){this.updateDate();this.updateTime();this.updateHidden();return},validate:function(){var b=this.tf.validate();var a=this.df.validate();if(a){this.df.clearInvalid()}if(b){this.tf.clearInvalid()}if(a&&b){this.updateValue();return(this.validateValue(this.getValue()))}return(false)},markInvalid:function(a){this.df.markInvalid(a);this.tf.markInvalid(a)},clearInvalid:function(){this.df.clearInvalid();this.tf.clearInvalid()},renderer:function(c){var b=c.editor.dateFormat||Ext.ux.form.DateTime.prototype.dateFormat;b+=" "+(c.editor.timeFormat||Ext.ux.form.DateTime.prototype.timeFormat);var a=function(e){var d=Ext.util.Format.date(e,b);return d};return a}});Ext.reg("xdatetime",Ext.ux.form.DateTime);Ext.namespace("Ext.ux.netbox.core");Ext.ux.netbox.core.Operator=function(b,a){this.id=b;this.label=((a==undefined)?b:a);this.field=null};Ext.ux.netbox.core.Operator.prototype={isAvailableValuesAvailable:function(){if(this.getField()===null){throw ("An operator must be associated to a Field to know if there is the list of the available values!")}return(this.getField().isAvailableValuesAvailable())},getAvailableValues:function(){if(!this.isAvailableValuesAvailable()){throw ("Available values not available!")}if(this.getField()==null){throw ("An operator must be associated to a field to obtain the list of the available values!")}return(this.getField().getAvailableValues())},getId:function(){return(this.id)},getLabel:function(){return(this.label)},setField:function(a){this.field=a},getField:function(){return(this.field)},render:function(a){if(this.getField()===undefined||this.getField()===null){throw ("Impossible to render a value from the operator "+this.getId()+" which is without field")}return(this.getField().render(a,this.getId()))},getEditor:function(a){if(this.getField()==undefined||this.getField()==null){throw ("Impossible to obtain the editor for the operator "+this.getId()+" which is without field")}var c;if(a===undefined){a=true}if(this.editor==null||!a){c=this.createEditor();var b=c.field;var d=b.validateValue;var f=this.validate;var e=this;b.validateValue=function(h){var j=b.value;if(b.value===undefined||b.value===null){j=""}if(d.call(this,j)===false){return false}var g=f.call(e,c.getValue());if(g===true){return true}b.markInvalid(g)};if(a){this.editor=c}}else{c=this.editor}return(c)},convertValue:function(a){if(a!==null&&a!==undefined&&Ext.type(a)=="array"){if(a.length>0&&a[0].value!==undefined&&a[0].label!==undefined){if(a.length==1){return(a)}else{return([a[0]])}}}return([])},isStoreRemote:function(){if(this.getField()===undefined||this.getField()===null){throw ("Impossible to obtain the type of the store (remote/local) for the operator "+this.getId()+" which is without field")}return(this.getField().isStoreRemote())},isForceReload:function(){if(this.getField()===undefined||this.getField()===null){throw ("Impossible to obtain the forceReload info for the operator "+this.getId()+" which is without field")}return(this.getField().isForceReload())},isCaseSensitive:function(){if(this.getField()===undefined||this.getField()===null){throw ("Impossible to obtain the caseSensitive info for the operator "+this.getId()+" which is without field")}return(this.getField().isCaseSensitive())},getDefaultValues:function(){return(this.getField().getDefaultValues())},validate:function(b){if(this.validateFn!==undefined){return this.validateFn.call(this,b)}if(this.getField()===undefined||this.getField()===null){throw ("Impossible to call the validate function on the field: is not defined. Operation id: "+this.getId())}var a=this.getField().validate(b);if(a&&this.additionalValidationFn){a=this.additionalValidationFn.call(this,b)}return(a)},createEditor:function(){if(this.getField()===undefined||this.getField()===null){throw ("Impossible to create the editor for the operator "+this.getId()+" which is without field")}return(this.getField().createEditor(this.getId()))},addValidateFn:function(a){this.additionalValidationFn=a},setValidateFn:function(a){this.validateFn=a}};Ext.namespace("Ext.ux.netbox.core");Ext.ux.netbox.core.Field=function(c,a,b){Ext.ux.netbox.core.Field.superclass.constructor.call(this);this.addEvents({operatorAdded:true,operatorRemoved:true,defaultOperatorChanged:true});this.id=c;this.label=((a===undefined)?c:a);this.availableOperators=[];this.defaultOperator=null;this.editor=null;this.availableValueStore=null;this.isRemote=true;this.forceReload=false;this.defaultValues=((b==undefined)?[]:b);this.validateFunc=null};Ext.extend(Ext.ux.netbox.core.Field,Ext.util.Observable,{caseSensitive:true,getDefaultValues:function(){return(this.defaultValues)},setDefaultValues:function(a){var c=[];for(var b=0;b<a.length;b++){if(a[b].label==undefined){a[b].label=a[b].value}c.push(a[b])}this.defaultValues=c},getDefaultOperator:function(){return(this.defaultOperator)},setDefaultOperator:function(a){var c=a.getId();var b=this.getAvailableOperatorById(c);if(b==null){throw ("operator not among available operators")}this.defaultOperator=a;this.fireEvent("defaultOperatorChanged",a)},getAvailableValues:function(){if(!this.isAvailableValuesAvailable()){throw ("Available values not available!")}return(this.availableValueStore)},setAvailableValues:function(a){this.availableValueStore=a;this.editor=null},isAvailableValuesAvailable:function(){return(this.availableValueStore!==null)},setStoreRemote:function(a){this.isRemote=a},isStoreRemote:function(){if(!this.isAvailableValuesAvailable()){throw (this.getId()+" isStoreRemote: no store available")}return(this.isRemote)},setForceReload:function(a){this.forceReload=a},isForceReload:function(){if(!this.isAvailableValuesAvailable()){throw (this.getId()+" isForceReload: no store available")}return(this.forceReload)},setCaseSensitive:function(a){this.caseSensitive=a},isCaseSensitive:function(){if(!this.isAvailableValuesAvailable()){throw (this.getId()+" isCaseSensitive: no store available")}return(this.caseSensitive)},addOperator:function(a){if(a.getField()!==null&&a.getField()!=this){throw ("Impossible to add the operator "+a.getId()+" to the Field "+this.getId()+". The operator is already associated to another Field")}this.availableOperators.push(a);a.setField(this);this.fireEvent("operatorAdded",a)},getAvailableOperators:function(){return(this.availableOperators)},getAvailableOperatorById:function(b){var a=this._getOperatorIndexById(b);if(a===null){return(null)}else{return(this.getAvailableOperators()[a])}},_getOperatorIndexById:function(c){var b=this.getAvailableOperators();for(var a=0;a<b.length;a++){if(b[a].getId()==c){return(a)}}return(null)},removeOperator:function(c){var b=this._getOperatorIndexById(c);if(b===null){throw ("The operator with the given id doesn't exist")}else{var a=this.getAvailableOperators()[b];if(a==this.getDefaultOperator){throw ("operator to remove is the DefaultOperator")}this.availableOperators.splice(b,1);this.fireEvent("operatorRemoved",a)}},getElementaryFilterInstance:function(a){var b=new Ext.ux.netbox.core.ElementaryFilter(this,a);return b},getId:function(){return(this.id)},getLabel:function(){return(this.label)},render:function(c,a){if(c!==undefined&&c!==null){if(Ext.type(c)=="array"){var d=[];for(var b=0;b<c.length;b++){d.push(this.render(c[b],a))}return(d.join(","))}else{if(c.value!==undefined&&c.label!==undefined){return(this.render(c.label,a))}return(String(c))}}else{return("")}},createEditor:function(a){var b;if(!this.isAvailableValuesAvailable()){b=new Ext.ux.netbox.core.TextValuesEditor()}else{b=new Ext.ux.netbox.core.AvailableValuesEditor(this.getAvailableValues(),{remote:this.isStoreRemote(),forceReload:this.isForceReload(),caseSensitive:this.isCaseSensitive()})}return b},setValidateFn:function(a){this.validateFunc=a},validate:function(a){if(this.validateFunc!==null){return this.validateFunc.call(this,a)}else{return true}},emptyNotAllowedFn:function(a){if(!a){return(this.emptyNotAllowed)}if(!a.length){return(this.emptyNotAllowed)}return(true)},emptyNotAllowed:"Empty value not allowed"});Ext.namespace("Ext.ux.netbox.core");Ext.ux.netbox.core.Filter=function(){Ext.ux.netbox.core.Filter.superclass.constructor.call(this)};Ext.extend(Ext.ux.netbox.core.Filter,Ext.util.Observable,{getFilterObj:function(){throw ("getFilterObj is an abstract method!")},setFilterObj:function(a){throw ("setFilterObj is an abstract method!")},getElementaryFilterById:function(a){throw ("getElementaryFilterById is an abstract method!")},getElementaryFiltersByFieldId:function(a){throw ("getElementaryFiltersByFieldId is an abstract method!")}});Ext.namespace("Ext.ux.netbox.core");Ext.ux.netbox.core.ElementaryFilter=function(b,a){Ext.ux.netbox.core.ElementaryFilter.superclass.constructor.call(this);this.addEvents({operatorChanged:true,valueChanged:true});this.id=b.getId()+Ext.ux.netbox.core.ElementaryFilter.sequence;Ext.ux.netbox.core.ElementaryFilter.sequence++;this.field=b;this.operator;this.setOperator(((a==undefined)?b.getDefaultOperator():a));this.values;this.setValues(this.getOperator().getDefaultValues())};if(Ext.ux.netbox.core.ElementaryFilter.sequence==undefined){Ext.ux.netbox.core.ElementaryFilter.sequence=0}Ext.extend(Ext.ux.netbox.core.ElementaryFilter,Ext.ux.netbox.core.Filter,{getField:function(){return(this.field)},getOperator:function(){return(this.operator)},setOperator:function(a){if(a==null){throw ("Null Operator not allowed")}if(a.getId){if(this.field.getAvailableOperatorById(a.getId())==null){throw ("Operator "+a.getId()+" is not available for this elementaryFilter")}}else{var b=this.getField().getAvailableOperatorById(a);if(b==null){throw ("Operator "+a+" is not available for this elementaryFilter")}a=b}this.operator=a;this.fireEvent("operatorChanged",this,a);this.setValues(this.operator.convertValue(this.getValues()))},getValues:function(){if(this.values){return(this.values.concat())}return(this.values)},addValue:function(a){this.values.push(a);this.fireEvent("valueChanged",this,a)},removeValue:function(c){var b=-1;for(var a=0;a<this.getValues().length;a++){if(this.getValues()[a]==c){b=a;break}}if(b!=-1){this.values.splice(b,1);this.fireEvent("valueChanged",this,c)}else{throw ("Unable to remove the value "+c+". Not found")}},setValues:function(a){if(a===undefined||a===null){throw ("ElementaryFilter "+this.getId()+". Impossible to set a undefined or null value. The empty value is an empty array.")}if(Ext.type(a)!="array"){throw ("ElementaryFilter "+this.getId()+". The value of a ElementaryFilter MUST be an array!")}if(Ext.util.JSON.encode(this.values)!=Ext.util.JSON.encode(a)){if(this.getOperator().validate(a)===true||this.getOperator().validate(this.getValues())!==true){this.values=a;this.fireEvent("valueChanged",this,a)}}},getFilterObj:function(){return({fieldId:this.getField().getId(),operatorId:this.getOperator().getId(),values:this.getValues()})},setFilterObj:function(a){if(this.getField().getId()!=a.fieldId){throw ("Wrong field for this filter. Expected "+this.getField().getId()+" got "+a.fieldId)}this.setOperator(this.getField().getAvailableOperatorById(a.operatorId));this.setValues(a.values)},getId:function(){return(this.id)},getElementaryFilterById:function(a){if(this.getId()==a){return(this)}return(null)},getElementaryFiltersByFieldId:function(a){if(this.getField().getId()==a){return([this])}return([])},isValid:function(){if(this.values!==undefined&&this.getOperator().validate(this.values)===true){return true}else{return false}}});Ext.namespace("Ext.ux.netbox.core");Ext.ux.netbox.core.CompositeFilter=function(c,a,b){Ext.ux.netbox.core.CompositeFilter.superclass.constructor.call(this);this.addEvents({leftSideChanged:true,rightSideChanged:true,operatorChanged:true});this.left;this.setLeftSide(c);this.logicalOperator;this.setLogicalOperator(a);this.right;this.setRightSide(b)};Ext.ux.netbox.core.CompositeFilter.OR="OR";Ext.ux.netbox.core.CompositeFilter.AND="AND";Ext.extend(Ext.ux.netbox.core.CompositeFilter,Ext.ux.netbox.core.Filter,{AND:Ext.ux.netbox.core.CompositeFilter.AND,OR:Ext.ux.netbox.core.CompositeFilter.OR,setLogicalOperator:function(a){if(a!=Ext.ux.netbox.core.CompositeFilter.AND&&a!=Ext.ux.netbox.core.CompositeFilter.OR){throw ("Unknown logical operator : "+a)}this.logicalOperator=a;this.fireEvent("operatorChanged",this)},getLogicalOperator:function(){return(this.logicalOperator)},setRightSide:function(a){this.right=a;this.fireEvent("rightSideChanged",this)},getRightSide:function(){return(this.right)},setLeftSide:function(a){this.left=a;this.fireEvent("leftSideChanged",this)},getLeftSide:function(){return(this.left)},setFilterObj:function(a){this.setLeftSide(a.left);this.setLogicalOperator(a.logicalOperator);this.setRightSide(a.right)},getFilterObj:function(){return{left:this.getLeftSide(),logicalOperator:this.getLogicalOperator(),right:this.getRightSide()}},getElementaryFilterById:function(b){var a=this.getLeftSide().getElementaryFilterById(b);if(a!=null){return(a)}if(this.getRightSide()!=null){return(this.getRightSide().getElementaryFilterById(b))}return null},getElementaryFiltersByFieldId:function(a){var b=this.getLeftSide().getElementaryFiltersByFieldId(a);if(this.getRightSide()!=null){b=b.concat(this.getRightSide().getElementaryFiltersByFieldId(a))}return b}});Ext.namespace("Ext.ux.netbox.core");Ext.ux.netbox.core.FieldManager=function(a){Ext.ux.netbox.core.FieldManager.superclass.constructor.call(this);this.addEvents({fieldAdded:true,fieldRemoved:true,beforeFieldRemoved:true});this.fields=new Ext.util.MixedCollection(false,function(c){return(c.getId())});if(a!==undefined){for(var b=0;b<a.length;b++){this.addField(a[b])}}};Ext.extend(Ext.ux.netbox.core.FieldManager,Ext.util.Observable,{getAllFields:function(){return(this.fields.getRange())},getFieldById:function(b){var a=this.fields.get(b);if(!a){return(null)}return(a)},createFieldFromCfg:function(b){var a;if(b.type===undefined){b.type="string"}switch(b.type){case"string":a=new Ext.ux.netbox.string.StringField(b.id,b.label);break;case"enum":a=new Ext.ux.netbox.string.EnumField(b.id,b.label);break;case"float":case"int":a=new Ext.ux.netbox.number.NumberField(b.id,b.label);break;case"date":a=new Ext.ux.netbox.date.DateField(b.id,b.label,b.format);break;default:return(null)}if(b.availableValues!==undefined){a.setAvailableValues(b.availableValues);if(b.remoteStore!==undefined){a.setStoreRemote(b.remoteStore)}if(b.type=="string"||b.type=="enum"){a.addOperator(new Ext.ux.netbox.string.StringListOperator("STRING_LIST",a.stringListText));a.addOperator(new Ext.ux.netbox.string.StringListOperator("STRING_NOT_IN_LIST",a.stringNotListText))}}if(b.defaultValues!==undefined){a.setDefaultValues(b.defaultValues)}if(b.forceReload!==undefined){a.setForceReload(b.forceReload)}if(b.caseSensitive!==undefined){a.setCaseSensitive(b.caseSensitive)}if(b.validate!==undefined){a.setValidateFn(b.validate)}return(a)},addField:function(a){if(!(a instanceof Ext.ux.netbox.core.Field)){a=this.createFieldFromCfg(a)}this.fields.add(a);this.fireEvent("fieldAdded",a)},removeField:function(a){if(this.fields.containsKey(a.getId())){if(this.fireEvent("beforeFieldRemoved",a)!==false){if(this.fields.removeKey(a.getId())){this.fireEvent("fieldRemoved",a)}}}},removeAll:function(){for(var a=this.fields.items.length-1;a>=0;a--){this.removeField(this.fields.items[a])}},reconfigure:function(a){this.removeAll();if(a!==undefined){for(var b=0;b<a.length;b++){this.addField(a[b])}}}});Ext.namespace("Ext.ux.netbox.core");Ext.ux.netbox.core.FilterModel=function(a){Ext.ux.netbox.core.FilterModel.superclass.constructor.call(this);this.addEvents({elementaryFilterAdded:true,elementaryFilterRemoved:true,filterChanged:true});this.filter=null;if(a instanceof Ext.ux.netbox.core.FieldManager){this.fieldManager=a}else{this.fieldManager=new Ext.ux.netbox.core.FieldManager(a)}this.fieldManager.on("beforeFieldRemoved",this.onBeforeFieldRemoved,this);if(a.logicalOperator===undefined){this.logicalOperator=Ext.ux.netbox.core.CompositeFilter.AND}else{this.logicalOperator=a.logicalOperator}};Ext.extend(Ext.ux.netbox.core.FilterModel,Ext.util.Observable,{onBeforeFieldRemoved:function(a){if(this.getElementaryFiltersByFieldId(a.getId()).length>0){return(false)}},_createFilter:function(c,b,a){var d=this.getFieldManager().getFieldById(c);if(d==null){throw ("Field "+c+" not found!")}var e=d.getElementaryFilterInstance();if(b!=undefined){e.setOperator(b)}if(a!=undefined){e.setValues(a)}return(e)},_addFilter:function(a){if(this.getFilter()==null){this.filter=a}else{this.filter=new Ext.ux.netbox.core.CompositeFilter(this.getFilter(),this.logicalOperator,a)}this.fireEvent("elementaryFilterAdded",this,a)},_decodeFilter:function(f){if(f.fieldId){var d=this.getFieldManager().getFieldById(f.fieldId);if(d==null){throw ("Field "+f.fieldId+" not found!")}var b=d.getAvailableOperatorById(f.operatorId);if(b===null){b=undefined}var e=d.getElementaryFilterInstance(b);e.setFilterObj(f);return(e)}else{var g=this._decodeFilter(f.left);var a=this._decodeFilter(f.right);var c=new Ext.ux.netbox.core.CompositeFilter(g,f.logicalOperator,a);return(c)}},_encodeFilter:function(b){if(b.setValues){return(b.getFilterObj())}else{var a=b.getFilterObj();a.left=this._encodeFilter(a.left);a.right=this._encodeFilter(a.right);return(a)}},_findAndRemoveFilter:function(f,e,c,b){if(e instanceof Ext.ux.netbox.core.ElementaryFilter){if(c.call(this,e)){b.push(e);return(true)}else{return(false)}}var d=this._findAndRemoveFilter(e,e.getLeftSide(),c,b);var a=this._findAndRemoveFilter(e,e.getRightSide(),c,b);if(a&&d){return(true)}if(d){if(f.getLeftSide()==e){f.setLeftSide(e.getRightSide())}else{f.setRightSide(e.getRightSide())}}if(a){if(f.getLeftSide()==e){f.setLeftSide(e.getLeftSide())}else{f.setRightSide(e.getLeftSide())}}return(false)},getFieldManager:function(){return(this.fieldManager)},getFilter:function(){return(this.filter)},getFilterObj:function(e,k,j){var h;if(k===undefined){h=null}else{h=this._decodeFilter(k)}if(j===undefined){j=Ext.ux.netbox.core.CompositeFilter.AND}var c=this.getFilter();var a=null;if(this.getFilter()!==null){if(c===null){a=h}else{a=this._decodeFilter(this._encodeFilter(this.getFilter()));if(h!==null){a=new Ext.ux.netbox.core.CompositeFilter(a,j,h)}}}if(a instanceof Ext.ux.netbox.core.ElementaryFilter){if(!a.isValid()){a=null}}else{if(a!==null){var g=function(l){return(!l.isValid())};var b=[];var d=this._findAndRemoveFilter(a,a.getLeftSide(),g,b);var f=this._findAndRemoveFilter(a,a.getRightSide(),g,b);if(d&&f){a=null}else{if(d){a=a.getRightSide()}else{if(f){a=a.getLeftSide()}}}}}if(a!=null){return(this._encodeFilter(a))}else{return null}},setFilterObj:function(a){if(a){if(!a.setFilterObj){a=this._decodeFilter(a)}}this.filter=a;this.fireEvent("filterChanged",this)},getElementaryFilterById:function(a){if(this.getFilter()!=null){return(this.getFilter().getElementaryFilterById(a))}return(null)},getElementaryFiltersByFieldId:function(a){if(this.getFilter()!=null){return(this.getFilter().getElementaryFiltersByFieldId(a))}return[]},addElementaryFilterByFieldId:function(a){var b=this._createFilter(a);this._addFilter(b);return(b.getId())},addElementaryFilter:function(b){var a=this._createFilter(b.fieldId,b.operatorId,b.values);this._addFilter(a);return(a.getId())},removeElementaryFilterById:function(b){var c=null;if(this.getFilter()==null){throw ("Unable to remove the elementaryFilter with id "+b+". The elementaryFilter doesn't exist.")}if(this.getFilter() instanceof Ext.ux.netbox.core.ElementaryFilter){if(this.getFilter().getId()==b){c=this.filter;this.filter=null}else{throw ("Unable to remove the elementaryFilter with id "+b+". The elementaryFilter doesn't exist")}}else{var e=function(g){if(g.getId()===b){return(true)}else{return(false)}};var d=[];var f=this._findAndRemoveFilter(this.getFilter(),this.getFilter().getLeftSide(),e,d);var a=this._findAndRemoveFilter(this.getFilter(),this.getFilter().getRightSide(),e,d);if(d.length===0){throw ("Unable to remove the elementaryFilter with id "+b+". The elementaryFilter doesn't exist")}c=d[0];if(f){this.filter=this.getFilter().getRightSide()}if(a){this.filter=this.getFilter().getLeftSide()}}this.fireEvent("elementaryFilterRemoved",this,c)},getAllElementaryFilters:function(b){if(b===undefined){b=this.getFilter()}var a=[];if(b!=null){if(b.setValues){a.push(b)}else{a=a.concat(this.getAllElementaryFilters(b.getLeftSide()));a=a.concat(this.getAllElementaryFilters(b.getRightSide()))}}return(a)},getLogicalOperator:function(){return this.logicalOperator},setLogicalOperator:function(a){if(a===Ext.ux.netbox.core.CompositeFilter.OR||a===Ext.ux.netbox.core.CompositeFilter.AND){this.logicalOperator=a}},each:function(c,b,a){if(a===undefined){a=this.getFilter()}if(a==null){return}if(b===undefined){b=window}c.call(b,a);if(a instanceof Ext.ux.netbox.core.CompositeFilter){this.each(c,b,a.getLeftSide());this.each(c,b,a.getRightSide())}}});Ext.namespace("Ext.ux.netbox.core");Ext.ux.netbox.core.DynamicFilterModelView=function(a){this.filterModel=a.filterModel;this.createFieldCombo();this.createLogicOpeCombo();a=this.createFilterGridConfig(a);Ext.ux.netbox.core.DynamicFilterModelView.superclass.constructor.call(this,a);this.populateFilterStore();this.setLogicOpeCombo();this.on("cellclick",this.removeFilter,this);this.on("beforeedit",this.updateOperatorStore,this);this.on("afteredit",this.updateFilter,this);this.getFilterModel().on("elementaryFilterAdded",this.onFilterAdded,this);this.getFilterModel().on("elementaryFilterRemoved",this.onFilterRemoved,this);this.getFilterModel().on("filterChanged",this.onFilterChanged,this);this.getFilterModel().getFieldManager().on("fieldAdded",this.onFieldAdded,this);this.getFilterModel().getFieldManager().on("fieldRemoved",this.onFieldRemoved,this);this.getView().getRowClass=function(c,f,g,d){var b="";var e=c.data.filter;if(!e.isValid()){b="x-grid3-row-notValid"}return b}};Ext.extend(Ext.ux.netbox.core.DynamicFilterModelView,Ext.grid.EditorGridPanel,{deleteText:"Delete",filterText:"Field",operatorText:"Operator",valueText:"Value",comboText:"Select a new field",logicOpeAndText:"Check all",logicOpeOrText:"Check at least one",getFilterModel:function(){return(this.filterModel)},onFieldAdded:function(a){this.addFields([a])},onFieldRemoved:function(a){this.removeFields(a)},onFilterAdded:function(c,b){var a=[];a.push(["",b.getField(),b.getOperator().getId(),b.getValues(),b,b.getId()]);this.filterStore.loadData(a,true);b.on("operatorChanged",this.updateFilterOperator,this);b.on("valueChanged",this.updateFilterValues,this)},onFilterRemoved:function(c,b){var a=this.filterStore.getById(b.getId());this.filterStore.remove(a);b.un("operatorChanged",this.updateFilterOperator,this);b.on("valueChanged",this.updateFilterValues,this)},onFilterChanged:function(){this.populateFilterStore();this.setLogicOpeCombo()},onEditComplete:function(b,d,a){this.editing=false;this.activeEditor=null;b.un("specialkey",this.selModel.onEditorKey,this.selModel);if(Ext.util.JSON.encode(d)!==Ext.util.JSON.encode(a)){var c=b.record;c.set=function(e,h){if(Ext.util.JSON.encode(this.data[e])==Ext.util.JSON.encode(h)){return}this.dirty=true;if(!this.modified){this.modified={}}if(typeof this.modified[e]=="undefined"){this.modified[e]=this.data[e]}this.data[e]=h;if(!this.editing){this.store.afterEdit(this)}};var g=this.colModel.getDataIndex(b.col);var f={grid:this,record:c,field:g,originalValue:a,value:d,row:b.row,column:b.col,cancel:false,renderTo:this};if(this.fireEvent("validateedit",f)!==false&&!f.cancel){c.set(g,f.value);delete f.cancel;this.fireEvent("afteredit",f)}}this.view.focusCell(b.row,b.col)},createFilterGridConfig:function(b){this.filterStore=new Ext.data.SimpleStore({fields:["image","field","operatorId","value","filter","filterId"],data:[],id:5});this.operatorStore=new Ext.data.SimpleStore({fields:["operatorId","operatorLabel"],data:[]});var c=new Ext.form.ComboBox({store:this.operatorStore,mode:"local",valueField:"operatorId",displayField:"operatorLabel",editable:false,triggerAction:"all",lazyRender:true,listClass:"x-combo-list-small"});var a=new Ext.grid.ColumnModel([{header:this.deleteText,renderer:this.imageRenderer,width:50,dataIndex:"image"},{header:this.filterText,renderer:this.fieldRenderer,width:150,dataIndex:"field"},{header:this.operatorText,renderer:this.operatorRenderer,width:150,dataIndex:"operatorId",editor:c},{header:this.valueText,width:150,renderer:this.valueRenderer,editable:true,dataIndex:"value"}]);c.on("select",this.completeEditLater,this);a.getCellEditorOrig=a.getCellEditor;a.filterStore=this.filterStore;a.getCellEditor=function(e,g){if(e==3){var f=this.filterStore.getAt(g).get("filter");var d=f.getOperator();return(d.getEditor())}return(this.getCellEditorOrig(e,g))};b.store=this.filterStore;b.colModel=a;b.cm=a;b.clicksToEdit=1;b.autoExpandColumn=a.getColumnId("3");b.enableColumnHide=false;b.enableColumnMove=false;b.enableColumnResize=false;b.elements="body, tbar";if(b.tbar==undefined){b.tbar=[]}b.tbar.push(this.fieldCombo);b.tbar.push("-");b.tbar.push(this.logicOpeCombo);return(b)},completeEditLater:function(){var c=this.getColumnModel().getCellEditor(2);var b=c.completeEdit;var a=new Ext.util.DelayedTask(b,c);a.delay(0)},populateFilterStore:function(){this.filterStore.removeAll();for(var a=0;a<this.getFilterModel().getAllElementaryFilters().length;a++){this.onFilterAdded(this.getFilterModel(),this.getFilterModel().getAllElementaryFilters()[a])}},createFieldCombo:function(){this.fieldStore=new Ext.data.SimpleStore({fields:["fieldId","label"],data:[],id:0});var a=this.getFilterModel().getFieldManager().getAllFields();this.addFields(a);this.fieldCombo=new Ext.form.ComboBox({emptyText:this.comboText,displayField:"label",valueField:"fieldId",store:this.fieldStore,mode:"local",triggerAction:"all",selectOnFocus:true,typeAhead:true,editable:true});this.fieldCombo.on("select",this.addFilter,this)},createLogicOpeCombo:function(){var a=new Ext.data.SimpleStore({fields:["label","value"],data:[[this.logicOpeAndText,Ext.ux.netbox.core.CompositeFilter.AND],[this.logicOpeOrText,Ext.ux.netbox.core.CompositeFilter.OR]]});this.logicOpeCombo=new Ext.form.ComboBox({displayField:"label",valueField:"value",store:a,mode:"local",triggerAction:"all",selectOnFocus:true,editable:false,value:Ext.ux.netbox.core.CompositeFilter.AND});this.logicOpeCombo.on("select",this.chgLogicOpe,this)},setLogicOpeCombo:function(){var a=this.getFilterModel().getFilter();if(a instanceof Ext.ux.netbox.core.CompositeFilter){this.logicOpeCombo.setValue(a.getLogicalOperator())}},addFields:function(b){var a=[];for(var c=0;c<b.length;c++){a.push([b[c].getId(),b[c].getLabel()])}this.fieldStore.loadData(a,true);this.fieldStore.sort("label","ASC")},removeFields:function(c){var a=c.getId();var b=this.fieldStore.getById(a);this.fieldStore.remove(b)},addFilter:function(d,a,b){var c=this.getFilterModel().addElementaryFilterByFieldId(a.id);this.fieldCombo.clearValue();this.filterStore.indexOfId(c);this.startEditing(this.filterStore.indexOfId(c),3)},chgLogicOpe:function(d,a,c){var b=a.get("value");this.getFilterModel().setLogicalOperator(b);this.getFilterModel().each(function(e){if(e instanceof Ext.ux.netbox.core.CompositeFilter&&e.getLogicalOperator()!=b){e.setLogicalOperator(b)}})},removeFilter:function(b,f,d,e){if(d==0){var a=b.getStore().getAt(f);var c=a.get("filter");this.getFilterModel().removeElementaryFilterById(c.getId())}},updateOperatorStore:function(d){if(d.column==2){var c=d.record.get("field");var a=[];for(var b=0;b<c.getAvailableOperators().length;b++){a.push([c.getAvailableOperators()[b].getId(),c.getAvailableOperators()[b].getLabel().escHtml()])}this.operatorStore.loadData(a,false)}},updateFilter:function(d){if(d.column==2){var b=d.record.get("filter");var a=d.record.get("operatorId");b.setOperator(a)}else{if(d.column==3){var b=d.record.get("filter");try{b.setValues(d.record.get("value"))}catch(f){var c=this.filterStore.getById(b.getId());c.set("value",b.getValues())}}}this.filterStore.commitChanges()},updateFilterOperator:function(b){var a=this.filterStore.getById(b.getId());if(a.get("operatorId")!=b.getOperator().getId()){a.set("operatorId",b.getOperator().getId())}this.filterStore.commitChanges()},updateFilterValues:function(b){var a=this.filterStore.getById(b.getId());if(Ext.util.JSON.encode(a.get("value"))!=Ext.util.JSON.encode(b.getValues())){a.set("value",b.getValues())}this.filterStore.commitChanges()},imageRenderer:function(e,d,a,f,c,b){return('<img class="x-menu-item-icon x-icon-delete" style="position: static; cursor: pointer" src="'+Ext.BLANK_IMAGE_URL+'"/>')},fieldRenderer:function(e,d,a,f,c,b){return(e.getLabel())},operatorRenderer:function(f,e,a,g,d,c){var b=a.get("filter").getField().getAvailableOperatorById(f);return(b.getLabel())},valueRenderer:function(e,d,a,f,c,b){return(a.get("filter").getOperator().render(e))}});Ext.reg("dynamicFilter",Ext.ux.netbox.core.DynamicFilterModelView);String.prototype.escHtml=function(){var b,c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};var a=this;for(b in c){a=a.replace(new RegExp(b,"g"),c[b])}return a};Ext.namespace("Ext.ux.netbox.core");Ext.ux.netbox.core.StaticFilterModelView=function(a){this.filterModel=a.filterModel;this.ratio=60;this.rowSize=27;if(a.rowSize!==undefined){this.rowSize=a.rowSize}if(a.ratio){this.ratio=a.ratio}a=this.createConfig(a);this.colsNumber=a.colsNumber;this.panelColumns=[];for(var b=0;b<this.colsNumber;b++){this.panelColumns[b]=null}Ext.ux.netbox.core.StaticFilterModelView.superclass.constructor.call(this,a);if(this.rendered){this.populateFields()}else{this.on("render",this.populateFields,this)}this.filterModel.getFieldManager().on("fieldAdded",this.addField,this);this.filterModel.getFieldManager().on("fieldRemoved",this.removeField,this);this.filterModel.on("elementaryFilterAdded",this.elementaryFilterAdded,this);this.filterModel.on("elementaryFilterRemoved",this.elementaryFilterRemoved,this);this.filterModel.on("filterChanged",this.populateFilters,this);this.fieldPanelMapping=new Ext.util.MixedCollection();this.filterEditorsMapping={};this.managedFilters=new Ext.util.MixedCollection();if(this.rendered){this.populateFilters()}else{this.on("render",this.populateFilters,this)}};Ext.extend(Ext.ux.netbox.core.StaticFilterModelView,Ext.form.FormPanel,{createConfig:function(b){b.layout="form";b.frame="true";if(!b.colsNumber){b.colsNumber=1}b.colsNumber=b.colsNumber*2;var e=1/(b.colsNumber);var a=[];var f=function(h,j){this.panelColumns[j]=h};for(var c=0;c<b.colsNumber;c++){var d;if(c%2===0){d=e*(this.ratio/100)*2}else{if(c%2===1){d=e*(1-(this.ratio/100))*2}}var g={columnWidth:d,layout:"anchor",items:null,plugins:{init:f.createDelegate(this,[c],true)}};a.push(g);if(c%2==1){a.push({width:15,style:"height: 1px"})}}b.items=[{layout:"column",items:a,anchor:"100% 100%"}];return(b)},getEditorPanelNumber:function(e){var a=this.fieldPanelMapping.get(e.getId());var d=a.getEditorComponent();var b=a.getOperatorCombo();var f=-1;for(var c=1;c<this.panelColumns.length;c+=2){if(this.panelColumns[c].items.contains(d)){f=c;break}}return(f)},elementaryFilterRemoved:function(f,d){var g=d.getField();var h=this.getEditorPanelNumber(g);var a=this.fieldPanelMapping.get(g.getId());var e=a.getEditorComponent();var c=a.getOperatorCombo();if(e.items&&e.items.getCount()>0){var b=e.items.first();e.remove(b)}if(c.getValue()!==""){c.clearValue()}d.un("operatorChanged",this.operatorChanged,this);d.un("valueChanged",this.valueChanged,this);this.managedFilters.remove(d)},elementaryFilterAdded:function(c,a){var f=a.getField();var g=this.getEditorPanelNumber(f);var k=this.fieldPanelMapping.get(f.getId());var h=k.getEditorComponent();var b=k.getOperatorCombo();b.setValue(a.getOperator().getId());var e=a.getOperator().getEditor(false);this.changeEditor(e,k);var j=k.getEditor().field;if(h.items&&h.items.getCount()>0){var d=h.items.first();h.remove(d)}this.addFormField(j,h);k.getEditor().editing=true;k.getEditor().setValue(a.getValues());k.getEditor().startValue=a.getValues();a.on("operatorChanged",this.operatorChanged,this);a.on("valueChanged",this.valueChanged,this);this.managedFilters.add(a)},changeEditor:function(b,a){if(a.getEditor()){a.getEditor().un("complete",this.editingCompleted,this);a.getEditor().field.un("change",this.editingCompleted,this)}a.setEditor(b);a.getEditor().on("complete",this.editingCompleted,this);a.getEditor().field.on("change",this.editingCompleted,this)},addFormField:function(b,a){a.add(b);a.doLayout()},operatorChanged:function(a,b){var e=a.getField();var j=this.fieldPanelMapping.get(e.getId());var k=j.getOperatorCombo();var g=j.getEditorComponent();if(k.getValue()!=b.getId()){k.setValue(b.getId())}var f=this.getEditorPanelNumber(e);var d=a.getOperator().getEditor(false);this.changeEditor(d,j);var h=j.getEditor().field;var c=g.items.first();g.remove(c);this.addFormField(h,g);j.getEditor().editing=true;j.getEditor().startValue=a.getValues();j.getEditor().setValue(a.getValues())},valueChanged:function(c,d){var a=this.fieldPanelMapping.get(c.getField().getId());var b=a.getEditor();b.setValue(d)},editingCompleted:function(b){var c=function(f){if(f.getEditor()&&(f.getEditor()==b||f.getEditor().field==b)){return(true)}return(false)};var a=this.fieldPanelMapping.find(c);var e=a.getField();var d=this.filterModel.getElementaryFiltersByFieldId(e.getId());if(Ext.util.JSON.encode(d[0].getValues())!==Ext.util.JSON.encode(a.getEditor().getValue())){d[0].setValues(a.getEditor().getValue())}a.getEditor().editing=true},populateFields:function(){var a=this.filterModel.getFieldManager().getAllFields();for(var b=0;b<a.length;b++){this.addField(a[b])}},removeField:function(f){var g=this.getEditorPanelNumber(f);var a=this.fieldPanelMapping.get(f.getId());var e=a.getEditorComponent();var c=a.getOperatorCombo();var b=e.items.first();e.remove(b,false);var d=c.getEl().up(".x-form-item");this.panelColumns[g-1].remove(c,true);d.remove();this.panelColumns[g].doLayout();this.panelColumns[g-1].doLayout();this.fieldPanelMapping.removeKey(f.getId())},operatorSelected:function(b,f,g){var h=function(l){if(l.getOperatorCombo()==b){return(true)}return(false)};var k=this.fieldPanelMapping.find(h);var j=k.getField();var a=this.filterModel.getElementaryFiltersByFieldId(j.getId());if(f.get("operatorId")===""){b.clearValue();if(a.length>0){this.filterModel.removeElementaryFilterById(a[0].getId())}return}if(f.get("operatorId")!==""&&a.length==0){var c=this.filterModel.addElementaryFilterByFieldId(j.getId());a.push(this.filterModel.getElementaryFilterById(c))}var e=j.getAvailableOperators();for(var d=0;d<e.length;d++){if(e[d].getId()===f.get("operatorId")){a[0].setOperator(e[d])}}return},populateFilters:function(){while(this.managedFilters.getCount()>0){var c=this.managedFilters.last();this.elementaryFilterRemoved(this.filterModel,c)}var a=this.filterModel.getAllElementaryFilters();for(var b=0;b<a.length;b++){this.elementaryFilterAdded(this.filterModel,a[b])}},addField:function(e){var b={};if(this.initialConfig.labelWidth!==undefined){b.labelWidth=this.initialConfig.labelWidth}if(this.initialConfig.hideLabels!==undefined){b.hideLabels=this.initialConfig.hideLabels}if(this.initialConfig.itemCls!==undefined){b.itemCls=this.initialConfig.itemCls}if(this.initialConfig.labelAlign!==undefined){b.labelAlign=this.initialConfig.labelAlign}if(this.initialConfig.labelPad!==undefined){b.labelPad=this.initialConfig.labelPad}var a=new Ext.ux.netbox.core.ElementaryFilterCfg(e,this.rowSize,b);var d=null;var f=0;for(var c=0;c<this.panelColumns.length;c+=2){if(!this.panelColumns[c].items){d=0;f=c;break}if(d==null||this.panelColumns[c].items.length<d){d=this.panelColumns[c].items.length;f=c}}this.fieldPanelMapping.add(e.getId(),a);a.getOperatorCombo().on("select",this.operatorSelected,this);b.layout="form";b.anchor="100%";b.items=[a.getOperatorCombo()];b.height=this.rowSize;this.panelColumns[f].add(b);this.panelColumns[f].doLayout();this.panelColumns[f+1].add(a.getEditorComponent());this.panelColumns[f+1].doLayout()}});Ext.reg("staticFilter",Ext.ux.netbox.core.StaticFilterModelView);Ext.ux.netbox.core.ElementaryFilterCfg=function(g,e,b){this.rowSize=e;var a=[["","<PRE> </PRE>"]];this.labelAlign=b.labelAlign;this.field=g;for(var d=0;d<g.getAvailableOperators().length;d++){a.push([g.getAvailableOperators()[d].getId(),g.getAvailableOperators()[d].getLabel()])}var h=new Ext.data.SimpleStore({fields:["operatorId","operatorLabel"],data:a});var c={store:h,mode:"local",valueField:"operatorId",displayField:"operatorLabel",editable:false,triggerAction:"all",lazyRender:true,fieldLabel:g.getLabel(),width:105,tpl:'<tpl for="."><div class="x-combo-list-item">{[values.operatorLabel=="<PRE> </PRE>" ? values.operatorLabel : values.operatorLabel.escHtml()]}</div></tpl>'};if(Ext.isSafari){c.anchor="90%"}else{c.anchor="98%"}c.anchor+=" 100%";this.operatorCombo=new Ext.form.ComboBox(c);var f=Ext.apply({},b);f.layout="form";f.height=this.rowSize;f.labelWidth=1;f.labelPad=1;if(this.labelAlign!=="top"){f.hideLabels=true}this.editorComponent=new Ext.Panel(f)};Ext.ux.netbox.core.ElementaryFilterCfg.prototype={getOperatorCombo:function(){return(this.operatorCombo)},getEditorComponent:function(){return(this.editorComponent)},getField:function(){return(this.field)},setEditor:function(a){this.editor=a;if(Ext.isSafari){this.editor.field.anchor="90%"}else{this.editor.field.anchor="98%"}this.editor.field.labelSeparator="";if(this.labelAlign=="top"){if(Ext.isIE){this.editor.field.fieldLabel="<pre> </pre>"}else{this.editor.field.labelStyle="white-space: pre;";this.editor.field.fieldLabel=" "}}else{this.editor.field.fieldLabel=""}},getEditor:function(){return(this.editor)}};Ext.namespace("Ext.ux.netbox");Ext.ux.netbox.FilterEditor=function(b,a){Ext.ux.netbox.FilterEditor.superclass.constructor.call(this,b,a)};Ext.extend(Ext.ux.netbox.FilterEditor,Ext.grid.GridEditor,{startEdit:function(b,c){if(this.editing){this.completeEdit()}this.boundEl=Ext.get(b);var a=c!==undefined?c:this.boundEl.dom.innerHTML;if(!this.rendered){this.render(this.parentEl||document.body)}if(this.fireEvent("beforestartedit",this,this.boundEl,a)===false){return}this.startValue=a;this.setValue(a);if(this.autoSize){var d=this.boundEl.getSize();switch(this.autoSize){case"width":this.setSize(d.width,"");break;case"height":this.setSize("",d.height);break;default:this.setSize(d.width,d.height)}}this.el.alignTo(this.boundEl,this.alignment);this.editing=true;this.show()},completeEdit:function(a){if(!this.editing){return}var b=this.getValue();if(this.revertInvalid!==false&&!this.field.isValid()){b=this.startValue;this.cancelEdit(true)}if(Ext.util.JSON.encode(b)===Ext.util.JSON.encode(this.startValue)&&this.ignoreNoChange){this.editing=false;this.hide();return}if(this.fireEvent("beforecomplete",this,b,this.startValue)!==false){this.editing=false;if(this.updateEl&&this.boundEl){this.boundEl.update(b)}if(a!==true){this.hide()}this.fireEvent("complete",this,b,this.startValue)}}});Ext.namespace("Ext.ux.netbox.core");Ext.ux.netbox.core.AvailableValuesEditor=function(a,b){if(b==undefined){b={}}var c="local";if(b.remote==true){c="remote"}if(b.multiSelect==undefined){b.multiSelect=false}this.fieldCombo=new Ext.ux.Andrie.Select({store:a,displayField:"label",valueField:"value",selectOnFocus:true,mode:c,triggerAction:"all",selectOnFocus:true,typeAhead:true,multiSelect:b.multiSelect,minChars:0});if(!b.multiSelect){this.fieldCombo.on("select",this.completeEditLater,this)}if(b.forceReload){this.fieldCombo.on("beforequery",function(d){d.combo.lastQuery=null})}if(b.caseSensitive){this.caseSensitive=true}else{this.caseSensitive=false}Ext.ux.netbox.core.AvailableValuesEditor.superclass.constructor.call(this,this.fieldCombo,b);this.store=a};Ext.extend(Ext.ux.netbox.core.AvailableValuesEditor,Ext.ux.netbox.FilterEditor,{setValue:function(c){var e=[];var d=[];var a="";if(c!=undefined&&c!=null&&Ext.type(c)=="array"){if(c.length>0){for(var b=0;b<c.length&&((this.fieldCombo.multiSelect)||b<1);b++){e.push(c[b].value);if(c[b].label!=undefined){d.push(c[b].label)}else{d.push(c[b].value)}}}}this.originalValue=c;Ext.ux.netbox.core.AvailableValuesEditor.superclass.setValue.call(this,e);Ext.form.ComboBox.superclass.setValue.call(this.fieldCombo,d.join(","));this.fieldCombo.value=e;this.fieldCombo.rawValueArray=d},completeEditLater:function(){var a=new Ext.util.DelayedTask(this.completeEdit,this);a.delay(0)},getValue:function(){var e=Ext.ux.netbox.core.AvailableValuesEditor.superclass.getValue.call(this);if(Ext.type(e)=="string"){e=e.split(",")}var d=[];for(var c=0;c<e.length;c++){var b=this.store.find("value",e[c],0,false,this.caseSensitive);if(b<0){continue}var a=this.store.getAt(b);d.push({label:a.get("label"),value:e[c]})}if((e.length>0&&e[0]!=="")&&d.length==0){return(this.originalValue)}else{return d}}});Ext.namespace("Ext.ux.netbox.core");Ext.ux.netbox.core.TextValuesEditor=function(b,a){if(b==undefined){b=new Ext.form.TextField()}Ext.ux.netbox.core.TextValuesEditor.superclass.constructor.call(this,b,a)};Ext.extend(Ext.ux.netbox.core.TextValuesEditor,Ext.ux.netbox.FilterEditor,{setValue:function(a){var b;if(a!==undefined&&a!==null&&Ext.type(a)==="array"){if(a.length==0){b=""}else{if(a[0].value!==undefined){b=a[0].value}else{b=a[0]}}}else{b=""}Ext.ux.netbox.FilterEditor.superclass.setValue.call(this,b)},getValue:function(){var a=Ext.ux.netbox.FilterEditor.superclass.getValue.call(this);if(a===""){return([])}else{a=[{label:a,value:a}]}return(a)}});Ext.namespace("Ext.ux.netbox.string");Ext.ux.netbox.string.TextFieldOperator=function(b,a){Ext.ux.netbox.string.TextFieldOperator.superclass.constructor.call(this,b,a);this.editor=null};Ext.extend(Ext.ux.netbox.string.TextFieldOperator,Ext.ux.netbox.core.Operator,{createEditor:function(a){var b=new Ext.ux.netbox.core.TextValuesEditor();return b}});Ext.namespace("Ext.ux.netbox.string");Ext.ux.netbox.string.StringListOperator=function(b,a){Ext.ux.netbox.string.StringListOperator.superclass.constructor.call(this,b,a);this.editor=null;valFn=function(c){return(this.getField().emptyNotAllowedFn(c))};this.addValidateFn(valFn)};Ext.extend(Ext.ux.netbox.string.StringListOperator,Ext.ux.netbox.core.Operator,{createEditor:function(a){var b=new Ext.ux.netbox.core.AvailableValuesEditor(this.getField().getAvailableValues(),{remote:this.isStoreRemote(),forceReload:this.isForceReload(),multiSelect:true,caseSensitive:this.isCaseSensitive()});return b},convertValue:function(a){var c=[];if(a!==null&&a!==undefined&&Ext.type(a)=="array"){for(var b=0;b<a.length;b++){if(a[b].value!==undefined&&a[b].label!==undefined){c.push(a[b])}}}return(c)}});Ext.namespace("Ext.ux.netbox.string");Ext.ux.netbox.string.StringField=function(d,a){Ext.ux.netbox.string.StringField.superclass.constructor.call(this,d,a);var b=new Ext.ux.netbox.core.Operator("STRING_EQUAL",this.stringEqualsLabel);this.addOperator(b);this.setDefaultOperator(b);this.addOperator(new Ext.ux.netbox.core.Operator("STRING_DIFFERENT",this.stringDifferentLabel));noEmptyAllowed=this.emptyNotAllowedFn.createDelegate(this);var c=new Ext.ux.netbox.string.TextFieldOperator("STRING_CONTAINS",this.containsText);c.addValidateFn(noEmptyAllowed);this.addOperator(c);c=new Ext.ux.netbox.string.TextFieldOperator("STRING_DOESNT_CONTAIN",this.doesntContainsText);c.addValidateFn(noEmptyAllowed);this.addOperator(c);c=new Ext.ux.netbox.string.TextFieldOperator("STRING_STARTS_WITH",this.startsWithText);c.addValidateFn(noEmptyAllowed);this.addOperator(c);c=new Ext.ux.netbox.string.TextFieldOperator("STRING_ENDS_WITH",this.endsWithText);c.addValidateFn(noEmptyAllowed);this.addOperator(c)};Ext.extend(Ext.ux.netbox.string.StringField,Ext.ux.netbox.core.Field,{stringEqualsLabel:"=",stringDifferentLabel:"!=",containsText:"contains",doesntContainsText:"doesn't contain",startsWithText:"starts with",endsWithText:"ends with",stringListText:"in",stringNotListText:"not in"});Ext.namespace("Ext.ux.netbox.string");Ext.ux.netbox.string.EnumField=function(c,a){Ext.ux.netbox.string.EnumField.superclass.constructor.call(this,c,a);var b=new Ext.ux.netbox.core.Operator("STRING_EQUAL",this.stringEqualsLabel);this.addOperator(b);this.setDefaultOperator(b);this.addOperator(new Ext.ux.netbox.core.Operator("STRING_DIFFERENT",this.stringDifferentLabel))};Ext.extend(Ext.ux.netbox.string.EnumField,Ext.ux.netbox.core.Field,{stringEqualsLabel:"=",stringDifferentLabel:"!=",stringListText:"in",stringNotListText:"not in"});Ext.namespace("Ext.ux.netbox.number");Ext.ux.netbox.number.NumberRangeOperator=function(){Ext.ux.netbox.number.NumberRangeOperator.superclass.constructor.call(this,"NUMBER_RANGE",this.includeText);var a=function(d){var c=this.getField().emptyNotAllowedFn(d);if(c!==true){return(c)}if(d.length!=2){return(this.bothFromAndToNotEmpty)}var e=this.isNumeric(d[0].value);var b=this.isNumeric(d[1].value);if(!e&&!b){return(this.toAndFromNotANumber)}if(!e){return(this.fromNotANumber)}if(!b){return(this.toNotANumber)}if(parseFloat(d[0].value)>parseFloat(d[1].value)){return(this.fromBiggerThanTo)}return(true)};this.setValidateFn(a)};Ext.extend(Ext.ux.netbox.number.NumberRangeOperator,Ext.ux.netbox.core.Operator,{fromText:"from",toText:"to",includeText:"between",bothFromAndToNotEmpty:"Both 'from' and 'to' must have a value",fromBiggerThanTo:"From is bigger than to",fromNotANumber:"From is not a number",toNotANumber:"To is not a number",toAndFromNotANumber:"From and to are not numbers",isNumeric:function(b){if(Ext.type(b)==="number"){return(isFinite(b))}else{if(Ext.type(b)==="string"){if(b.lastIndexOf(".")===b.length){return("A number should not end with a .")}var a=/^(-)?(\d+)(\.?)(\d*)$/;return(b.match(a))}}return(false)},createEditor:function(a){var c=new Ext.ux.netbox.core.RangeField({textCls:Ext.form.NumberField,fromConfig:{},toConfig:{}});var b=new Ext.ux.netbox.FilterEditor(c);c.on("editingcompleted",b.completeEdit,b);return b},render:function(c){var b=c[0]==undefined?"":c[0].label;var a=c[1]==undefined?"":c[1].label;return(this.fromText+": "+b+", "+this.toText+": "+a)}});Ext.namespace("Ext.ux.netbox.number");Ext.ux.netbox.number.NumberField=function(d,a){Ext.ux.netbox.number.NumberField.superclass.constructor.call(this,d,a);var b=new Ext.ux.netbox.core.Operator("NUMBER_EQUAL","=");this.addOperator(b);this.setDefaultOperator(b);this.addOperator(new Ext.ux.netbox.core.Operator("NUMBER_NOT_EQUAL","!="));noEmptyAllowed=this.emptyNotAllowedFn.createDelegate(this);var c=new Ext.ux.netbox.core.Operator("NUMBER_GREATER",">");c.addValidateFn(noEmptyAllowed);this.addOperator(c);c=new Ext.ux.netbox.core.Operator("NUMBER_GREATER_OR_EQUAL",">=");c.addValidateFn(noEmptyAllowed);this.addOperator(c);c=new Ext.ux.netbox.core.Operator("NUMBER_LESS","<");c.addValidateFn(noEmptyAllowed);this.addOperator(c);c=new Ext.ux.netbox.core.Operator("NUMBER_LESS_OR_EQUAL","<=");c.addValidateFn(noEmptyAllowed);this.addOperator(c);this.addOperator(new Ext.ux.netbox.number.NumberRangeOperator())};Ext.extend(Ext.ux.netbox.number.NumberField,Ext.ux.netbox.core.Field,{createEditor:function(a){var b=new Ext.ux.netbox.core.TextValuesEditor(new Ext.form.NumberField({decimalPrecision:10}));return b}});Ext.namespace("Ext.ux.netbox");Ext.ux.netbox.InputTextMask=function(a,d){if(d===undefined){this.clearWhenInvalid=true}else{this.clearWhenInvalid=d}this.rawMask=a;this.viewMask="";this.maskArray=[];var c=0;var e="";for(var b=0;b<a.length;b++){if(e){if(e=="X"){e=""}if(a.charAt(b)=="X"){this.maskArray[c]=e;c++;e=""}else{e+=a.charAt(b)}}else{if(a.charAt(b)=="X"){e+="X";this.viewMask+="_"}else{if(a.charAt(b)=="9"||a.charAt(b)=="L"||a.charAt(b)=="l"||a.charAt(b)=="A"){this.viewMask+="_";this.maskArray[c]=a.charAt(b);c++}else{this.viewMask+=a.charAt(b);this.maskArray[c]=RegExp.escape(a.charAt(b));c++}}}}this.specialChars=this.viewMask.replace(/(L|l|9|A|_|X)/g,"")};Ext.ux.netbox.InputTextMask.prototype={init:function(a){this.field=a;if(a.rendered){this.assignEl()}else{a.on("render",this.assignEl,this)}a.on("blur",this.removeValueWhenInvalid,this);a.on("focus",this.processMaskFocus,this)},assignEl:function(){this.inputTextElement=this.field.getEl().dom;this.field.getEl().on("keypress",this.processKeyPress,this);this.field.getEl().on("keydown",this.processKeyDown,this);if(Ext.isSafari||Ext.isIE){this.field.getEl().on("paste",this.startTask,this);this.field.getEl().on("cut",this.startTask,this)}if(Ext.isGecko||Ext.isOpera){this.field.getEl().on("mousedown",this.setPreviousValue,this)}if(Ext.isGecko){this.field.getEl().on("input",this.onInput,this)}if(Ext.isOpera){this.field.getEl().on("input",this.onInputOpera,this)}},onInput:function(){this.startTask(false)},onInputOpera:function(){if(!this.prevValueOpera){this.startTask(false)}else{this.manageBackspaceAndDeleteOpera()}},manageBackspaceAndDeleteOpera:function(){this.inputTextElement.value=this.prevValueOpera.cursorPos.previousValue;this.manageTheText(this.prevValueOpera.keycode,this.prevValueOpera.cursorPos);this.prevValueOpera=null},setPreviousValue:function(a){this.oldCursorPos=this.getCursorPosition()},getValidatedKey:function(b,a){var c=this.maskArray[a.start];if(c=="9"){return b.pressedKey.match(/[0-9]/)}else{if(c=="L"){return(b.pressedKey.match(/[A-Za-z]/))?b.pressedKey.toUpperCase():null}else{if(c=="l"){return(b.pressedKey.match(/[A-Za-z]/))?b.pressedKey.toLowerCase():null}else{if(c=="A"){return b.pressedKey.match(/[A-Za-z0-9]/)}else{if(c){return(b.pressedKey.match(new RegExp(c)))}}}}}return(null)},removeValueWhenInvalid:function(){if(this.clearWhenInvalid&&this.inputTextElement.value.indexOf("_")>-1){this.inputTextElement.value=""}},managePaste:function(){if(this.oldCursorPos===null){return}var c=this.inputTextElement.value.substring(this.oldCursorPos.start,this.inputTextElement.value.length-(this.oldCursorPos.previousValue.length-this.oldCursorPos.end));if(this.oldCursorPos.start<this.oldCursorPos.end){this.oldCursorPos.previousValue=this.oldCursorPos.previousValue.substring(0,this.oldCursorPos.start)+this.viewMask.substring(this.oldCursorPos.start,this.oldCursorPos.end)+this.oldCursorPos.previousValue.substring(this.oldCursorPos.end,this.oldCursorPos.previousValue.length);c=c.substr(0,this.oldCursorPos.end-this.oldCursorPos.start)}this.inputTextElement.value=this.oldCursorPos.previousValue;keycode={unicode:"",isShiftPressed:false,isTab:false,isBackspace:false,isLeftOrRightArrow:false,isDelete:false,pressedKey:""};var b=false;for(var a=0;a<c.length;a++){keycode.pressedKey=c.substr(a,1);keycode.unicode=c.charCodeAt(a);this.oldCursorPos=this.skipMaskCharacters(keycode,this.oldCursorPos);if(this.oldCursorPos===false){break}if(this.injectValue(keycode,this.oldCursorPos)){b=true;this.moveCursorToPosition(keycode,this.oldCursorPos);this.oldCursorPos.previousValue=this.inputTextElement.value;this.oldCursorPos.start=this.oldCursorPos.start+1}}if(!b&&this.oldCursorPos!==false){this.moveCursorToPosition(null,this.oldCursorPos)}this.oldCursorPos=null},processKeyDown:function(a){this.processMaskFormatting(a,"keydown")},processKeyPress:function(a){this.processMaskFormatting(a,"keypress")},startTask:function(a){if(this.task===undefined){this.task=new Ext.util.DelayedTask(this.managePaste,this)}if(a!==false){this.oldCursorPos=this.getCursorPosition()}this.task.delay(0)},skipMaskCharacters:function(a,b){if(b.start!=b.end&&(a.isDelete||a.isBackspace)){return(b)}while(this.specialChars.match(RegExp.escape(this.viewMask.charAt(((a.isBackspace)?b.start-1:b.start))))){if(a.isBackspace){b.dec()}else{b.inc()}if(b.start>=b.previousValue.length||b.start<0){return false}}return(b)},isManagedByKeyDown:function(a){if(a.isDelete||a.isBackspace){return(true)}return(false)},processMaskFormatting:function(c,b){this.oldCursorPos=null;var d=this.getCursorPosition();var a=this.getKeyCode(c,b);if(a.unicode===0){return}if((a.unicode==67||a.unicode==99)&&c.ctrlKey){return}if((a.unicode==88||a.unicode==120)&&c.ctrlKey){this.startTask();return}if((a.unicode==86||a.unicode==118)&&c.ctrlKey){this.startTask();return}if((a.isBackspace||a.isDelete)&&Ext.isOpera){this.prevValueOpera={cursorPos:d,keycode:a};return}if(b=="keydown"&&!this.isManagedByKeyDown(a)){return true}if(b=="keypress"&&this.isManagedByKeyDown(a)){return true}if(this.handleEventBubble(c,a,b)){return true}return(this.manageTheText(a,d))},manageTheText:function(a,b){if(this.inputTextElement.value.length===0){this.inputTextElement.value=this.viewMask}b=this.skipMaskCharacters(a,b);if(b===false){return false}if(this.injectValue(a,b)){this.moveCursorToPosition(a,b)}return(false)},processMaskFocus:function(){if(this.inputTextElement.value.length===0){var a=this.getCursorPosition();this.inputTextElement.value=this.viewMask;this.moveCursorToPosition(null,a)}},isManagedByBrowser:function(c,a,b){if(((b=="keypress"&&(c.charCode===0||(Ext.isOpera&&c.charCode==null)))||b=="keydown")&&(a.unicode==Ext.EventObject.TAB||a.unicode==Ext.EventObject.RETURN||a.unicode==Ext.EventObject.ENTER||a.unicode==Ext.EventObject.SHIFT||a.unicode==Ext.EventObject.CONTROL||a.unicode==Ext.EventObject.ESC||a.unicode==Ext.EventObject.PAGEUP||a.unicode==Ext.EventObject.PAGEDOWN||a.unicode==Ext.EventObject.END||a.unicode==Ext.EventObject.HOME||a.unicode==Ext.EventObject.LEFT||a.unicode==Ext.EventObject.UP||a.unicode==Ext.EventObject.RIGHT||a.unicode==Ext.EventObject.DOWN)){return(true)}return(false)},handleEventBubble:function(c,a,b){try{if(a&&this.isManagedByBrowser(c,a,b)){return true}c.stopEvent();return false}catch(d){alert(d.message)}},getCursorPosition:function(){var a,c,b;if(this.inputTextElement.createTextRange&&!Ext.isOpera){b=document.selection.createRange().duplicate();b.moveEnd("character",this.inputTextElement.value.length);if(b.text===""){a=this.inputTextElement.value.length}else{a=this.inputTextElement.value.lastIndexOf(b.text)}b=document.selection.createRange().duplicate();b.moveStart("character",-this.inputTextElement.value.length);c=b.text.length}else{a=this.inputTextElement.selectionStart;c=this.inputTextElement.selectionEnd}return this.CursorPosition(a,c,b,this.inputTextElement.value)},moveCursorToPosition:function(b,a){var c=(!b||(b&&b.isBackspace))?a.start:a.start+1;if(this.inputTextElement.createTextRange&&!Ext.isOpera){a.range.move("character",c);a.range.select()}else{this.inputTextElement.selectionStart=c;this.inputTextElement.selectionEnd=c}},injectValue:function(b,a){if(!b.isDelete&&b.unicode==a.previousValue.charCodeAt(a.start)){return true}var c;if(!b.isDelete&&!b.isBackspace){c=this.getValidatedKey(b,a)}else{if(a.start==a.end){c="_";if(b.isBackspace){a.dec()}}else{c=this.viewMask.substring(a.start,a.end)}}if(c){this.inputTextElement.value=a.previousValue.substring(0,a.start);this.inputTextElement.value+=c+a.previousValue.substring(a.start+c.length,a.previousValue.length);return true}return false},getKeyCode:function(b,c){var a={};a.unicode=b.getKey();a.isShiftPressed=b.shiftKey;a.isDelete=((b.getKey()==Ext.EventObject.DELETE&&c=="keydown")||(c=="keypress"&&b.charCode===0&&b.keyCode==Ext.EventObject.DELETE))?true:false;a.isTab=(b.getKey()==Ext.EventObject.TAB)?true:false;a.isBackspace=(b.getKey()==Ext.EventObject.BACKSPACE)?true:false;a.isLeftOrRightArrow=(b.getKey()==Ext.EventObject.LEFT||b.getKey()==Ext.EventObject.RIGHT)?true:false;a.pressedKey=String.fromCharCode(a.unicode);return(a)},CursorPosition:function(e,c,d,b){var a={};a.start=isNaN(e)?0:e;a.end=isNaN(c)?0:c;a.range=d;a.previousValue=b;a.inc=function(){a.start++;a.end++};a.dec=function(){a.start--;a.end--};return(a)}};Ext.applyIf(RegExp,{escape:function(a){return a.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}});Ext.ux.InputTextMask=Ext.ux.netbox.InputTextMask;Ext.namespace("Ext.ux.netbox.date");Ext.ux.netbox.date.DateTextEditor=function(b,a){Ext.ux.netbox.date.DateTextEditor.superclass.constructor.call(this,b,a);if(a.format==undefined){a.format="Y-m-d H:i:s"}this.format=a.format};Ext.extend(Ext.ux.netbox.date.DateTextEditor,Ext.ux.netbox.FilterEditor,{getValue:function(){var a=Ext.ux.netbox.date.DateTextEditor.superclass.getValue.call(this);if(a===""){return([])}else{return[{value:a.format("Y-m-d H:i:s"),label:a.format(this.format)}]}},setValue:function(b){var a;if(b.length==0){a=""}else{a=Date.parseDate(b[0].value,"Y-m-d H:i:s")}Ext.ux.netbox.date.DateTextEditor.superclass.setValue.call(this,a)}});Ext.namespace("Ext.ux.netbox.date");Ext.ux.netbox.date.DateOperator=function(c,a,b){Ext.ux.netbox.date.DateOperator.superclass.constructor.call(this,c,a,b);this.editor=null;this.format=b};Ext.extend(Ext.ux.netbox.date.DateOperator,Ext.ux.netbox.core.Operator,{createEditor:function(b){var d;var a=this.format.split(" ");if(a.length>1){var c=new Ext.ux.form.DateTime({dateFormat:a[0],dateConfig:{altFormats:"Y-m-d|Y-n-d"},otherToNow:false,timeFormat:a[1],timeConfig:{altFormats:"H:i:s"}});d=new Ext.ux.netbox.date.DateTextEditor(c,{format:this.format})}else{d=new Ext.ux.netbox.date.DateTextEditor(new Ext.form.DateField({format:a[0],allowBlank:false}),{format:this.format})}return d},convertValue:function(a){if(a!==null&&a!==undefined&&Ext.type(a)=="array"){if(a.length>0&&a[0].value!==undefined&&a[0].label!==undefined){if(this.getField().checkDate(a[0].label)&&this.getField().checkDate(a[0].value,"Y-m-d H:i:s")){if(a.length==1){return(a)}else{return([a[0]])}}}}return([])},getFormat:function(){return this.format}});Ext.ux.netbox.date.DateRangeEditor=function(b,a){Ext.ux.netbox.date.DateRangeEditor.superclass.constructor.call(this,b,a);this.format=a.format};Ext.extend(Ext.ux.netbox.date.DateRangeEditor,Ext.ux.netbox.FilterEditor,{getValue:function(){var d=Ext.ux.netbox.date.DateRangeEditor.superclass.getValue.call(this);var c=[];for(var b=0;d&&b<d.length;b++){var a=Date.parseDate(d[b].value,this.format);if(!a){c.push({label:"",value:""});continue}d[b].value=a.format("Y-m-d H:i:s");c.push(d[b])}return(c)}});Ext.ux.netbox.date.DateRangeOperator=function(b){Ext.ux.netbox.date.DateRangeOperator.superclass.constructor.call(this,"DATE_RANGE",this.includeText,b);this.mapping={d:"99",m:"99",Y:"9999",y:"99",H:"99",i:"99",s:"99"};var a=function(f){var d=this.getField().emptyNotAllowedFn(f);if(d!==true){return(d)}if(f.length!=2){return(this.bothFromAndToNotEmpty)}var c=this.getField().checkDate(f[0].value,"Y-m-d H:i:s");var e=this.getField().checkDate(f[1].value,"Y-m-d H:i:s");if(!c&&!e){return(this.toAndFromNotADate)}if(!c){return(this.fromNotADate)}if(!e){return(this.toNotADate)}if(Date.parseDate(f[0].value,"Y-m-d H:i:s")>Date.parseDate(f[1].value,"Y-m-d H:i:s")){return(this.fromBiggerThanTo)}return(true)};this.setValidateFn(a)};Ext.extend(Ext.ux.netbox.date.DateRangeOperator,Ext.ux.netbox.date.DateOperator,{fromText:"from",toText:"to",includeText:"between",bothFromAndToNotEmpty:"Both 'from' and 'to' must have a value",fromBiggerThanTo:"From is bigger than to",fromNotADate:"From is not a valid date",toNotADate:"To is not a valid date",toAndFromNotADate:"From and to are not valid dates",createEditor:function(a){var c=new Ext.ux.netbox.core.RangeField({textCls:Ext.form.TextField,fromConfig:this.getTextFieldConfig(),toConfig:this.getTextFieldConfig(),minListWidth:300,fieldSize:36});var b=new Ext.ux.netbox.date.DateRangeEditor(c,{format:this.format});c.on("editingcompleted",b.completeEdit,b);return b},render:function(c){var b=c[0]==undefined?"":c[0].label;var a=c[1]==undefined?"":c[1].label;return(this.fromText+": "+b+", "+this.toText+": "+a)},getTextFieldConfig:function(){return({plugins:[new Ext.ux.netbox.InputTextMask(this.calculateMask(),true)]})},calculateMask:function(){var b="";for(var a=0;a<this.format.length;a++){if(this.mapping[this.format.charAt(a)]){b+=this.mapping[this.format.charAt(a)]}else{b+=this.format.charAt(a)}}return(b)}});Ext.ux.netbox.date.DatePeriodOperator=function(){Ext.ux.netbox.date.DatePeriodOperator.superclass.constructor.call(this,"DATE_PERIOD",this.periodText);this.periodStore=new Ext.data.SimpleStore({fields:["value","label"],data:[["LAST_QUARTER",this.quarterText],["LAST_HOUR",this.hourText],["LAST_DAY",this.dayText],["LAST_WEEK",this.weekText],["LAST_MONTH",this.monthText],["LAST_YEAR",this.yearText]]});var a=function(b){if(this.getField().emptyNotAllowedFn(b)!==true){return(this.getField().emptyNotAllowedFn(b))}if(b[0].value!=="LAST_QUARTER"&&b[0].value!=="LAST_HOUR"&&b[0].value!=="LAST_DAY"&&b[0].value!=="LAST_WEEK"&&b[0].value!=="LAST_MONTH"&&b[0].value!=="LAST_YEAR"){return(this.valueNotExpected)}return(true)};this.setValidateFn(a)};Ext.extend(Ext.ux.netbox.date.DatePeriodOperator,Ext.ux.netbox.core.Operator,{periodText:"period",yearText:"last year",monthText:"last month",weekText:"last week",dayText:"last day",hourText:"last hour",quarterText:"last quarter",valueNotExpected:"Value not expected",getDefaultValues:function(){return([{value:"LAST_DAY",label:this.dayText}])},setPeriods:function(a){this.periodStore=a;this.editor=null},createEditor:function(a){var b=new Ext.ux.netbox.core.AvailableValuesEditor(this.periodStore);return b},convertValue:function(a){if(a!==null&&a!==undefined&&Ext.type(a)=="array"){if(a.length>0&&a[0].value!==undefined&&a[0].label!==undefined){if(this.periodStore.find("value",a[0].value)!="-1"){if(a.length==1){return(a)}else{return([a[0]])}}}}return([])}});Ext.namespace("Ext.ux.netbox.date");Ext.ux.netbox.date.DateField=function(e,a,b){Ext.ux.netbox.date.DateField.superclass.constructor.call(this,e,a);this.setValidateFn(this.validateDate);var c=new Ext.ux.netbox.date.DatePeriodOperator();this.addOperator(c);this.setDefaultOperator(c);this.addOperator(new Ext.ux.netbox.date.DateOperator("DATE_EQUAL","=",b));noEmptyAllowed=this.emptyNotAllowedFn.createDelegate(this);var d=new Ext.ux.netbox.date.DateOperator("DATE_GREATER",">",b);d.addValidateFn(noEmptyAllowed);this.addOperator(d);d=new Ext.ux.netbox.date.DateOperator("DATE_GREATER_OR_EQUAL",">=",b);d.addValidateFn(noEmptyAllowed);this.addOperator(d);d=new Ext.ux.netbox.date.DateOperator("DATE_LESS","<",b);d.addValidateFn(noEmptyAllowed);this.addOperator(d);d=new Ext.ux.netbox.date.DateOperator("DATE_LESS_OR_EQUAL","<=",b);d.addValidateFn(noEmptyAllowed);this.addOperator(d);this.addOperator(new Ext.ux.netbox.date.DateRangeOperator(b));this.format=b};Ext.extend(Ext.ux.netbox.date.DateField,Ext.ux.netbox.core.Field,{validateDate:function(a){for(var b=0;a&&b<a.length;b++){if(a[b].value!==""&&!this.checkDate(a[b].value,"Y-m-d H:i:s")){return(this.checkDate(a[b].value,"Y-m-d H:i:s"))}}return(true)},checkDate:function(c,d){if(d==undefined){d=this.format}var a=Date.parseDate(c,d);if(!a){return(false)}var b=a.format(d);if(c!=b){return(false)}return(true)}});Ext.namespace("Ext.ux.netbox.core");Ext.ux.netbox.core.RangeField=function(a){this.textCls=a.textCls;this.fromConfig=a.fromConfig;this.toConfig=a.toConfig;if(a.minListWidth){this.minListWidth=a.minListWidth}else{this.minListWidth=100}if(a.fieldSize){this.defaultAutoCreate.size=a.fieldSize}Ext.ux.netbox.core.RangeField.superclass.constructor.call(this,a)};Ext.extend(Ext.ux.netbox.core.RangeField,Ext.form.TriggerField,{fromText:"from",toText:"to",defaultAutoCreate:{tag:"input",type:"text",size:"20",autocomplete:"off"},editable:false,rangeValue:null,initComponent:function(){Ext.ux.netbox.core.RangeField.superclass.initComponent.call(this)},onTriggerClick:function(){if(this.disabled){return}if(this.menu==null){this.menu=new Ext.ux.netbox.core.RangeMenu(this.textCls,this.fromConfig,this.toConfig,this.validate.createDelegate(this))}if(this.menuListeners){this.menu.on(Ext.apply({},this.menuListeners,{scope:this}))}this.menu.setWidth(this.getWidth());this.menu.show(this.getEl());this.menu.setValue(this.rangeValue)},getValue:function(){if(this.menu!==undefined){this.rangeValue=this.menu.getValue()}return(this.rangeValue)},setValue:function(a){valueFrom=a[0]!==undefined?a[0]:{value:"",label:""};valueTo=a[1]!==undefined?a[1]:{value:"",label:""};formattedValue=this.fromText+": "+valueFrom.label+", "+this.toText+": "+valueTo.label;Ext.ux.netbox.core.RangeField.superclass.setValue.call(this,formattedValue);this.rangeValue=a;if(this.menu!=null){this.menu.setValue(this.rangeValue)}},markInvalid:function(a){Ext.ux.netbox.core.RangeField.superclass.markInvalid.call(this,a);if(this.menu){this.menu.markInvalid(a)}},clearInvalid:function(){Ext.ux.netbox.core.RangeField.superclass.clearInvalid.call(this);if(this.menu){this.menu.clearInvalidFields()}},validateBlur:function(a){return(this.menu&&this.menu.getEl()&&!this.menu.getEl().contains(a.target))}});Ext.namespace("Ext.ux.netbox.core");Ext.ux.netbox.core.RangeMenu=function(a,b,c,d){if(a===undefined){a=Ext.form.TextField;a.anchor="100%"}this.editorFrom=new a(b);this.editorTo=new a(c);this.editorFrom.validate=d;this.editorTo.validate=d;this.editorFrom.fieldLabel=this.fromText;this.editorTo.fieldLabel=this.toText;this.initComponent();Ext.ux.netbox.core.RangeMenu.superclass.constructor.apply(this,arguments)};Ext.extend(Ext.ux.netbox.core.RangeMenu,Ext.menu.Menu,{fromText:"from",toText:"to",hideOnClick:false,layout:"form",labelWidth:38,style:{"background-image":"none"},layoutConfig:{doAutoSize:function(){}},initComponent:function(){Ext.apply(this,{items:[this.editorFrom,this.editorTo]});Ext.ux.netbox.core.RangeMenu.superclass.initComponent.call(this);this.addEvents({update:true});var a=this.items.items;for(var b=0;b<a.length;b++){a[b].on("keyup",this.onKeyUp,this)}},setValue:function(a){var c="";var b="";if(a.length==2){c=a[0].label;b=a[1].label}else{if(a.length==1){c=a[0].label}}if(b===""){this.editorTo.setRawValue("")}else{this.editorTo.setValue(b)}if(c===""){this.editorFrom.setRawValue("")}else{this.editorFrom.setValue(c)}this.fireEvent("update",this)},onKeyUp:function(a){if(a.getKey()==a.ENTER&&this.isValid()){this.hide(true);return}},getValue:function(){var a=[{value:this.editorFrom.getValue(),label:this.editorFrom.getValue()},{value:this.editorTo.getValue(),label:this.editorTo.getValue()}];return a},isValid:function(){return(this.editorFrom.isValid()&&this.editorTo.isValid())},markInvalid:function(a){this.editorFrom.markInvalid(a);this.editorTo.markInvalid(a)},clearInvalidFields:function(){this.editorFrom.clearInvalid();this.editorTo.clearInvalid()}});Ext.namespace("Ext.ux.netbox.core");Ext.ux.netbox.core.RangeItem=function(a){this.editorFrom=a.editorFrom;this.editorTo=a.editorTo;this.editorFrom.fieldLabel=this.fromText;this.editorTo.fieldLabel=this.toText;this.panel=new Ext.Panel({layout:"column",bodyBorder:false,border:false,hideBorders:true,items:[{layout:"form",labelWidth:28,labelPad:2,items:[this.editorFrom],columnWidth:0.5},{layout:"form",labelWidth:28,labelPad:2,items:[this.editorTo],columnWidth:0.5}]});Ext.ux.netbox.core.RangeItem.superclass.constructor.apply(this,[this.panel,a])};Ext.extend(Ext.ux.netbox.core.RangeItem,Ext.menu.BaseItem,{fromText:"from",toText:"to",itemCls:"x-menu-item",hideOnClick:false,initComponent:function(){this.addEvents({keyup:true})},doLayout:function(b){var a=(b/2)-32;this.editorTo.setWidth(a);this.editorFrom.setWidth(a);this.panel.setWidth(b);this.panel.doLayout()},onRender:function(a){if(this.editorFrom.getValue()==""){this.editorFrom.setValue("")}if(this.editorTo.getValue()==""){this.editorTo.setValue("")}Ext.ux.netbox.core.RangeItem.superclass.onRender.apply(this,arguments)},getValueFrom:function(){return this.editorFrom.getValue()},getValueTo:function(){return this.editorTo.getValue()},setValueFrom:function(a){if(a===""){this.editorFrom.setRawValue(a)}else{this.editorFrom.setValue(a)}},setValueTo:function(a){if(a===""){this.editorTo.setRawValue(a)}else{this.editorTo.setValue(a)}},isValidFrom:function(a){return this.editorFrom.isValid(a)},isValidTo:function(a){return this.editorTo.isValid(a)},markInvalid:function(a){this.editorFrom.markInvalid(a);this.editorTo.markInvalid(a)},clearInvalidFields:function(){this.editorFrom.clearInvalid();this.editorTo.clearInvalid()}});Ext.namespace("Ext.ux.netbox.core");Ext.ux.netbox.core.LocalStoreFilterResolver=function(b,a){this.mapping=null;if(a==undefined){this.mapping={NUMBER_EQUAL:{fn:this.filterNumberEqual,scope:this},NUMBER_NOT_EQUAL:{fn:this.filterNumberDifferent,scope:this},NUMBER_GREATER:{fn:this.filterNumberGreater,scope:this},NUMBER_GREATER_OR_EQUAL:{fn:this.filterNumberGreaterOrEqual,scope:this},NUMBER_LESS:{fn:this.filterNumberLess,scope:this},NUMBER_LESS_OR_EQUAL:{fn:this.filterNumberLessOrEqual,scope:this},NUMBER_RANGE:{fn:this.filterNumberRange,scope:this},STRING_EQUAL:{fn:this.filterStringEquals,scope:this},STRING_DIFFERENT:{fn:this.filterStringDifferent,scope:this},STRING_CONTAINS:{fn:this.filterStringContains,scope:this},STRING_DOESNT_CONTAIN:{fn:this.filterStringDoesntContains,scope:this},STRING_STARTS_WITH:{fn:this.filterStringStartsWith,scope:this},STRING_ENDS_WITH:{fn:this.filterStringEndsWith,scope:this},STRING_LIST:{fn:this.filterList,scope:this},STRING_NOT_IN_LIST:{fn:this.filterNotInList,scope:this},DATE_EQUAL:{fn:this.filterDateEqual,scope:this},DATE_GREATER:{fn:this.filterDateGreater,scope:this},DATE_GREATER_OR_EQUAL:{fn:this.filterDateGreaterOrEqual,scope:this},DATE_LESS:{fn:this.filterDateLess,scope:this},DATE_LESS_OR_EQUAL:{fn:this.filterDateLessOrEqual,scope:this},DATE_RANGE:{fn:this.filterDateRange,scope:this},DATE_PERIOD:{fn:this.filterDatePeriod,scope:this}}}this.filterModel=b};Ext.ux.netbox.core.LocalStoreFilterResolver.prototype={escapeRegExp:function(a){return a.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},calcolateValue:function(a){if(a.length==0){return("")}else{return(a[0].value)}},calcolateValueNumber:function(a){if(a.length==0){throw ("Not a number")}else{var b=parseFloat(a[0].value);if(isNaN(b)){throw ("Not a number")}return(b)}},calcolateValueDate:function(b){if(b.length==0){throw ("Not a date")}else{var a=Date.parseDate(b[0].value,"Y-m-d H:i:s");if(!a){throw ("Not a date")}return(a)}},filterStringEquals:function(a,c,b){return(a.get(b)===this.calcolateValue(c))},filterStringDifferent:function(a,c,b){return(!this.filterStringEquals(a,c,b))},filterList:function(a,d,c){for(var b=0;b<d.length;b++){if(this.filterStringEquals(a,[d[b]],c)){return(true)}}return(false)},filterNotInList:function(a,c,b){return(!this.filterList(a,c,b))},filterStringStartsWith:function(a,d,b){var e=this.escapeRegExp(this.calcolateValue(d));var c=new RegExp("^"+e,"");return(a.get(b).match(c)!==null)},filterStringEndsWith:function(a,d,b){var e=this.escapeRegExp(this.calcolateValue(d));var c=new RegExp(e+"$","");return(a.get(b).match(c)!==null)},filterStringContains:function(a,d,b){var e=this.escapeRegExp(this.calcolateValue(d));var c=new RegExp(".*"+e+".*","");return(a.get(b).match(c)!==null)},filterStringDoesntContains:function(a,c,b){return(!this.filterStringContains(a,c,b))},filterNumberEqual:function(a,c,b){var f;try{f=this.calcolateValueNumber(c)}catch(d){return(false)}return(a.get(b)===f)},filterNumberDifferent:function(a,c,b){return(!this.filterNumberEqual(a,c,b))},filterNumberGreater:function(a,c,b){var f;try{f=this.calcolateValueNumber(c)}catch(d){return(false)}return(a.get(b)>f)},filterNumberLessOrEqual:function(a,c,b){var f;try{f=this.calcolateValueNumber(c)}catch(d){return(false)}return(!this.filterNumberGreater(a,c,b))},filterNumberLess:function(a,c,b){var f;try{f=this.calcolateValueNumber(c)}catch(d){return(false)}return(a.get(b)<f)},filterNumberGreaterOrEqual:function(a,c,b){var f;try{f=this.calcolateValueNumber(c)}catch(d){return(false)}return(!this.filterNumberLess(a,c,b))},filterNumberRange:function(b,e,d){if(e.length!=2){return(false)}var a=this.filterNumberGreaterOrEqual(b,[e[0]],d);var c=this.filterNumberLessOrEqual(b,[e[1]],d);return(a&&c)},filterDateEqual:function(a,d,c){var b;try{b=this.calcolateValueDate(d)}catch(f){return(false)}return(a.get(c).getTime()==b.getTime())},filterDateGreater:function(a,d,c){var b;try{b=this.calcolateValueDate(d)}catch(f){return(false)}return(a.get(c).getTime()>b.getTime())},filterDateLessOrEqual:function(a,c,b){var f;try{f=this.calcolateValueDate(c)}catch(d){return(false)}return(!this.filterDateGreater(a,c,b))},filterDateLess:function(a,d,c){var b;try{b=this.calcolateValueDate(d)}catch(f){return(false)}return(a.get(c).getTime()<b.getTime())},filterDateGreaterOrEqual:function(a,d,c){var b;try{b=this.calcolateValueDate(d)}catch(f){return(false)}return(!this.filterDateLess(a,d,c))},filterDateRange:function(b,e,d){if(e.length!=2){return(false)}var a=this.filterDateGreaterOrEqual(b,[e[0]],d);var c=this.filterDateLessOrEqual(b,[e[1]],d);return(a&&c)},filterDatePeriod:function(b,f,e){if(f.length!=1){return(false)}var d=new Date();upperValue={label:d.format("Y-m-d H:i:s"),value:d.format("Y-m-d H:i:s")};var c;if(f[0].value==="LAST_YEAR"){c=d.add(Date.YEAR,-1)}else{if(f[0].value==="LAST_MONTH"){c=d.add(Date.MONTH,-1)}else{if(f[0].value==="LAST_WEEK"){c=d.add(Date.DAY,-7)}else{if(f[0].value==="LAST_DAY"){c=d.add(Date.DAY,-1)}else{if(f[0].value==="LAST_HOUR"){c=d.add(Date.HOUR,-1)}else{if(f[0].value==="LAST_QUARTER"){c=d.add(Date.MINUTE,-15)}else{return(false)}}}}}}var a={label:c.format("Y-m-d H:i:s"),value:c.format("Y-m-d H:i:s")};return(this.filterDateRange(b,[a,upperValue],e))},apply:function(a){a.filterBy(this.filter,this)},filter:function(a,f,e){if(e==undefined){e=this.filterModel.getFilterObj()}if(e==null){return(true)}if(e.operatorId!=undefined){var d=this.mapping[e.operatorId].fn;var c=this.mapping[e.operatorId].scope;if(c===undefined||c===null){c=window}toReturn=d.call(c,a,e.values,e.fieldId);return(toReturn)}else{var b=this.filter(a,f,e.left);if(b===true&&e.logicalOperator===Ext.ux.netbox.core.CompositeFilter.OR){return true}if(b===false&&e.logicalOperator===Ext.ux.netbox.core.CompositeFilter.AND){return(false)}b=this.filter(a,f,e.right);return(b)}}};Ext.namespace("Ext.ux.netbox");Ext.ux.netbox.ContainerMenuItem=function(a){Ext.ux.netbox.ContainerMenuItem.superclass.constructor.call(this,a)};Ext.extend(Ext.ux.netbox.ContainerMenuItem,Ext.menu.Item,{getSubMenu:function(){return this.menu},setSubMenu:function(a){this.menu=Ext.menu.MenuMgr.get(a);if(this.getEl()){this.getEl().addClass("x-menu-item-arrow")}},removeSubMenu:function(){this.menu=undefined;if(this.getEl()){this.getEl().removeClass("x-menu-item-arrow")}}});Ext.namespace("Ext.ux.netbox");Ext.ux.netbox.ContextMenuManager=function(a){this.menu=a.menu};Ext.ux.netbox.ContextMenuManager.prototype={init:function(a){this.gridPanel=a;this.gridPanel.on("contextmenu",this.onContextmenu,this)},onCellcontextmenu:function(a,l,k,h,b){var d=false;if(!b){d=true;if(!(this.menu instanceof Ext.menu.Menu)){this.menu=new Ext.menu.Menu(this.menu)}b=this.menu}h.stopEvent();var g=false;for(var f=0;f<b.items.getCount();f++){var j=b.items.get(f);var n=j.initialConfig.scope?j.initialConfig.scope:window;var c;if(j.initialConfig.isToShow){c=j.initialConfig.isToShow.call(n,a,l,k,j);if(c&&j.menu){this.onCellcontextmenu(a,l,k,h,j.menu)}}else{if(!j.menu){c=(l>=0&&k>=0)}else{c=this.onCellcontextmenu(a,l,k,h,j.menu)}}if(c){j.setVisible(true);if(j.initialConfig.handler){var m=j.initialConfig.handler.createDelegate(n,[a,l,k,j],false);j.setHandler(m)}g=true}else{j.setVisible(false)}}if(g&&d){this.menu.showAt([h.getPageX(),h.getPageY()])}return g},onContextmenu:function(c){var b=c.getTarget();var f=this.gridPanel.getView().findHeaderIndex(b);if(f!==false){return}var d=-1;var a=-1;if(this.gridPanel.getView().findRowIndex(b)!==false){d=this.gridPanel.getView().findRowIndex(b)}if(this.gridPanel.getView().findCellIndex(b)!==false){a=this.gridPanel.getView().findCellIndex(b)}this.onCellcontextmenu(this.gridPanel,d,a,c)}};Ext.namespace("Ext.ux.netbox.core");Ext.ux.netbox.core.QuickFilterModelView=function(a){this.addEvents({filterChanged:true});this.filterModel=a.filterModel;this.quickFilterItem=null;this.removeFilterItem=null;this.fieldsOptions=a.fieldsOptions;if(a.duplicatedElementaryFiltersAllowed===undefined){this.duplicatedElementaryFiltersAllowed=false}else{this.duplicatedElementaryFiltersAllowed=a.duplicatedElementaryFiltersAllowed}if(a.isStatic===undefined){this.isStatic=false}else{this.isStatic=a.isStatic}this.stringOperDefault=["STRING_EQUAL","STRING_DIFFERENT"];this.numberOperDefault=["NUMBER_EQUAL","NUMBER_NOT_EQUAL","NUMBER_GREATER","NUMBER_GREATER_OR_EQUAL","NUMBER_LESS","NUMBER_LESS_OR_EQUAL"];this.dateOperDefault=["DATE_EQUAL","DATE_GREATER","DATE_GREATER_OR_EQUAL","DATE_LESS","DATE_LESS_OR_EQUAL"]};Ext.extend(Ext.ux.netbox.core.QuickFilterModelView,Ext.util.Observable,{quickFilterText:"QuickFilter",removeText:"Remove filter",removeAllText:"Remove all",filterIsToShow:function(b,p,f){if(f==-1||this.getField(b,f)==null){return false}else{var c=[];var m=this.getField(b,f);var g;if(this.fieldsOptions){for(var k=0;k<this.fieldsOptions.length;k++){if(this.fieldsOptions[k].id===m.getId()&&this.fieldsOptions[k].operators){g=this.fieldsOptions[k].operators}}}if(!g){if(m instanceof Ext.ux.netbox.string.StringField||m instanceof Ext.ux.netbox.string.EnumField){g=this.stringOperDefault}else{if(m instanceof Ext.ux.netbox.number.NumberField){g=this.numberOperDefault}else{if(m instanceof Ext.ux.netbox.date.DateField){g=this.dateOperDefault}else{var l=m.getAvailableOperators();for(var k=0;k<l.length;k++){g.push(l[k].getId())}}}}}for(var k=0;k<g.length;k++){var o=true;var d=m.getAvailableOperatorById(g[k]);var e={text:Ext.util.Format.htmlEncode(d.getLabel()),handler:this.setFilter.createDelegate(this,[b,p,f,m.getId(),d.getId()],false)};var a=this.filterModel.getElementaryFiltersByFieldId(m.getId());var n=this.getValues(b,p,f,m.getId(),d.getId());for(var h=0;h<a.length;h++){if(a[h].getOperator().getId()===d.getId()&&Ext.util.JSON.encode(a[h].getValues())===Ext.util.JSON.encode(n)){o=false}}if(d.validate(n)!==true){o=false}if(o){c.push(e)}}if(c.length>0){this.quickFilterItem.setSubMenu(new Ext.menu.Menu({items:c}));return true}else{return false}}},getValues:function(a,n,d,h,j){var g=a.getStore().getAt(n);var c=g.get(a.getColumnModel().getDataIndex(d));var m;var f;if(this.fieldsOptions){for(var e=0;e<this.fieldsOptions.length;e++){if(this.fieldsOptions[e].id===h&&this.fieldsOptions[e].getterFn){m=this.fieldsOptions[e].getterFn;if(this.fieldsOptions[e].getterScope){f=this.fieldsOptions[e].getterScope}}}}if(!m){var k=this.getField(a,d);var b=k.getAvailableOperatorById(j);if(b instanceof Ext.ux.netbox.date.DateOperator&&c instanceof Date){m=this.getValuesDate}else{m=this.getValuesOther}}if(!f){f=this}var l=m.call(f,c,h,j,a,n,d);return l},getValuesOther:function(b,f,g,a,j,c){var d=a.getColumnModel().getRenderer(c);var e=a.getStore().getAt(j);var h=d(b,{},e,j,c,a.getStore());return([{label:h,value:b}])},getValuesDate:function(d,c,b,e,h,f){var g=this.filterModel.getFieldManager().getFieldById(c);var a=g.getAvailableOperatorById(b);return([{label:d.format(a.getFormat()),value:d.format("Y-m-d H:i:s")}])},setFilter:function(a,k,c,g,h){var j=this.getValues(a,k,c,g,h);var f={fieldId:g,operatorId:h,values:j};var e=true;if(!this.duplicatedElementaryFiltersAllowed){var b=this.filterModel.getElementaryFiltersByFieldId(g);for(var d=0;d<b.length;d++){if(b[d].getOperator().getId()===h&&Ext.util.JSON.encode(b[d].getValues())===Ext.util.JSON.encode(j)){e=false;break}}}if(this.isStatic){var b=this.filterModel.getElementaryFiltersByFieldId(g);for(var d=0;d<b.length;d++){this.filterModel.removeElementaryFilterById(b[d].getId())}}if(e){this.filterModel.addElementaryFilter(f);this.fireEvent("filterChanged")}},getFilterMenu:function(){if(this.quickFilterItem==null){this.quickFilterItem=new Ext.ux.netbox.ContainerMenuItem({text:this.quickFilterText,isToShow:this.filterIsToShow,scope:this})}return this.quickFilterItem},getRemoveFilterMenu:function(){if(this.removeFilterItem==null){this.removeFilterItem=new Ext.ux.netbox.ContainerMenuItem({text:this.removeText,isToShow:this.removeFilterIsToShow,scope:this})}return this.removeFilterItem},removeFilterIsToShow:function(a,k,e){var c=this.filterModel.getAllElementaryFilters();if(c.length>0){var b=[];for(var f=0;f<c.length;f++){var h=c[f].getField().getLabel()+" "+c[f].getOperator().getLabel()+" "+c[f].getOperator().render(c[f].getValues());var j="";if(c[f].isValid()!==true){j="x-icon-invalid"}var d={iconCls:j,text:h,handler:this.removeFilterById.createDelegate(this,[c[f].getId()],false),isToShow:function(){return(true)}};b.push(d)}var g={text:this.removeAllText,handler:this.removeAllFilters,scope:this,isToShow:function(){return(true)}};b.push(g);this.removeFilterItem.setSubMenu(new Ext.menu.Menu({items:b}));return true}else{return false}},removeAllFilters:function(){this.filterModel.setFilterObj(null);this.fireEvent("filterChanged")},removeFilterById:function(a){this.filterModel.removeElementaryFilterById(a);this.fireEvent("filterChanged")},getField:function(a,b){var c=a.getColumnModel().getDataIndex(b);var d=this.filterModel.getFieldManager().getFieldById(c);return d}});Ext.namespace("Ext.ux.netbox");Ext.ux.netbox.PreferenceManager=function(a){Ext.ux.netbox.PreferenceManager.superclass.constructor.call(this,a);this.addEvents({preferenceSaved:true,preferenceDeleteFailed:true,applyDefaultPreferenceFailed:true,applyPreferenceFailed:true,preferenceSaveFailed:true,preferenceDeleted:true,loadPreferencesFailed:true});this.id=a.id;this.userName=a.userName;this.setFn=a.setFn;this.getFn=a.getFn;this.fnScope=a.fnScope;this.getAllPrefURL=a.getAllPrefURL;this.applyDefaultPrefURL=a.applyDefaultPrefURL;this.loadPrefURL=a.loadPrefURL;this.savePrefURL=a.savePrefURL;this.deletePrefURL=a.deletePrefURL};Ext.extend(Ext.ux.netbox.PreferenceManager,Ext.util.Observable,{getAllPreferences:function(){if(this.store===undefined){this.store=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:this.getAllPrefURL}),baseParams:{id:this.id,userName:this.userName},reader:new Ext.data.JsonReader({root:"preferences",totalProperty:"totalCount",fields:["prefId","prefName","prefDesc",{name:"isDefault",type:"boolean"}]})});this.store.on("exception",this._loadExceptionCbk,this);this.store.setDefaultSort("prefName")}return this.store},_loadExceptionCbk:function(b,c,a){this.fireEvent("loadPreferencesFailed",a)},applyDefaultPreference:function(){Ext.Ajax.request({url:this.applyDefaultPrefURL,success:this.applyDefaultPreferenceCbk.createDelegate(this),failure:this.errorFunction.createDelegate(this),params:{id:this.id,userName:this.userName}})},applyPreference:function(b,a){if(a===undefined){Ext.Ajax.request({url:this.loadPrefURL,success:this.applyPreferenceCbk.createDelegate(this),failure:this.errorFunction.createDelegate(this),params:{id:this.id,userName:this.userName,prefId:b}})}else{this.setFn.call(this.fnScope,a)}},applyDefaultPreferenceCbk:function(a,b){if(a.responseText!=""){this.applyPreferenceCbk(a,b)}},applyPreferenceCbk:function(b,c){var a=Ext.util.JSON.decode(b.responseText);this.setFn.call(this.fnScope,a)},savePreference:function(g,b,f,e){var c=this.getFn.call(this.fnScope);var d=Ext.util.JSON.encode(c);var a={url:this.savePrefURL,params:{id:this.id,userName:this.userName,prefId:g,prefName:b,prefDesc:f,prefValue:d,isDefault:e},success:this._onSaveSuccessCbk.createDelegate(this),failure:this._onSaveFailureCbk.createDelegate(this)};Ext.Ajax.request(a)},_onSaveSuccessCbk:function(a,b){this.fireEvent("preferenceSaved",b.params.prefId,b.params.prefName)},_onSaveFailureCbk:function(a,b){this.fireEvent("preferenceSaveFailed",b.params.prefId,b.params.prefName,a)},deletePreferences:function(b){var a={url:this.deletePrefURL,params:{id:this.id,userName:this.userName,prefIdArray:b},success:this._onDeleteSuccessCbk.createDelegate(this),failure:this._onDeleteFailureCbk.createDelegate(this)};Ext.Ajax.request(a)},_onDeleteSuccessCbk:function(a,b){this.fireEvent("preferenceDeleted",b.params.prefIdArray)},_onDeleteFailureCbk:function(a,b){this.fireEvent("preferenceDeleteFailed",b.params.prefIdArray,a)},errorFunction:function(a,b){if(b.params.prefId===undefined){this.fireEvent("applyDefaultPreferenceFailed",a)}else{this.fireEvent("applyPreferenceFailed",b.params.prefId,a)}}});Ext.namespace("Ext.ux.netbox");Ext.ux.netbox.PreferenceManagerView=function(a){Ext.QuickTips.init();this.preferenceManager=a.preferenceManager;Ext.ux.netbox.PreferenceManagerView.superclass.constructor.call(this,a);this.preferenceManager.on("preferenceSaved",this.onPreferenceSaved,this);this.preferenceManager.on("preferenceDeleted",this.onPreferenceDeleted,this);this.preferenceManager.on("loadPreferencesFailed",this.resetMenu,this);if(a.defaultErrorHandling===undefined||a.defaultErrorHandling){new Ext.ux.netbox.DefaultPreferenceManagerErrorManager(this.preferenceManager)}this.on("show",this.loadRemotePref,this,{single:true})};Ext.extend(Ext.ux.netbox.PreferenceManagerView,Ext.menu.Menu,{addText:"Add preference",addTooltipText:"Save the actual configuration",manageText:"Manage preferences",manageTooltipText:"Manage the saved configurations",okText:"OK",cancelText:"Cancel",modifyText:"Modify preference",modifyBtnText:"Modify",deleteBtnText:"Delete",closeBtnText:"Close",nameText:"Name",descText:"Description",defaultText:"Default",loadingText:"Loading...",loadRemotePref:function(){if(this.prefStore===undefined){this.prefStore=this.preferenceManager.getAllPreferences();this.prefStore.on("load",this.loadRemotePrefAsync,this);this.prefStore.on("beforeload",this.beforeLoad,this);this.createStableItems()}this.prefStore.load()},createStableItems:function(){if(this.items.getCount()==0){this.add({text:this.addText,tooltip:this.addTooltipText,handler:this.addPreference,scope:this},{text:this.manageText,tooltip:this.manageTooltipText,handler:this.showManageDialog,scope:this},"-")}},beforeLoad:function(){this.resetMenu();this.getEl().mask(this.loadingText)},resetMenu:function(){if(this.getEl()){this.getEl().unmask()}for(var a=this.items.getCount()-1;a>=0;a--){if(this.items.get(a).removable===true){if(this.items.get(a).getEl()&&this.items.get(a).getEl().isMasked()){this.items.get(a).getEl().unmask()}this.remove(this.items.get(a))}}},loadRemotePrefAsync:function(){this.resetMenu();for(var b=0;b<this.prefStore.getTotalCount();b++){var c=this.prefStore.getAt(b);var a="";if(c.get("isDefault")==true){a="x-icon-checked"}this.add({id:c.get("prefId"),text:c.get("prefName"),tooltip:c.get("prefDesc"),iconCls:a,handler:this.applyPreference,scope:this,removable:true})}},addPreference:function(){this.showAddDialog("","","",false)},managePreference:function(){selModel=this.manageGridPanel.getSelectionModel();record=selModel.getSelected();if(record){this.showAddDialog(record.get("prefId"),record.get("prefName"),record.get("prefDesc"),record.get("isDefault"))}},deletePreferences:function(){selModel=this.manageGridPanel.getSelectionModel();records=selModel.getSelections();if(records.length>0){var b=[];for(var a=0;a<records.length;a++){b.push(records[a].get("prefId"))}this.preferenceManager.deletePreferences(b)}},showAddDialog:function(d,a,c,b){if(!this.addDialog){this.addDialog=new Ext.Window({width:400,height:160,minWidth:400,minHeight:160,closeAction:"hide",layout:"fit",plain:true,modal:true,shadow:true,items:this.addForm=new Ext.form.FormPanel({labelWidth:75,border:false,bodyStyle:"background-color:transparent;padding:10px; ",items:[{id:"prefId",xtype:"hidden",name:"prefId",value:d},{id:"prefName",xtype:"textfield",fieldLabel:this.nameText,name:"prefName",value:a,allowBlank:false,width:"96%"},{id:"prefDesc",xtype:"textfield",fieldLabel:this.descText,name:"prefDesc",value:c,width:"96%"},{id:"isDefault",xtype:"checkbox",fieldLabel:this.defaultText,name:"isDefault",checked:b}]}),buttons:[{text:this.okText,handler:this.savePreference,scope:this},{text:this.cancelText,handler:function(){this.addDialog.hide()},scope:this}]})}else{this.addForm.findById("prefId").setValue(d);this.addForm.findById("prefName").setValue(a);this.addForm.findById("prefDesc").setValue(c);this.addForm.findById("isDefault").setValue(b)}if(d!=""){this.addDialog.setTitle(this.modifyText)}else{this.addDialog.setTitle(this.addText)}this.addDialog.show()},showManageDialog:function(){if(!this.manageDialog){this.manageDialog=new Ext.Window({title:this.manageText,width:600,height:300,minWidth:500,minHeight:250,closeAction:"hide",layout:"fit",plain:true,modal:true,shadow:true,items:this.manageGridPanel=new Ext.grid.GridPanel({store:this.prefStore,border:false,enableColumnHide:false,columns:[{id:"prefId",hidden:true,dataIndex:"prefId"},{id:"prefName",header:this.nameText,sortable:true,dataIndex:"prefName",width:200},{id:"prefDesc",header:this.descText,sortable:true,dataIndex:"prefDesc",width:330},{id:"isDefault",header:this.defaultText,sortable:true,dataIndex:"isDefault",width:60,renderer:this.imageRenderer}],viewConfig:{forceFit:true},tbar:[{text:this.modifyBtnText,cls:"x-btn-text-icon",iconCls:"x-icon-modify",handler:this.managePreference,scope:this},"-",{text:this.deleteBtnText,cls:"x-btn-text-icon",iconCls:"x-icon-delete",handler:this.deletePreferences,scope:this},"-",{text:this.closeBtnText,cls:"x-btn-text-icon",iconCls:"x-icon-cancel",handler:function(){this.manageDialog.hide()},scope:this}]})})}this.manageDialog.show()},imageRenderer:function(e,d,a,f,c,b){if(e==true){return('<img class="x-menu-item-icon x-icon-checked" src="'+Ext.BLANK_IMAGE_URL+'"/>')}},applyPreference:function(b,a){this.preferenceManager.applyPreference(b.getId())},savePreference:function(){var d=this.addForm.findById("prefId");var a=this.addForm.findById("prefName");var c=this.addForm.findById("prefDesc");var b=this.addForm.findById("isDefault");if(a.isValid()){this.preferenceManager.savePreference(d.getValue(),a.getValue(),c.getValue(),b.getValue())}},onPreferenceSaved:function(a,b){this.prefStore.reload();this.addDialog.hide()},onPreferenceDeleted:function(a){this.prefStore.reload()}});Ext.ux.netbox.DefaultPreferenceManagerErrorManager=function(a){a.on("applyDefaultPreferenceFailed",this.manageApplyDefaultPreferenceFailed,this);a.on("applyPreferenceFailed",this.manageApplyPreferenceFailed,this);a.on("loadPreferencesFailed",this.manageLoadPreferencesFailed,this);a.on("preferenceDeleteFailed",this.manageDeletePreferencesFailed,this);a.on("preferenceSaveFailed",this.manageSavePreferenceFailed,this)};Ext.ux.netbox.DefaultPreferenceManagerErrorManager.prototype={failedToApplyDefaultPreferenceTitle:"Error applying default preference",failedToApplyPreferenceTitle:"Error applying preference",failedToSavePreferenceTitle:"Error saving preference",failedToDeletePreferenceTitle:"Error deleting preference(s)",failedToLoadPreferenceTitle:"Error loading preferences",manageApplyDefaultPreferenceFailed:function(a){this.manageError(this.failedToApplyDefaultPreferenceTitle,a.responseText)},manageApplyPreferenceFailed:function(b,a){this.manageError(this.failedToApplyPreferenceTitle,a.responseText)},manageSavePreferenceFailed:function(c,a,b){this.manageError(this.failedToSavePreferenceTitle,b.responseText)},manageDeletePreferencesFailed:function(a,b){this.manageError(this.failedToDeletePreferenceTitle,b.responseText)},manageLoadPreferencesFailed:function(a){this.manageError(this.failedToLoadPreferenceTitle,a.responseText)},manageError:function(b,a){Ext.MessageBox.show({title:b,msg:a,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.ERROR,minWidth:200})}};Ext.namespace("Ext.ux.netbox.core");Ext.ux.netbox.core.FilterHeaderPlugin=function(a){this.filterModel=a};Ext.ux.netbox.core.FilterHeaderPlugin.prototype={filterCls:"ux-filtered-column",init:function(a){this.grid=a;a.on("render",this.onRender,this)},onRender:function(){this.grid.getView().on("refresh",this.onRefresh,this);this.updateColumnHeadings(this.grid.getView())},onRefresh:function(a){this.updateColumnHeadings(a)},updateColumnHeadings:function(b){if(!b||!b.mainHd){return}var f=b.mainHd.select("td").removeClass(this.filterCls);for(var d=0,a=b.cm.config.length;d<a;d++){var e=this.filterModel.getElementaryFiltersByFieldId(b.cm.config[d].dataIndex);for(var c=0;c<e.length;c++){if(e[c].isValid()===true){f.item(d).addClass(this.filterCls);break}}}}};Ext.ns("Ext.ux.grid");if("function"!==typeof RegExp.escape){RegExp.escape=function(a){if("string"!==typeof a){return a}return a.replace(/([.*+?\^=!:${}()|\[\]\/\\])/g,"\\$1")}}Ext.ux.grid.RowActions=function(a){Ext.apply(this,a);this.addEvents("beforeaction","action","beforegroupaction","groupaction");Ext.ux.grid.RowActions.superclass.constructor.call(this)};Ext.extend(Ext.ux.grid.RowActions,Ext.util.Observable,{actionEvent:"click",autoWidth:true,dataIndex:"",header:"",keepSelection:false,menuDisabled:true,sortable:false,isColumn:true,tplGroup:'<tpl for="actions"><div class="ux-grow-action-item<tpl if="\'right\'===align"> ux-action-right</tpl> {cls}" style="{style}" qtip="{qtip}">{text}</div></tpl>',tplRow:'<div class="ux-row-action"><tpl for="actions"><div class="ux-row-action-item {cls} <tpl if="text">ux-row-action-text</tpl>" style="{hide}{style}" qtip="{qtip}"><tpl if="text"><span qtip="{qtip}">{text}</span></tpl></div></tpl></div>',hideMode:"visiblity",widthIntercept:4,widthSlope:22,init:function(c){this.grid=c;if(!this.tpl){this.tpl=this.processActions(this.actions)}if(this.autoWidth){this.width=this.widthSlope*this.actions.length+this.widthIntercept;this.fixed=true}var b=c.getView();var a={scope:this};a[this.actionEvent]=this.onClick;c.afterRender=c.afterRender.createSequence(function(){b.mainBody.on(a);c.on("destroy",this.purgeListeners,this)},this);if(!this.renderer){this.renderer=function(h,d,e,j,g,f){d.css+=(d.css?" ":"")+"ux-row-action-cell";return this.tpl.apply(this.getData(h,d,e,j,g,f))}.createDelegate(this)}if(b.groupTextTpl&&this.groupActions){b.interceptMouse=b.interceptMouse.createInterceptor(function(d){if(d.getTarget(".ux-grow-action-item")){return false}});b.groupTextTpl='<div class="ux-grow-action-text">'+b.groupTextTpl+"</div>"+this.processActions(this.groupActions,this.tplGroup).apply()}if(true===this.keepSelection){c.processEvent=c.processEvent.createInterceptor(function(d,f){if("mousedown"===d){return !this.getAction(f)}},this)}},getData:function(e,a,b,f,d,c){return b.data||{}},processActions:function(d,c){var a=[];Ext.each(d,function(e,f){if(e.iconCls&&"function"===typeof(e.callback||e.cb)){this.callbacks=this.callbacks||{};this.callbacks[e.iconCls]=e.callback||e.cb}var g={cls:e.iconIndex?"{"+e.iconIndex+"}":(e.iconCls?e.iconCls:""),qtip:e.qtipIndex?"{"+e.qtipIndex+"}":(e.tooltip||e.qtip?e.tooltip||e.qtip:""),text:e.textIndex?"{"+e.textIndex+"}":(e.text?e.text:""),hide:e.hideIndex?'<tpl if="'+e.hideIndex+'">'+("display"===this.hideMode?"display:none":"visibility:hidden")+";</tpl>":(e.hide?("display"===this.hideMode?"display:none":"visibility:hidden;"):""),align:e.align||"right",style:e.style?e.style:""};a.push(g)},this);var b=new Ext.XTemplate(c||this.tplRow);return new Ext.XTemplate(b.apply({actions:a}))},getAction:function(c){var b=false;var a=c.getTarget(".ux-row-action-item");if(a){b=a.className.replace(/ux-row-action-item /,"");if(b){b=b.replace(/ ux-row-action-text/,"");b=b.trim()}}return b},onClick:function(g,h){var j=this.grid.getView();var m=g.getTarget(".x-grid3-row");var a=j.findCellIndex(h.parentNode.parentNode);var c=this.getAction(g);if(false!==m&&false!==a&&false!==c){var f=this.grid.store.getAt(m.rowIndex);if(this.callbacks&&"function"===typeof this.callbacks[c]){this.callbacks[c](this.grid,f,c,m.rowIndex,a)}if(true!==this.eventsSuspended&&false===this.fireEvent("beforeaction",this.grid,f,c,m.rowIndex,a)){return}else{if(true!==this.eventsSuspended){this.fireEvent("action",this.grid,f,c,m.rowIndex,a)}}}t=g.getTarget(".ux-grow-action-item");if(t){var k=j.findGroup(h);var d=k?k.id.replace(/ext-gen[0-9]+-gp-/,""):null;var b;if(d){var l=new RegExp(RegExp.escape(d));b=this.grid.store.queryBy(function(e){return e._groupId.match(l)});b=b?b.items:[]}c=t.className.replace(/ux-grow-action-item (ux-action-right )*/,"");if("function"===typeof this.callbacks[c]){this.callbacks[c](this.grid,b,c,d)}if(true!==this.eventsSuspended&&false===this.fireEvent("beforegroupaction",this.grid,b,c,d)){return false}this.fireEvent("groupaction",this.grid,b,c,d)}}});Ext.reg("rowactions",Ext.ux.grid.RowActions);if(!Ext.isArray){Ext.isArray=function(a){return a&&typeof a.pop==="function"}}Ext.ux.IconMenu=function(a){Ext.apply(this,a);Ext.ux.IconMenu.superclass.constructor.apply(this,arguments)};Ext.extend(Ext.ux.IconMenu,Ext.util.Observable,{closeText:"Close",createDefault:true,dblClickClose:true,defaultItems:["restore","minimize","maximize","separator","close"],maximizeText:"Maximize",minimizeText:"Minimize",restoreText:"Restore",style:"width:16px;height:16px;left:0;top:4px;position:absolute;cursor:pointer",closeHandler:function(){if(this.panel.closable){var a=this.panel.closeAction;if("hide"!==a){this.onDestroy()}this.panel[a]()}},getItemByCmd:function(b){if(!this.menu||!b){return null}var a=this.menu.items.find(function(c){return b===c.cmd});return a},hideMenu:function(){if(this.menu){this.menu.hide()}},init:function(b){this.panel=b;this.iconCls=this.iconCls||b.iconCls;b.on({scope:this,render:this.onRender,hide:this.hideMenu,destroy:this.onDestroy});var c,a,d;var e="im-"+b.id;if(this.createDefault&&Ext.isArray(this.defaultItems)&&this.defaultItems.length){if(this.menu){this.menu.add("-")}else{this.menu=new Ext.menu.Menu({id:e})}for(c=0;c<this.defaultItems.length;c++){this.addItem(this.defaultItems[c])}}if(Ext.isArray(this.customItems)){if(!this.menu){this.menu=new Ext.menu.Menu({id:e})}for(c=0;c<this.customItems.length;c++){this.addItem(this.customItems[c])}}if(this.menu){this.menu.id=this.menu.id||e;this.menu=Ext.menu.MenuMgr.get(this.menu);this.menu.on("show",this.onMenuShow,this);this.menu.on("hide",this.onMenuHide,this);this.menu.parentPanel=this.panel}},addItem:function(b){if("separator"===b||"-"===b){this.menu.add("-");return}var a;if("string"===typeof b){a={text:this[b+"Text"],cmd:b,iconCls:"x-im-icon x-tool x-tool-"+b,scope:this,handler:this[b+"Handler"]}}else{a=b}this.menu.add(a)},maximizeHandler:function(){this.hideMenu();if(this.panel.maximizable){this.panel.maximize()}},minimizeHandler:function(){this.hideMenu();if(this.panel.minimizable){this.panel.minimize()}},onDestroy:function(){if(this.menu){var a=this.menu.getEl();if(a.shadow&&a.shadow.el){a.shadow.el.remove()}this.menu.destroy();a.remove();this.menu=null}},onMenuHide:function(a){this.ignoreNextClick=this.restoreClick.defer(350,this)},onMenuShow:function(a){this.ignoreNextClick=0},onRender:function(){var c=this.panel.header;if(!c){return}Ext.util.CSS.createStyleSheet(".x-im-icon{float:none!important;margin-left:0!important}");c.addClass("x-panel-icon");c.applyStyles({position:"relative"});this.icon=c.insertFirst({tag:"div",id:Ext.id(),style:this.style,cls:this.iconCls,qtip:this.qtip||this.tooltip||""},"first");var a=c.down("img");if(a){this.icon.alignTo(a,"tl-tl");a.removeClass(this.panel.iconCls||this.iconCls);a.set({src:Ext.BLANK_IMAGE_URL})}this.icon.on({scope:this,dblclick:function(){if(this.dblClickClose){this.closeHandler()}},click:{scope:this,delay:200,fn:function(f,d){if(this.menu&&!this.menu.isVisible()&&!this.ignoreNextClick){this.showMenu()}}}});this.panel.setIconClass=this.setIconClass.createDelegate(this);Ext.util.CSS.getRule(".x-panel-tl .x-panel-icon, .x-window-tl .x-panel-icon",true);if(Ext.isIE){Ext.util.CSS.updateRule(".x-panel-tl .x-panel-icon","padding","");Ext.util.CSS.updateRule(".x-panel-tl .x-panel-icon","padding","5px 0 4px 0");Ext.util.CSS.updateRule(".x-window-tl .x-panel-icon","padding","");Ext.util.CSS.updateRule(".x-window-tl .x-panel-icon","padding","5px 0 4px 0")}else{Ext.util.CSS.updateRule(".x-panel-tl .x-panel-icon, .x-window-tl .x-panel-icon","padding","");Ext.util.CSS.updateRule(".x-panel-tl .x-panel-icon, .x-window-tl .x-panel-icon","padding","5px 0 4px 0")}var b=this.icon.getWidth()+4+"px !important";Ext.util.CSS.createStyleSheet(".x-im-header{padding-left:"+b+";}");c.addClass("x-im-header")},restoreClick:function(){this.ignoreNextClick=0},restoreHandler:function(){this.hideMenu();this.panel.restore()},setIconClass:function(a){this.icon.replaceClass(this.iconCls,a)},showMenu:function(){var a;if(this.menu){try{a=this.getItemByCmd("close");if(a){a.setDisabled(!this.panel.closable)}a=this.getItemByCmd("maximize");if(a){a.setDisabled(!this.panel.maximizable||this.panel.maximized)}a=this.getItemByCmd("minimize");if(a){a.setDisabled(!this.panel.minimizable||this.panel.minimized)}a=this.getItemByCmd("restore");if(a){a.setDisabled(!(this.panel.minimized||this.panel.maximized))}this.menu.show(this.icon,"tl-bl?")}catch(b){}}}});Ext.reg("iconmenu",Ext.ux.IconMenu);Ext.ns("Ext.ux.grid");Ext.ux.grid.RecordForm=function(a){Ext.apply(this,a);Ext.ux.grid.RecordForm.superclass.constructor.call(this)};Ext.extend(Ext.ux.grid.RecordForm,Ext.util.Observable,{autoHide:true,cancelIconCls:"icon-cancel",cancelText:"Cancel",columnCount:1,defaultFormConfig:{border:false,frame:true,autoHeight:true,labelWidth:100},defaultWindowConfig:{border:false,width:480,autoHeight:true,layout:"fit",closeAction:"hide",modal:true,plugins:[new Ext.ux.IconMenu({defaultItems:[]})]},dirtyRowCls:"ux-grid3-dirty-row",focusDefer:200,mapping:{auto:"textfield","boolean":"checkbox",date:"datefield","float":"numberfield","int":"numberfield",string:"textfield"},newRowCls:"ux-grid3-new-row",okIconCls:"icon-ok",okText:"OK",showButtons:true,init:function(a){a.afterRender=a.afterRender.createSequence(function(){if("function"===typeof a.view.getRowClass){a.view.getRowClass=a.view.getRowClass.createSequence(this.getRowClass,this)}else{a.view.getRowClass=this.getRowClass.createDelegate(this)}if(this.autoShow){this.show({data:{}})}},this);this.grid=a;a.reconfigure=a.reconfigure.createSequence(this.reconfigure,this);this.reconfigure()},afterUpdateRecord:Ext.emptyFn,createFormConfig:function(){if(this.form){return}var c=this.grid.getColumnModel();var b=this.grid.store.recordType.prototype.fields;var d=this.grid.store;this.form=Ext.apply({xtype:"form",items:[{layout:"column",anchor:"100%",border:false,monitorValid:true,autoHeight:true,defaults:{columnWidth:1/this.columnCount,autoHeight:true,border:false,layout:"form",hideLabel:true},items:(function(){var f=[];for(var g=0;g<this.columnCount;g++){f.push({defaults:{anchor:"-25"},items:[]})}return f}).createDelegate(this)()}],buttons:(function(){if(this.showButtons){return[{text:this.okText,iconCls:this.okIconCls,scope:this,handler:this.onOK,formBind:true},{text:this.cancelText,iconCls:this.cancelIconCls,scope:this,handler:this.onCancel}]}else{return[]}}).createDelegate(this)(),keys:[{key:[10,13],scope:this,stopEvent:true,fn:this.onOK}]},this.formConfig,this.defaultFormConfig);var e=0;var a=1;b.each(function(h,g){if(this.ignoreFields&&this.ignoreFields[h.name]){return}var k=this.findConfig(c,h.name);var j={};if(k&&k.editor&&k.editor.field){Ext.apply(j,{xtype:k.editor.field.getXType(),fieldLabel:k.header},k.editor.field.initialConfig)}else{Ext.apply(j,{fieldLabel:(k&&k.header?k.header:h.name),xtype:this.mapping[h.type]||"textfield"});if("date"===h.type&&h.dateFormat){j.format=h.dateFormat}}if(this.readonlyFields&&true===this.readonlyFields[h.name]){j.readOnly=true}if(this.disabledFields&&true===this.disabledFields[h.name]){j.disabled=true}j.name=h.name;j.tabIndex=a++;if("datefield"===j.xtype||"timefield"===j.xtype||"datetime"===j.xtype){j.anchor=""}if("textarea"===j.xtype){j.grow=false;j.autoHeight=true}this.form.items[0].items[e++].items.push(j);e=e===this.columnCount?0:e},this)},findConfig:function(a,c){var b=null;Ext.each(a.config,function(e,d){if(b){return}if(c===e.dataIndex){b=e}});return b},getRowClass:function(a){if(a.get("newRecord")){return this.newRowCls}if(a.dirty){return this.dirtyRowCls}return""},onDestroy:function(){if(this.window){this.window.destroy();this.window=null;this.form=null}else{if(this.form){if("function"===typeof this.form.destroy){this.form.destroy()}this.form=null}}},onOK:function(){this.updateRecord();if(this.autoHide){this.window.hide(null)}},onCancel:function(){if(this.record.get("newRecord")&&!this.record.dirty){this.record.store.remove(this.record)}if(this.autoHide){this.window.hide(null)}},reconfigure:function(){this.onDestroy();this.createFormConfig()},getPanel:function(){if(this.window){return this.window}if(this.formCt){var a=Ext.getCmp(this.formCt);if(a){a.add(this.form);a.doLayout()}else{a=Ext.fly(this.formCt);if(a){a=new Ext.Panel({renderTo:a,items:this.form})}}}else{var b=Ext.apply({},this.defaultWindowConfig);b=Ext.apply(b,this.windowConfig);Ext.applyIf(b,{title:this.title||this.grid.title,iconCls:this.iconCls||this.grid.iconCls,items:this.form,listeners:{show:{scope:this,delay:this.focusDefer,fn:function(){this.form.startMonitoring();var d=this.form.getForm();d.items.itemAt(0).focus();d.isValid()}},hide:{scope:this,fn:function(){this.form.stopMonitoring()}}}});var c=new Ext.Window(b);this.form=c.items.itemAt(0);return c}a.on({show:{scope:this,delay:this.focusDefer,fn:function(){this.form.startMonitoring();var d=this.form.getForm();d.items.itemAt(0).focus();d.isValid()}},hide:{scope:this,fn:function(){this.form.stopMonitoring()}}});this.form=a.items.itemAt(0);return a},show:function(b,c){if(!this.window){this.window=this.getPanel()}this.window.show(c);var a=this.form.getForm();a.loadRecord(b);this.record=b},updateRecord:function(){this.form.getForm().items.each(function(b,a){this.record.set(b.name,b.getValue())},this);this.afterUpdateRecord(this.record)}});Ext.reg("gridrecordform",Ext.ux.grid.RecordForm);Ext.namespace("Ext.ux");if(!Ext.ux.Utility){Ext.ux.Utility={isNullOrUndefined:function(a){return(typeof a=="undefined"||a==null||(typeof a=="string"&&a=="undefined"))},isFunction:function(a){return typeof a=="function"}}}Ext.ux.FieldReadOnlyPlugin=function(){this.init=function(a){a.setReadOnly=function(c){if(a.readOnly){return}a._readOnly=c;if(a.rendered){if(Ext.ux.Utility.isNullOrUndefined(a.editable)||a.editable===true){var b=a.getEl();b.dom.setAttribute("readOnly",c);b.dom.readOnly=c}}else{a.readOnly=c}};if(Ext.ux.Utility.isFunction(a.expand)){a.expand=a.expand.createInterceptor(function(){return !a._readOnly})}if(Ext.ux.Utility.isFunction(a.onTriggerClick)){a.onTriggerClick=a.onTriggerClick.createInterceptor(function(){return !a._readOnly})}if(Ext.ux.Utility.isFunction(a.onClick)){a.onClick=a.onClick.createInterceptor(function(){if(a._readOnly){this.el.dom.checked=a.checked}return !a._readOnly})}if(Ext.ux.Utility.isFunction(a.setValue)&&a instanceof Ext.form.Checkbox){a.setValue=a.setValue.createInterceptor(function(){return !a._readOnly})}}};Ext.ux.CenterWindowPlugin=function(){this.init=function(a){Ext.EventManager.onWindowResize(function(){a.center()})}};Ext.ux.ThemeCombo=Ext.extend(Ext.form.ComboBox,{themeBlueText:"Ext Blue Theme",themeGrayText:"Gray Theme",themeDarkGrayText:"Dark Gray Theme",themeSlateText:"Slate Theme",themeVistaText:"Vista Theme",themeAccessText:"Vista Theme",selectThemeText:"Access Theme",lazyRender:true,lazyInit:true,cssPath:"./css/",initComponent:function(){Ext.apply(this,{store:new Ext.data.SimpleStore({fields:["themeFile","themeName"],data:[["xtheme-blue.css",this.themeBlueText],["xtheme-gray.css",this.themeGrayText],["xtheme-darkgray.css",this.themeDarkGrayText],["xtheme-slate.css",this.themeSlateText],["xtheme-vista.css",this.themeVistaText],["xtheme-access.css",this.themeAccessText]]}),valueField:"themeFile",displayField:"themeName",triggerAction:"all",width:195,mode:"local",forceSelection:true,editable:false,fieldLabel:this.selectThemeText});Ext.ux.ThemeCombo.superclass.initComponent.apply(this,arguments)},onSelect:function(){Ext.ux.ThemeCombo.superclass.onSelect.apply(this,arguments);var a=this.getValue();Ext.util.CSS.swapStyleSheet("theme",this.cssPath+a);if(Ext.state.Manager.getProvider()){Ext.state.Manager.set("theme",a)}}});Ext.reg("themecombo",Ext.ux.ThemeCombo);Ext.ux.ThemeCycleButton=Ext.extend(Ext.CycleButton,{cssItems:[{file:"xtheme-default.css",text:"Ext Blue&nbsp;"},{file:"xtheme-gray.css",text:"Gray&nbsp;"},{file:"xtheme-darkgray.css",text:"Dark Gray&nbsp;"},{file:"xtheme-slate.css",text:"Slate&nbsp;"},{file:"xtheme-vista.css",text:"Vista&nbsp;"},{file:"xtheme-access.css",text:"Access&nbsp;"}],themeVar:"style",cssPath:"./css/",initComponent:function(){Ext.apply(this,{showText:true,width:115,prependText:"Theme:&nbsp;",items:this.cssItems});if(Ext.state.Manager){var b=Ext.state.Manager.get(this.themeVar);if(b){for(var a=0;a<this.items.length;a++){if(this.items[a].file==b){this.items[a].checked=true;this.changeHandler.defer(100,this,[this,this.items[a]]);break}}}else{this.items[0].checked=true}}Ext.ux.ThemeCycleButton.superclass.initComponent.apply(this,arguments)},changeHandler:function(b,a){if(Ext.state.Manager.getProvider()){Ext.state.Manager.set(this.themeVar,a.file)}Ext.util.CSS.swapStyleSheet(this.themeVar,this.cssPath+a.file)}});Ext.reg("themecyclebutton",Ext.ux.ThemeCycleButton);Ext.namespace("ux");ux.TabPanel=Ext.extend(Ext.TabPanel,{enableTabScroll:false,afterRender:function(){ux.TabPanel.superclass.afterRender.call(this);var j=this[this.stripTarget].dom;var v='<td style="height:27px;width:100%;border-right:0px;"><div id="td_tabs" style="margin:0px;height:27px;"></div></td>';var c=this.initialConfig.toolbars;var d,l;for(var m=0,h=c.length;m<h;m++){if(c[m].align.toLowerCase()=="left"){d=c[m]}else{l=c[m]}}var a=(d)?d.id:"leftTbar";var b=(l)?l.id:"rightTbar";var n="border-top:1px solid #8DB2E3;margin:0px;";var f='<td><div id="'+a+'" class="x-tab-toolbar-wrap" style="border-left:1px solid #8DB2E3;'+n+'"></div></td>';var q='<td><div id="'+b+'" class="x-tab-toolbar-wrap" style="border-right:1px solid #8DB2E3;'+n+'"></div></td>';var g='<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr>';var o="</tr></table>";var u=g+(d?f:"")+v+(l?q:"")+o;var e=j.parentNode;e.removeChild(this[this.stripTarget].dom);Ext.DomHelper.insertFirst(e,u);var v=Ext.get("td_tabs");v.dom.appendChild(j);if(d){var k=new Ext.Panel({renderTo:a,border:false,width:d.width,tbar:d.tbar,height:0});if(Ext.isIE){var s=k.bwrap;s.dom.removeChild(s.dom.lastChild)}}if(l){var k=new Ext.Panel({renderTo:b,border:false,width:l.width-1,tbar:l.tbar,height:0});if(Ext.isIE){var s=k.bwrap;s.dom.removeChild(s.dom.lastChild)}}this.fixTabStripWidth()},initEvents:function(){ux.TabPanel.superclass.initEvents.call(this);this.on("afterlayout",this.fixTabStripWidth,this)},fixTabStripWidth:function(){var a=this.getScrollArea();this.strip.setWidth(a);this[this.stripTarget].setWidth(a);if(this[this.stripTarget].first){this[this.stripTarget].first().setWidth(a)}},getScrollArea:function(){var a=0;if(this.initialConfig.toolbars){for(var b=0;b<this.initialConfig.toolbars.length;b++){a+=this.initialConfig.toolbars[b].width}}a=this.el.dom.clientWidth-a-1;return a}});Ext.reg("uxTabPanel",ux.TabPanel);Ext.ns("Ext.ux.grid");(function(){var a=/^(?:col|e|w)-resize$/;Ext.ux.grid.AutoSizeColumns=Ext.extend(Object,{cellPadding:8,constructor:function(b){Ext.apply(this,b)},init:function(c){var b=c.getView();b.onHeaderClick=b.onHeaderClick.createInterceptor(this.onHeaderClick);c.on("headerdblclick",this.onHeaderDblClick.createDelegate(b,[this.cellPadding],3))},onHeaderClick:function(c,b){var d=this.getHeaderCell(b);if(a.test(d.style.cursor)){return false}},onHeaderDblClick:function(c,b,j,h){var f=this.getHeaderCell(b),d,k,g;if(!a.test(f.style.cursor)){return}if(j.getXY()[0]-Ext.lib.Dom.getXY(f)[0]<=5){b--;f=this.getHeaderCell(b)}if(this.cm.isFixed(b)||this.cm.isHidden(b)){return}f=f.firstChild;f.style.width="0px";d=f.scrollWidth;f.style.width="auto";for(k=0,g=this.ds.getCount();k<g;k++){f=this.getCell(k,b).firstChild;f.style.width="0px";d=Math.max(d,f.scrollWidth);f.style.width="auto"}this.onColumnSplitterMoved(b,d+h)}})})();Ext.preg("autosizecolumns",Ext.ux.grid.AutoSizeColumns);Ext.ux.PanelBlind=Ext.extend(Ext.Panel,{constructor:function(a){a=Ext.apply({autoHeight:true,layout:"fit",floating:true,cls:"x-blind",buttonAlign:"center",buttons:[{text:"OK and Close",handler:this.dismiss,scope:this}]},a);Ext.ux.PanelBlind.superclass.constructor.call(this,a)},init:function(a){this.client=a;if(!this.client.blinds){this.client.blinds=new Ext.util.MixedCollection()}a.blinds.add(this);this.client.constructor.prototype.showBlind=this.clientShowBlind;this.client.constructor.prototype.dismissBlind=this.clientDismissBlind;this.client.on({destroy:this.destroy,resize:this.syncSizeWithClient,scope:this})},syncSizeWithClient:function(){this.setWidth(this.client.body.getSize(true).width)},clientShowBlind:function(c){var a=this.blinds.get(c);if(a){a.show()}},clientDismissBlind:function(c){var a=this.blinds.get(c);if(a){a.dismiss()}},show:function(){var a=this.client.getEl().mask();if(!this.rendered){this.render(this.client.getEl())}this.el.setZIndex(Number(a.getStyle("z-index"))+1);this.el.disableShadow();this.syncSizeWithClient();this.el.alignTo(this.client.body,"tl-tl");this.el.slideIn("t",{callback:function(){this.el.visible=true;this.el.enableShadow(true)},scope:this})},dismiss:function(){if(this.destroyOnDismiss){this.destroy();delete this.client.blinds[this.id]}else{this.el.disableShadow();this.el.slideOut("t");this.client.getEl().unmask()}}});var Base64=(function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function b(e){e=e.replace(/\r\n/g,"\n");var d="";for(var g=0;g<e.length;g++){var f=e.charCodeAt(g);if(f<128){d+=String.fromCharCode(f)}else{if((f>127)&&(f<2048)){d+=String.fromCharCode((f>>6)|192);d+=String.fromCharCode((f&63)|128)}else{d+=String.fromCharCode((f>>12)|224);d+=String.fromCharCode(((f>>6)&63)|128);d+=String.fromCharCode((f&63)|128)}}}return d}return{encode:(typeof btoa=="function")?function(c){return btoa(c)}:function(e){var c="";var m,k,h,l,j,g,f;var d=0;e=b(e);while(d<e.length){m=e.charCodeAt(d++);k=e.charCodeAt(d++);h=e.charCodeAt(d++);l=m>>2;j=((m&3)<<4)|(k>>4);g=((k&15)<<2)|(h>>6);f=h&63;if(isNaN(k)){g=f=64}else{if(isNaN(h)){f=64}}c=c+a.charAt(l)+a.charAt(j)+a.charAt(g)+a.charAt(f)}return c}}})();Ext.override(Ext.grid.GridPanel,{getExcelXml:function(b){var c=this.createWorksheet(b);var a=this.getColumnModel().getTotalWidth(b);return'<?xml version="1.0" encoding="utf-8"?><ss:Workbook xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:o="urn:schemas-microsoft-com:office:office"><o:DocumentProperties><o:Title>'+this.title+"</o:Title></o:DocumentProperties><ss:ExcelWorkbook><ss:WindowHeight>"+c.height+"</ss:WindowHeight><ss:WindowWidth>"+c.width+'</ss:WindowWidth><ss:ProtectStructure>False</ss:ProtectStructure><ss:ProtectWindows>False</ss:ProtectWindows></ss:ExcelWorkbook><ss:Styles><ss:Style ss:ID="Default"><ss:Alignment ss:Vertical="Top" ss:WrapText="1" /><ss:Font ss:FontName="arial" ss:Size="10" /><ss:Borders><ss:Border ss:Color="#e4e4e4" ss:Weight="1" ss:LineStyle="Continuous" ss:Position="Top" /><ss:Border ss:Color="#e4e4e4" ss:Weight="1" ss:LineStyle="Continuous" ss:Position="Bottom" /><ss:Border ss:Color="#e4e4e4" ss:Weight="1" ss:LineStyle="Continuous" ss:Position="Left" /><ss:Border ss:Color="#e4e4e4" ss:Weight="1" ss:LineStyle="Continuous" ss:Position="Right" /></ss:Borders><ss:Interior /><ss:NumberFormat /><ss:Protection /></ss:Style><ss:Style ss:ID="title"><ss:Borders /><ss:Font /><ss:Alignment ss:WrapText="1" ss:Vertical="Center" ss:Horizontal="Center" /><ss:NumberFormat ss:Format="@" /></ss:Style><ss:Style ss:ID="headercell"><ss:Font ss:Bold="1" ss:Size="10" /><ss:Alignment ss:WrapText="1" ss:Horizontal="Center" /><ss:Interior ss:Pattern="Solid" ss:Color="#A3C9F1" /></ss:Style><ss:Style ss:ID="even"><ss:Interior ss:Pattern="Solid" ss:Color="#CCFFFF" /></ss:Style><ss:Style ss:Parent="even" ss:ID="evendate"><ss:NumberFormat ss:Format="[ENG][$-409]dd-mmm-yyyy;@" /></ss:Style><ss:Style ss:Parent="even" ss:ID="evenint"><ss:NumberFormat ss:Format="0" /></ss:Style><ss:Style ss:Parent="even" ss:ID="evenfloat"><ss:NumberFormat ss:Format="0.00" /></ss:Style><ss:Style ss:ID="odd"><ss:Interior ss:Pattern="Solid" ss:Color="#CCCCFF" /></ss:Style><ss:Style ss:Parent="odd" ss:ID="odddate"><ss:NumberFormat ss:Format="[ENG][$-409]dd-mmm-yyyy;@" /></ss:Style><ss:Style ss:Parent="odd" ss:ID="oddint"><ss:NumberFormat ss:Format="0" /></ss:Style><ss:Style ss:Parent="odd" ss:ID="oddfloat"><ss:NumberFormat ss:Format="0.00" /></ss:Style></ss:Styles>'+c.xml+"</ss:Workbook>"},createWorksheet:function(c){var x=[];var p=[];var g=this.getColumnModel();var e=0;var b="";var y="";var f=0;for(var A=0;A<g.getColumnCount();A++){if(c||!g.isHidden(A)){var m=g.getColumnWidth(A);e+=m;if((Ext.ux.Utility.isNullOrUndefined(g.getDataIndex(A)))||(g.getColumnHeader(A)==="")||(g.getColumnId(A)==="checker")||(g.getColumnHeader(A)==="Alert")||((String(g.getColumnId(A)).match("_actions")=="_actions")&&(g.getColumnHeader(A)==="Actions"))){x.push("None");p.push("");++f}else{b+='<ss:Column ss:AutoFitWidth="1" ss:Width="'+m+'" />';y+='<ss:Cell ss:StyleID="headercell"><ss:Data ss:Type="String">'+g.getColumnHeader(A)+'</ss:Data><ss:NamedCell ss:Name="Print_Titles" /></ss:Cell>';var a=this.store.recordType.prototype.fields.get(g.getDataIndex(A));switch(a.type.type){case"int":x.push("Number");p.push("int");break;case"float":x.push("Number");p.push("float");break;case"bool":case"boolean":x.push("String");p.push("");break;case"date":x.push("DateTime");p.push("date");break;default:x.push("String");p.push("");break}}}}var B=x.length-f;var h={height:9000,width:Math.floor(e*30)+50};var o='<ss:Worksheet ss:Name="'+this.title+'"><ss:Names><ss:NamedRange ss:Name="Print_Titles" ss:RefersTo="=\''+this.title+'\'!R1:R2" /></ss:Names><ss:Table x:FullRows="1" x:FullColumns="1" ss:ExpandedColumnCount="'+(B)+'" ss:ExpandedRowCount="'+(this.store.getCount()+2)+'">'+b+'<ss:Row ss:Height="38"><ss:Cell ss:StyleID="title" ss:MergeAcross="'+(B-1)+'"><ss:Data xmlns:html="http://www.w3.org/TR/REC-html40" ss:Type="String"><html:B>Cacti CaMM plugin export rezult (Generated by ExtJS)</html:B></ss:Data><ss:NamedCell ss:Name="Print_Titles" /></ss:Cell></ss:Row><ss:Row ss:AutoFitHeight="1">'+y+"</ss:Row>";for(var A=0,d=this.store.data.items,s=d.length;A<s;A++){o+="<ss:Row>";var q=(A&1)?"odd":"even";r=d[A].data;var u=0;for(var z=0;z<g.getColumnCount();z++){if(c||!g.isHidden(z)){var n=r[g.getDataIndex(z)];if(x[u]!=="None"){if(!n){o+='<ss:Cell ss:StyleID="'+q+'"></ss:Cell>'}else{o+='<ss:Cell ss:StyleID="'+q+p[u]+'"><ss:Data ss:Type="'+x[u]+'">';if(x[u]=="DateTime"){o+=n.format("Y-m-d\\TH:i:s.000")}else{o+=n.replace("<br>","")}o+="</ss:Data></ss:Cell>"}}u++}}o+="</ss:Row>"}h.xml=o+'</ss:Table><x:WorksheetOptions><x:PageSetup><x:Layout x:CenterHorizontal="1" x:Orientation="Landscape" /><x:Footer x:Data="Page &amp;P of &amp;N" x:Margin="0.5" /><x:PageMargins x:Top="0.5" x:Right="0.5" x:Left="0.5" x:Bottom="0.8" /></x:PageSetup><x:FitToPage /><x:Print><x:PrintErrors>Blank</x:PrintErrors><x:FitWidth>1</x:FitWidth><x:FitHeight>32767</x:FitHeight><x:ValidPrinterInfo /><x:VerticalResolution>600</x:VerticalResolution></x:Print><x:Selected /><x:DoNotDisplayGridlines /><x:ProtectObjects>False</x:ProtectObjects><x:ProtectScenarios>False</x:ProtectScenarios></x:WorksheetOptions></ss:Worksheet>';return h}});Ext.namespace("Ext.ux.plugins");Ext.ux.plugins.CheckBoxMemory=Ext.extend(Object,{constructor:function(a){if(!a){a={}}this.prefix="id_";this.items={};this.idProperty=a.idProperty||"id"},init:function(a){this.grid=a;this.view=a.getView();this.store=null;this.sm=a.getSelectionModel();this.sm.on("rowselect",this.onSelect,this);this.sm.on("rowdeselect",this.onDeselect,this);this.view.on("refresh",this.reConfigure,this)},reConfigure:function(){this.store=this.grid.getStore();this.store.on("clear",this.onClear,this);this.store.on("datachanged",this.restoreState,this)},onSelect:function(c,a,b){this.items[this.getId(b)]=true},onDeselect:function(c,a,b){delete this.items[this.getId(b)]},restoreState:function(){if(this.store!=null){var a=0;var b=[];this.store.each(function(c){var d=this.getId(c);if(this.items[d]===true){b.push(a)}++a},this);if(b.length>0){this.sm.selectRows(b)}}},onClear:function(){var a=[];this.items={}},getId:function(a){return a.get(this.idProperty)}});Ext.namespace("Ext.ux.wam");Ext.ux.wam.PropertyRecord=Ext.data.Record.create([{name:"name",type:"string"},{name:"fname",type:"string"},{name:"text",type:"string"},"order","value",{name:"disabled",type:"boolean"},"editor","group","type","renderer"]);Ext.ux.wam.PropertyColumnModel=function(b){this.store=b;Ext.ux.wam.PropertyColumnModel.superclass.constructor.call(this,[{header:Ext.grid.PropertyColumnModel.prototype.nameText,width:50,sortable:false,dataIndex:"name",id:"name"},{header:Ext.grid.PropertyColumnModel.prototype.valueText,width:50,resizable:false,dataIndex:"value",id:"proper_value"},{header:"group",hidden:true,dataIndex:"group",id:"group"}]);this.bselect=Ext.DomHelper.append(document.body,{tag:"select",cls:"x-grid-editor x-hide-display",children:[{tag:"option",value:"true",html:"true"},{tag:"option",value:"false",html:"false"}]});var a=new Ext.form.Field({el:this.bselect,bselect:this.bselect,autoShow:true,getValue:function(){return this.bselect.value=="true"}});this.editors={date:new Ext.grid.GridEditor(new Ext.form.DateField({selectOnFocus:true})),string:new Ext.grid.GridEditor(new Ext.form.TextField({selectOnFocus:true})),number:new Ext.grid.GridEditor(new Ext.form.NumberField({selectOnFocus:true,style:"text-align:left;"})),"boolean":new Ext.grid.GridEditor(a)};this.renderCellDelegate=this.renderCell.createDelegate(this);this.renderPropDelegate=this.renderProp.createDelegate(this)};Ext.extend(Ext.ux.wam.PropertyColumnModel,Ext.grid.ColumnModel,{renderDate:function(a){return a.dateFormat(Ext.grid.PropertyColumnModel.prototype.dateFormat)},renderBool:function(a){return a?"true":"false"},isCellEditable:function(a,b){return(a==1)&&(this.store.getAt(b).data.disabled!==true)},getRenderer:function(a){return a==1?this.renderCellDelegate:this.renderPropDelegate},renderProp:function(c,b,a){return"<b>"+a.data.fname+"</b><br>"+a.data.text||a.data.name},renderCell:function(c,b,a){var d=c;if(a.data.renderer==""){if(c instanceof Date){d=this.renderDate(c)}else{if(typeof c=="boolean"){d=this.renderBool(c)}else{if(a.data.type=="combobox"){var d=c}}}d=Ext.util.Format.htmlEncode(d)}else{d=a.data.renderer.call(this,c)}return d},getCellEditor:function(a,d){var b=this.store.getAt(d);var c=b.data.value;if(b.data.editor!==""){return b.data.editor}if(c instanceof Date){return this.editors.date}else{if(typeof c=="number"){return this.editors.number}else{if(typeof c=="boolean"){return this.editors["boolean"]}else{return this.editors.string}}}}});Ext.ux.wam.PropertyGrid=Ext.extend(Ext.grid.EditorGridPanel,{enableColumnMove:false,stripeRows:false,trackMouseOver:false,clicksToEdit:1,enableHdMenu:false,initComponent:function(){this.lastEditRow=null;var a=new Ext.ux.wam.PropertyColumnModel(this.store);this.store.sort("order","ASC");this.addEvents("beforepropertychange","propertychange");this.cm=a;Ext.ux.wam.PropertyGrid.superclass.initComponent.call(this);this.selModel.on("beforecellselect",function(d,c,b){if(this.store.getAt(c).data.disabled==true){return false}if(b===0){this.startEditing.defer(200,this,[c,1]);return false}},this)},onRender:function(){Ext.ux.wam.PropertyGrid.superclass.onRender.apply(this,arguments);this.getGridEl().addClass("x-props-grid")}});if(Ext.version=="3.0"){Ext.override(Ext.grid.GridView,{ensureVisible:function(v,f,e){var s=this.resolveCell(v,f,e);if(!s||!s.row){return}var k=s.row,g=s.cell,n=this.scroller.dom,u=0,d=k,o=this.el.dom;var d=k,o=this.el.dom;while(d&&d!=o){u+=d.offsetTop;d=d.offsetParent}u-=this.mainHd.dom.offsetHeight;var q=u+k.offsetHeight;var a=n.clientHeight;var o=parseInt(n.scrollTop,10);var m=o+a;if(u<o){n.scrollTop=u}else{if(q>m){n.scrollTop=q-a}}if(e!==false){var l=parseInt(g.offsetLeft,10);var j=l+g.offsetWidth;var h=parseInt(n.scrollLeft,10);var b=h+n.clientWidth;if(l<h){n.scrollLeft=l}else{if(j>b){n.scrollLeft=j-n.clientWidth}}}return this.getResolvedXY(s)}})}Ext.namespace("Ext.ux.maximgb.tg");Ext.ux.maximgb.tg.AbstractTreeStore=Ext.extend(Ext.data.Store,{leaf_field_name:"_is_leaf",page_offset:0,active_node:null,constructor:function(a){Ext.ux.maximgb.tg.AbstractTreeStore.superclass.constructor.call(this,a);if(!this.paramNames.active_node){this.paramNames.active_node="anode"}this.addEvents("beforeexpandnode","expandnode","expandnodefailed","beforecollapsenode","collapsenode","beforeactivenodechange","activenodechange")},remove:function(a){if(a===this.active_node){this.setActiveNode(null)}this.removeNodeDescendants(a);Ext.ux.maximgb.tg.AbstractTreeStore.superclass.remove.call(this,a)},removeNodeDescendants:function(d){var c,a,b=this.getNodeChildren(d);for(c=0,a=b.length;c<a;c++){this.remove(b[c])}},load:function(a){if(a){if(a.params){if(a.params[this.paramNames.active_node]===undefined){a.params[this.paramNames.active_node]=this.active_node?this.active_node.id:null}}else{a.params={};a.params[this.paramNames.active_node]=this.active_node?this.active_node.id:null}}else{a={params:{}};a.params[this.paramNames.active_node]=this.active_node?this.active_node.id:null}if(a.params[this.paramNames.active_node]!==null){a.add=true}return Ext.ux.maximgb.tg.AbstractTreeStore.superclass.load.call(this,a)},loadRecords:function(c,q,k){if(!c||k===false){if(k!==false){this.fireEvent("load",this,[],q)}if(q.callback){q.callback.call(q.scope||this,[],q,false)}return}var a=c.records,p=c.totalRecords||a.length,l=this.getPageOffsetFromOptions(q),n=this.getLoadedNodeIdFromOptions(q),j,d,g,b,f,h,e,m=this;if(!q||q.add!==true){if(this.pruneModifiedRecords){this.modified=[]}for(var d=0,g=a.length;d<g;d++){a[d].join(this)}if(this.snapshot){this.data=this.snapshot;delete this.snapshot}this.data.clear();this.data.addAll(a);this.clearCache();q.applySort=false;this.page_offset=l;this.totalLength=p;if(q.applySort==undefined){q.applySort=true}if(q.applySort){this.applySort()}this.fireEvent("datachanged",this)}else{if(n){j=this.getById(n)}if(j){this.setNodeLoaded(j,true);this.setNodeChildrenOffset(j,l);this.setNodeChildrenTotalCount(j,Math.max(p,a.length));this.removeNodeDescendants(j)}this.suspendEvents();e={};for(d=0,g=a.length;d<g;d++){f=a[d];h=this.indexOfId(f.id);if(h==-1){e[f.id]=false;this.add(f)}else{e[f.id]=true;b=this.getAt(h);b.reject();b.data=f.data;a[d]=b}}if(q.applySort==undefined){q.applySort=true}if(q.applySort){this.applySort()}this.resumeEvents();a.sort(function(v,s){var w=m.data.indexOf(v),u=m.data.indexOf(s),o;if(w>u){o=1}else{o=-1}return o});for(d=0,g=a.length;d<g;d++){f=a[d];if(e[f.id]==true){this.fireEvent("update",this,f,Ext.data.Record.COMMIT)}else{this.fireEvent("add",this,[f],this.data.indexOf(f))}}}this.fireEvent("load",this,a,q);if(q.callback){q.callback.call(q.scope||this,a,q,true)}},sort:function(b,a){if(this.remoteSort){this.setActiveNode(null);if(this.lastOptions){this.lastOptions.add=false;if(this.lastOptions.params){this.lastOptions.params[this.paramNames.active_node]=null}}}return Ext.ux.maximgb.tg.AbstractTreeStore.superclass.sort.call(this,b,a)},applySort:function(){if(this.sortInfo&&!this.remoteSort){var a=this.sortInfo,b=a.field;this.sortData(b,a.direction)}else{this.applyTreeSort()}},sortData:function(c,d){d=d||"ASC";var a=this.fields.get(c).sortType;var b=function(f,e){var h=a(f.data[c]),g=a(e.data[c]);return h>g?1:(h<g?-1:0)};this.data.sort(d,b);if(this.snapshot&&this.snapshot!=this.data){this.snapshot.sort(d,b)}this.applyTreeSort()},applyTreeSort:function(){var e,a,d,f,c=[],b=this.getRootNodes();for(e=0,a=b.length;e<a;e++){f=b[e];c.push(f);this.collectNodeChildrenTreeSorted(c,f)}if(c.length>0){this.data.clear();this.data.addAll(c)}if(this.snapshot&&this.snapshot!==this.data){d=this.data;this.data=this.snapshot;this.snapshot=null;this.applyTreeSort();this.snapshot=this.data;this.data=d}},collectNodeChildrenTreeSorted:function(b,e){var d,a,f,c=this.getNodeChildren(e);for(d=0,a=c.length;d<a;d++){f=c[d];b.push(f);this.collectNodeChildrenTreeSorted(b,f)}},getActiveNode:function(){return this.active_node},setActiveNode:function(a){if(this.active_node!==a){if(a){if(this.data.indexOf(a)!=-1){if(this.fireEvent("beforeactivenodechange",this,this.active_node,a)!==false){this.active_node=a;this.fireEvent("activenodechange",this,this.active_node,a)}}else{throw"Given record is not from the store."}}else{if(this.fireEvent("beforeactivenodechange",this,this.active_node,a)!==false){this.active_node=a;this.fireEvent("activenodechange",this,this.active_node,a)}}}},isExpandedNode:function(a){return a.ux_maximgb_tg_expanded===true},setNodeExpanded:function(b,a){b.ux_maximgb_tg_expanded=a},isVisibleNode:function(e){var c,b,d=this.getNodeAncestors(e),a=true;for(c=0,b=d.length;c<b;c++){a=a&&this.isExpandedNode(d[c]);if(!a){break}}return a},isLeafNode:function(a){return a.data._is_leaf==true},isLoadedNode:function(b){var a;if(b.ux_maximgb_tg_loaded!==undefined){a=b.ux_maximgb_tg_loaded}else{if(this.isLeafNode(b)||this.hasChildNodes(b)){a=true}else{a=false}}return a},setNodeLoaded:function(b,a){b.ux_maximgb_tg_loaded=a},getNodeChildrenOffset:function(a){return a.ux_maximgb_tg_offset||0},setNodeChildrenOffset:function(b,a){b.ux_maximgb_tg_offset=a},getNodeChildrenTotalCount:function(a){return a.ux_maximgb_tg_total||0},setNodeChildrenTotalCount:function(b,a){b.ux_maximgb_tg_total=a},collapseNode:function(a){if(this.isExpandedNode(a)&&this.fireEvent("beforecollapsenode",this,a)!==false){this.setNodeExpanded(a,false);this.fireEvent("collapsenode",this,a)}},expandNode:function(a){var b;if(!this.isExpandedNode(a)&&this.fireEvent("beforeexpandnode",this,a)!==false){if(this.isLoadedNode(a)){this.setNodeExpanded(a,true);this.fireEvent("expandnode",this,a)}else{b={};b[this.paramNames.active_node]=a.id;this.load({add:true,params:b,callback:this.expandNodeCallback,scope:this})}}},expandNodeCallback:function(b,a,d){var c=this.getById(a.params[this.paramNames.active_node]);if(d&&c){this.setNodeExpanded(c,true);this.fireEvent("expandnode",this,c)}else{this.fireEvent("expandnodefailed",this,a.params[this.paramNames.active_node],c)}},expandAll:function(){var d,c,a,b=this.data.getRange();this.suspendEvents();for(c=0,a=b.length;c<a;c++){d=b[c];if(!this.isExpandedNode(d)){this.expandNode(d)}}this.resumeEvents();this.fireEvent("datachanged",this)},collapseAll:function(){var d,c,a,b=this.data.getRange();this.suspendEvents();for(c=0,a=b.length;c<a;c++){d=b[c];if(this.isExpandedNode(d)){this.collapseNode(d)}}this.resumeEvents();this.fireEvent("datachanged",this)},getLoadedNodeIdFromOptions:function(b){var a=null;if(b&&b.params&&b.params[this.paramNames.active_node]){a=b.params[this.paramNames.active_node]}return a},getPageOffsetFromOptions:function(b){var a=0;if(b&&b.params&&b.params[this.paramNames.start]){a=parseInt(b.params[this.paramNames.start],10);if(isNaN(a)){a=0}}return a},hasNextSiblingNode:function(a){return this.getNodeNextSibling(a)!==null},hasPrevSiblingNode:function(a){return this.getNodePrevSibling(a)!==null},hasChildNodes:function(a){return this.getNodeChildrenCount(a)>0},getNodeAncestors:function(c){var b=[],a;a=this.getNodeParent(c);while(a){b.push(a);a=this.getNodeParent(a)}return b},getNodeChildrenCount:function(a){return this.getNodeChildren(a).length},getNodeNextSibling:function(d){var e,c,b,a=null;c=this.getNodeParent(d);if(c){e=this.getNodeChildren(c)}else{e=this.getRootNodes()}b=e.indexOf(d);if(b<e.length-1){a=e[b+1]}return a},getNodePrevSibling:function(d){var e,c,b,a=null;c=this.getNodeParent(d);if(c){e=this.getNodeChildren(c)}else{e=this.getRootNodes()}b=e.indexOf(d);if(b>0){a=e[b-1]}return a},getRootNodes:function(){throw"Abstract method call"},getNodeDepth:function(a){throw"Abstract method call"},getNodeParent:function(a){throw"Abstract method call"},getNodeChildren:function(a){throw"Abstract method call"},addToNode:function(a,b){throw"Abstract method call"},removeFromNode:function(a,b){throw"Abstract method call"},getPageOffset:function(){return this.page_offset},getActiveNodePageOffset:function(){var a;if(this.active_node){a=this.getNodeChildrenOffset(this.active_node)}else{a=this.getPageOffset()}return a},getActiveNodeCount:function(){var a;if(this.active_node){a=this.getNodeChildrenCount(this.active_node)}else{a=this.getRootNodes().length}return a},getActiveNodeTotalCount:function(){var a;if(this.active_node){a=this.getNodeChildrenTotalCount(this.active_node)}else{a=this.getTotalCount()}return a}});Ext.ux.maximgb.tg.AdjacencyListStore=Ext.extend(Ext.ux.maximgb.tg.AbstractTreeStore,{parent_id_field_name:"_parent",_cache:{},clearCache:function(){this._cache={getRootNodes:null,getNodeChildren:{}};this.data.RootNodes=null},getRootNodes:function(){if(this._cache.getRootNodes){return this._cache.getRootNodes}var d,b,a=[],c=this.data.getRange();for(d=0,b=c.length;d<b;d++){if(c[d].data._parent==null){a.push(c[d])}}return this._cache.getRootNodes=a},getNodeDepth:function(a){return this.getNodeAncestors(a).length},getNodeParent:function(a){return this.getById(a.data._parent)},getNodeChildren:function(e){var b=[];if(e.data._is_leaf==false){if(this._cache.getNodeChildren[e.id]!=undefined){return this._cache.getNodeChildren[e.id]}this._cache.getNodeChildren[e.id]=[];var d,a,c=this.data.getRange();for(d=0,a=c.length;d<a;d++){if(c[d].data._parent==e.id){this._cache.getNodeChildren[e.id].push(c[d])}}return this._cache.getNodeChildren[e.id]}return b},addToNode:function(a,b){b.set(this.data._parent,a.id);this.addSorted(b)},removeFromNode:function(a,b){this.remove(b)}});Ext.reg("Ext.ux.maximgb.tg.AdjacencyListStore",Ext.ux.maximgb.tg.AdjacencyListStore);Ext.ux.maximgb.tg.NestedSetStore=Ext.extend(Ext.ux.maximgb.tg.AbstractTreeStore,{left_field_name:"_lft",right_field_name:"_rgt",level_field_name:"_level",root_node_level:1,getRootNodes:function(){var d,b,a=[],c=this.data.getRange();for(d=0,b=c.length;d<b;d++){if(c[d].get(this.level_field_name)==this.root_node_level){a.push(c[d])}}return a},getNodeDepth:function(a){return a.get(this.level_field_name)-this.root_node_level},getNodeParent:function(a){var m=null,g,f=this.data.getRange(),h,j,l,e,k,d,c,b;l=a.get(this.left_field_name);k=a.get(this.right_field_name);c=a.get(this.level_field_name);for(h=0,j=f.length;h<j;h++){g=f[h];e=g.get(this.left_field_name);d=g.get(this.right_field_name);b=g.get(this.level_field_name);if(b==c-1&&e<l&&d>k){m=g;break}}return m},getNodeChildren:function(a){var j,e,h,d,b,c,f,g,k=[];f=this.data.getRange();j=a.get(this.left_field_name);h=a.get(this.right_field_name);b=a.get(this.level_field_name);for(i=0,len=f.length;i<len;i++){g=f[i];e=g.get(this.left_field_name);d=g.get(this.right_field_name);c=g.get(this.level_field_name);if(c==b+1&&e>j&&d<h){k.push(g)}}return k}});Ext.ux.maximgb.tg.GridView=Ext.extend(Ext.grid.GridView,{expanded_icon_class:"ux-maximgb-tg-nl-minus",last_expanded_icon_class:"ux-maximgb-tg-nl-end-minus",collapsed_icon_class:"ux-maximgb-tg-nl-plus",last_collapsed_icon_class:"ux-maximgb-tg-nl-end-plus",skip_width_update_class:"ux-maximgb-tg-skip-width-update",initTemplates:function(){var a=this.templates||{};if(!a.row){a.row=new Ext.Template('<div class="x-grid3-row ux-maximgb-tg-level-{level} {alt}" style="{tstyle} {display_style}">','<table class="x-grid3-row-table" border="0" cellspacing="0" cellpadding="0" style="{tstyle}">',"<tbody>","<tr>{cells}</tr>",(this.enableRowBody?'<tr class="x-grid3-row-body-tr" style="{bodyStyle}"><td colspan="{cols}" class="x-grid3-body-cell" tabIndex="0" hidefocus="on"><div class="x-grid3-row-body">{body}</div></td></tr>':""),"</tbody>","</table>","</div>")}if(!a.mastercell){a.mastercell=new Ext.Template('<td class="x-grid3-col x-grid3-cell x-grid3-td-{id} {css}" style="{style}" tabIndex="0" {cellAttr}>','<div class="ux-maximgb-tg-mastercell-wrap">',"{treeui}",'<div class="x-grid3-cell-inner x-grid3-col-{id}" unselectable="on" {attr}>{value}</div>',"</div>","</td>")}if(!a.treeui){a.treeui=new Ext.Template('<div class="ux-maximgb-tg-uiwrap" style="width: {wrap_width}px">',"{elbow_line}",'<div style="left: {left}px" class="{cls}">&#160;</div>',"</div>")}if(!a.elbow_line){a.elbow_line=new Ext.Template('<div style="left: {left}px" class="{cls}">&#160;</div>')}this.templates=a;Ext.ux.maximgb.tg.GridView.superclass.initTemplates.call(this)},doRender:function(g,k,s,a,q,x){var b=this.templates,f=b.cell,h=b.row,l=q-1;var d="width:"+this.getTotalWidth()+";";var A=[],u,B,v={},m={tstyle:d},o;for(var w=0,z=k.length;w<z;w++){o=k[w];u=[];var n=(w+a);var e=this.renderRow(o,n,q,s,this.cm.getTotalWidth());if(e===false){for(var y=0;y<q;y++){B=g[y];v.id=B.id;v.css=y==0?"x-grid3-cell-first ":(y==l?"x-grid3-cell-last ":"");v.attr=v.cellAttr="";v.value=B.renderer.call(B.scope,o.data[B.name],v,o,n,y,s);v.style=B.style;if(Ext.isEmpty(v.value)){v.value="&#160;"}if(this.markDirty&&o.dirty&&typeof o.modified[B.name]!=="undefined"){v.css+=" x-grid3-dirty-cell"}if(B.id==this.grid.master_column_id){v.treeui=this.renderCellTreeUI(o,s);f=b.mastercell}else{f=b.cell}u[u.length]=f.apply(v)}}else{u.push(e)}var C=[];if(x&&((n+1)%2==0)){C[0]="x-grid3-row-alt"}if(o.dirty){C[1]=" x-grid3-dirty-row"}m.cols=q;if(this.getRowClass){C[2]=this.getRowClass(o,n,m,s)}m.alt=C.join(" ");m.cells=u.join("");if(!s.isVisibleNode(o)){m.display_style="display: none;"}else{m.display_style=""}m.level=s.getNodeDepth(o);A[A.length]=h.apply(m)}return A.join("")},renderCellTreeUI:function(a,b){var c=this.templates.treeui,h=this.templates.elbow_line,e={},g,d,f=level=b.getNodeDepth(a);e.wrap_width=(f+1)*16;if(level>0){e.elbow_line="";g=a;left=0;while(level--){d=b.getNodeParent(g);if(d){if(b.hasNextSiblingNode(d)){e.elbow_line=h.apply({left:level*16,cls:"ux-maximgb-tg-elbow-line"})+e.elbow_line}else{e.elbow_line=h.apply({left:level*16,cls:"ux-maximgb-tg-elbow-empty"})+e.elbow_line}}else{throw ["Tree inconsistency can't get level ",level+1," node(id=",g.id,") parent."].join("")}g=d}}if(b.isLeafNode(a)){if(b.hasNextSiblingNode(a)){e.cls="ux-maximgb-tg-elbow"}else{e.cls="ux-maximgb-tg-elbow-end"}}else{e.cls="ux-maximgb-tg-elbow-active ";if(b.isExpandedNode(a)){if(b.hasNextSiblingNode(a)){e.cls+=this.expanded_icon_class}else{e.cls+=this.last_expanded_icon_class}}else{if(b.hasNextSiblingNode(a)){e.cls+=this.collapsed_icon_class}else{e.cls+=this.last_collapsed_icon_class}}}e.left=1+f*16;return c.apply(e)},renderRow:function(a,b,e,d,c){return false},afterRender:function(){Ext.ux.maximgb.tg.GridView.superclass.afterRender.call(this);this.updateAllColumnWidths()},updateAllColumnWidths:function(){var d=this.getTotalWidth(),k=this.cm.getColumnCount(),f=[],e,b;for(b=0;b<k;b++){f[b]=this.getColumnWidth(b)}this.innerHd.firstChild.style.width=this.getOffsetWidth();this.innerHd.firstChild.firstChild.style.width=d;this.mainBody.dom.style.width=d;for(b=0;b<k;b++){var c=this.getHeaderCell(b);c.style.width=f[b]}var h=this.getRows(),l,g;for(b=0,e=h.length;b<e;b++){l=h[b];l.style.width=d;if(l.firstChild){l.firstChild.style.width=d;g=l.firstChild.rows[0];for(var a=0;a<k&&a<g.childNodes.length;a++){if(!Ext.fly(g.childNodes[a]).hasClass(this.skip_width_update_class)){g.childNodes[a].style.width=f[a]}}}}this.onAllColumnWidthsUpdated(f,d)},updateColumnWidth:function(b,a){var h=this.getColumnWidth(b);var e=this.getTotalWidth();this.innerHd.firstChild.style.width=this.getOffsetWidth();this.innerHd.firstChild.firstChild.style.width=e;this.mainBody.dom.style.width=e;var d=this.getHeaderCell(b);d.style.width=h;var g=this.getRows(),j;for(var c=0,f=g.length;c<f;c++){j=g[c];j.style.width=e;if(j.firstChild){j.firstChild.style.width=e;if(b<j.firstChild.rows[0].childNodes.length){if(!Ext.fly(j.firstChild.rows[0].childNodes[b]).hasClass(this.skip_width_update_class)){j.firstChild.rows[0].childNodes[b].style.width=h}}}}this.onColumnWidthUpdated(b,h,e)},updateColumnHidden:function(a,e){var d=this.getTotalWidth();this.innerHd.firstChild.style.width=this.getOffsetWidth();this.innerHd.firstChild.firstChild.style.width=d;this.mainBody.dom.style.width=d;var g=e?"none":"";var c=this.getHeaderCell(a);c.style.display=g;var h=this.getRows(),k,j;for(var b=0,f=h.length;b<f;b++){k=h[b];k.style.width=d;if(k.firstChild){k.firstChild.style.width=d;if(a<k.firstChild.rows[0].childNodes.length){if(!Ext.fly(k.firstChild.rows[0].childNodes[a]).hasClass(this.skip_width_update_class)){k.firstChild.rows[0].childNodes[a].style.display=g}}}}this.onColumnHiddenUpdated(a,e,d);delete this.lastViewWidth;this.layout()},processRows:function(a,d){var b=0;if(this.ds.getCount()<1){return}d=!this.grid.stripeRows;a=a||0;var c=this.getRows();var b=0;Ext.each(c,function(f,e){f.rowIndex=e;f.className=f.className.replace(this.rowClsRe," ");if(f.style.display!="none"){if(!d&&((b+1)%2===0)){f.className+=" x-grid3-row-alt"}b++}},this);Ext.fly(c[0]).addClass(this.firstRowCls);Ext.fly(c[c.length-1]).addClass(this.lastRowCls)},ensureVisible:function(e,b,d){var c,a=this.ds.getAt(e);if(!this.ds.isVisibleNode(a)){c=this.ds.getNodeAncestors(a);while(c.length>0){a=c.shift();if(!this.ds.isExpandedNode(a)){this.ds.expandNode(a)}}}return Ext.ux.maximgb.tg.GridView.superclass.ensureVisible.call(this,e,b,d)},expandRow:function(d,f){var b=this.ds,c,g,k,h,a,e,j;if(typeof d=="number"){e=d;d=b.getAt(e)}else{e=b.indexOf(d)}f=f||false;k=this.getRow(e);h=Ext.fly(k).child(".ux-maximgb-tg-elbow-active");if(h){if(b.hasNextSiblingNode(d)){h.removeClass(this.collapsed_icon_class);h.removeClass(this.last_collapsed_icon_class);h.addClass(this.expanded_icon_class)}else{h.removeClass(this.collapsed_icon_class);h.removeClass(this.last_collapsed_icon_class);h.addClass(this.last_expanded_icon_class)}}if(b.isVisibleNode(d)){a=b.getNodeChildren(d);for(c=0,g=a.length;c<g;c++){j=b.indexOf(a[c]);k=this.getRow(j);k.style.display="block";if(b.isExpandedNode(a[c])){this.expandRow(j,true)}}}if(!f){this.processRows(0)}},collapseRow:function(d,e){var b=this.ds,c,g,a,j,f,h;if(typeof d=="number"){f=d;d=b.getAt(f)}else{f=b.indexOf(d)}e=e||false;j=this.getRow(f);pmel=Ext.fly(j).child(".ux-maximgb-tg-elbow-active");if(pmel){if(b.hasNextSiblingNode(d)){pmel.removeClass(this.expanded_icon_class);pmel.removeClass(this.last_expanded_icon_class);pmel.addClass(this.collapsed_icon_class)}else{pmel.removeClass(this.expanded_icon_class);pmel.removeClass(this.last_expanded_icon_class);pmel.addClass(this.last_collapsed_icon_class)}}a=b.getNodeChildren(d);for(c=0,g=a.length;c<g;c++){h=b.indexOf(a[c]);j=this.getRow(h);if(j.style.display!="none"){j.style.display="none";this.collapseRow(h,true)}}if(!e){this.processRows(0)}},initData:function(b,a){Ext.ux.maximgb.tg.GridView.superclass.initData.call(this,b,a);if(this.ds){this.ds.un("expandnode",this.onStoreExpandNode,this);this.ds.un("collapsenode",this.onStoreCollapseNode,this)}if(b){b.on("expandnode",this.onStoreExpandNode,this);b.on("collapsenode",this.onStoreCollapseNode,this)}},onLoad:function(b,a,c){var d;if(c&&c.params&&(c.params[b.paramNames.active_node]===null||b.indexOfId(c.params[b.paramNames.active_node])==-1)){Ext.ux.maximgb.tg.GridView.superclass.onLoad.call(this,b,a,c)}},onAdd:function(c,a,b){Ext.ux.maximgb.tg.GridView.superclass.onAdd.call(this,c,a,b);if(this.mainWrap){this.processRows(0)}},onRemove:function(d,a,b,c){Ext.ux.maximgb.tg.GridView.superclass.onRemove.call(this,d,a,b,c);if(c!==true){if(this.mainWrap){this.processRows(0)}}},onUpdate:function(b,a){Ext.ux.maximgb.tg.GridView.superclass.onUpdate.call(this,b,a);if(this.mainWrap){this.processRows(0)}},onStoreExpandNode:function(a,b){this.expandRow(b)},onStoreCollapseNode:function(a,b){this.collapseRow(b)}});Ext.ux.maximgb.tg.GridPanel=Ext.extend(Ext.grid.GridPanel,{master_column_id:0,tg_cls:"ux-maximgb-tg-panel",initComponent:function(){this.initComponentPreOverride();Ext.ux.maximgb.tg.GridPanel.superclass.initComponent.call(this);this.getSelectionModel().on("selectionchange",this.onTreeGridSelectionChange,this);this.initComponentPostOverride()},initComponentPreOverride:Ext.emptyFn,initComponentPostOverride:Ext.emptyFn,onRender:function(b,a){Ext.ux.maximgb.tg.GridPanel.superclass.onRender.call(this,b,a);this.el.addClass(this.tg_cls)},getView:function(){if(!this.view){this.view=new Ext.ux.maximgb.tg.GridView(this.viewConfig)}return this.view},onClick:function(c){var d=c.getTarget(),g=this.getView(),k=g.findRowIndex(d),h=this.getStore(),a=this.getSelectionModel(),b,f,j=true;if(k!==false){if(Ext.fly(d).hasClass("ux-maximgb-tg-elbow-active")){b=h.getAt(k);if(h.isExpandedNode(b)){h.collapseNode(b)}else{h.expandNode(b)}j=false}}if(j){Ext.ux.maximgb.tg.GridPanel.superclass.onClick.call(this,c)}},onMouseDown:function(b){var a=b.getTarget();if(!Ext.fly(a).hasClass("ux-maximgb-tg-elbow-active")){Ext.ux.maximgb.tg.GridPanel.superclass.onMouseDown.call(this,b)}},onTreeGridSelectionChange:function(e,d){var a,c,b=this.getStore();if(e.getSelected){a=e.getSelected();b.setActiveNode(a)}else{if(e.getSelectedCell&&d){a=d.record;b.setActiveNode(a)}}if(a){if(!b.isVisibleNode(a)){c=b.getNodeAncestors(a);while(c.length>0){b.expandNode(c.pop())}}}}});Ext.ux.maximgb.tg.EditorGridPanel=Ext.extend(Ext.grid.EditorGridPanel,{master_column_id:0,initComponent:function(){this.initComponentPreOverride();Ext.ux.maximgb.tg.EditorGridPanel.superclass.initComponent.call(this);this.getSelectionModel().on("selectionchange",this.onTreeGridSelectionChange,this);this.initComponentPostOverride()},initComponentPreOverride:Ext.emptyFn,initComponentPostOverride:Ext.emptyFn,onRender:function(b,a){Ext.ux.maximgb.tg.EditorGridPanel.superclass.onRender.call(this,b,a);this.el.addClass("ux-maximgb-tg-panel")},getView:function(){if(!this.view){this.view=new Ext.ux.maximgb.tg.GridView(this.viewConfig)}return this.view},onClick:function(c){var d=c.getTarget(),g=this.getView(),k=g.findRowIndex(d),h=this.getStore(),a=this.getSelectionModel(),b,f,j=true;if(k!==false){if(Ext.fly(d).hasClass("ux-maximgb-tg-elbow-active")){b=h.getAt(k);if(h.isExpandedNode(b)){h.collapseNode(b)}else{h.expandNode(b)}j=false}}if(j){Ext.ux.maximgb.tg.EditorGridPanel.superclass.onClick.call(this,c)}},onMouseDown:function(b){var a=b.getTarget();if(!Ext.fly(a).hasClass("ux-maximgb-tg-elbow-active")){Ext.ux.maximgb.tg.EditorGridPanel.superclass.onMouseDown.call(this,b)}},onTreeGridSelectionChange:function(e,d){var a,c,b=this.getStore();if(e.getSelected){a=e.getSelected();b.setActiveNode(a)}else{if(e.getSelectedCell&&d){a=d.record;b.setActiveNode(a)}}if(a){if(!b.isVisibleNode(a)){c=b.getNodeAncestors(a);while(c.length>0){b.expandNode(c.pop())}}}}});Ext.ux.maximgb.tg.PagingToolbar=Ext.extend(Ext.PagingToolbar,{onRender:function(b,a){Ext.ux.maximgb.tg.PagingToolbar.superclass.onRender.call(this,b,a);this.updateUI()},getPageData:function(){var a=0,b=0;if(this.store){b=this.store.getActiveNodePageOffset();a=this.store.getActiveNodeTotalCount()}return{total:a,activePage:Math.ceil((b+this.pageSize)/this.pageSize),pages:a<this.pageSize?1:Math.ceil(a/this.pageSize)}},updateInfo:function(){var b=0,d=0,a=0,c;if(this.displayItem){if(this.store){d=this.store.getActiveNodePageOffset();b=this.store.getActiveNodeCount();a=this.store.getActiveNodeTotalCount()}c=b==0?this.emptyMsg:String.format(this.displayMsg,d+1,d+b,a);this.displayItem.setText(c)}},updateUI:function(){var c=this.getPageData(),a=c.activePage,b=c.pages;this.afterTextItem.setText(String.format(this.afterPageText,c.pages));this.inputItem.setValue(a);this.first.setDisabled(a==1);this.prev.setDisabled(a==1);this.next.setDisabled(a==b);this.last.setDisabled(a==b);this.refresh.enable();this.updateInfo()},bindStore:function(a,b){if(!b&&this.store){this.store.un("activenodechange",this.onStoreActiveNodeChange,this)}if(a){a.on("activenodechange",this.onStoreActiveNodeChange,this)}Ext.ux.maximgb.tg.PagingToolbar.superclass.bindStore.call(this,a,b)},beforeLoad:function(a,b){var c=this.getParams();Ext.ux.maximgb.tg.PagingToolbar.superclass.beforeLoad.call(this,a,b);if(b&&b.params){if(b.params[c.start]===undefined){b.params[c.start]=0}if(b.params[c.limit]===undefined){b.params[c.limit]=this.pageSize}}},moveFirst:function(){this.doLoad(0)},movePrevious:function(){var a=this.store,b=a?a.getActiveNodePageOffset():0;this.doLoad(Math.max(0,b-this.pageSize))},moveNext:function(){var a=this.store,b=a?a.getActiveNodePageOffset():0;this.doLoad(b+this.pageSize)},moveLast:function(){var b=this.store,d=b?b.getActiveNodePageOffset():0,c=b?b.getActiveNodeTotalCount():0,a=c%this.pageSize;this.doLoad(a?(c-a):c-this.pageSize)},onStoreActiveNodeChange:function(b,c,a){if(this.rendered){this.updateUI()}}});Ext.reg("Ext.ux.maximgb.tg.GridPanel",Ext.ux.maximgb.tg.GridPanel);Ext.reg("Ext.ux.maximgb.tg.EditorGridPanel",Ext.ux.maximgb.tg.EditorGridPanel);Ext.reg("Ext.ux.maximgb.tg.PagingToolbar",Ext.ux.maximgb.tg.PagingToolbar);Ext.namespace("Ext.ux.grid");Ext.ux.grid.ProgressColumn=function(a){Ext.apply(this,a);this.renderer=this.renderer.createDelegate(this);this.addEvents("action");Ext.ux.grid.ProgressColumn.superclass.constructor.call(this)};Ext.extend(Ext.ux.grid.ProgressColumn,Ext.util.Observable,{textPst:"%",colored:false,actionEvent:"dblclick",init:function(b){this.grid=b;this.view=b.getView();if(this.editor&&b.isEditor){var a={scope:this};a[this.actionEvent]=this.onClick;b.afterRender=b.afterRender.createSequence(function(){this.view.mainBody.on(a)},this)}},onClick:function(d,c){var f=d.getTarget(".x-grid3-row").rowIndex;var a=this.view.findCellIndex(c.parentNode.parentNode);var b=d.getTarget(".x-progress-text");if(b){this.grid.startEditing(f,a)}},renderer:function(c,e,b){if((typeof c===typeof 1)&&(null!==c)&&isFinite(c)){var d="";var a=(c<55)?"x-progress-text-back":"x-progress-text-front"+(Ext.isIE6?"-ie6":"");var f=String.format('</div><div class="x-progress-text {0}" style="width:100%;" id="{1}">{2}</div></div>',a,Ext.id(),c+this.textPst);f=(c<96)?f.substring(0,f.length-6):f.substr(6);if(this.colored==true){if(c<=100&&c>66){d="-red"}if(c<67&&c>33){d="-orange"}if(c<34){d="-green"}}e.css+=" x-grid3-progresscol";return String.format('<div class="x-progress-wrap"><div class="x-progress-inner"><div class="x-progress-bar{0}" style="width:{1}%;">{2}</div></div>',d,c,f)}}});HighchartsAdapter={each:Ext.each,map:function(b,e){var d=[];if(b){for(var c=0,a=b.length;c<a;c++){d[c]=e.call(b[c],b[c],c,b)}}return d},grep:function(b,f,a){var c=[];for(var d=0,e=b.length;d<e;d++){if(!a!=!f(b[d],d)){c.push(b[d])}}return c},merge:function(){var a=arguments;var b=function(){var h=arguments[0]||{},f=1,g=arguments.length,c=false,e;if(typeof h==="boolean"){c=h;h=arguments[1]||{};f=2}if(typeof h!=="object"&&!Ext.isFunction(h)){h={}}if(g==f){h=this;--f}for(;f<g;f++){if((e=arguments[f])!=null){for(var d in e){var j=h[d],k=e[d];if(h===k){continue}if(c&&k&&typeof k==="object"&&!k.nodeType){h[d]=b(c,j||(k.length!=null?[]:{}),k)}else{if(k!==undefined){h[d]=k}}}}}return h};return b(true,null,a[0],a[1],a[2],a[3])},hyphenate:function(a){return a.replace(/([A-Z])/g,function(d,c){return"-"+c.toLowerCase()})},addEvent:function(b,c,a){var d=Ext.get(b);if(d){d.addListener(c,a)}else{if(!b.addListener){Ext.apply(b,new Ext.util.Observable())}b.addListener(c,a)}},fireEvent:function(c,d,b,a){var e={type:d,target:c};Ext.apply(e,b);if(c.fireEvent){c.fireEvent(d,e)}if(a){a(e)}},removeEvent:function(b,c,a){if(b.removeListener&&b.purgeListeners){if(c&&a){b.removeListener(c,a)}else{b.purgeListeners()}}else{var d=Ext.get(b);if(d){if(c&&a){d.removeListener(c,a)}else{d.purgeAllListeners()}}}},stop:function(a){},animate:function(b,e,a){var c=b;var d=b.attr;if(d){c=Ext.get(b.element)}if(a){if(a.duration==undefined||a.duration==0){a.duration=1}else{a.duration=a.duration/1000}}else{a={}}if(e.width!==undefined){if(d){if(Ext.isIE){b.attr("width",e.width)}else{b.element.setAttributeNS(null,"width",e.width)}}else{c.setWidth(e.width)}}else{if(e.height!==undefined){if(d){if(Ext.isIE){b.attr("height",e.height)}else{b.element.setAttributeNS(null,"height",e.height)}}else{c.setHeight(e.height)}}else{if(e.left!==undefined){if(d){if(Ext.isIE){b.attr("left",e.left)}else{b.element.setAttributeNS(null,"left",e.left)}}else{c.setLeft(e.left)}}else{if(e.top){if(d){if(Ext.isIE){b.attr("top",e.left)}else{b.element.setAttributeNS(null,"top",e.top)}}else{c.setTop(e.top)}}}}}if(e.opacity!==undefined){if(!d){c.setOpacity(parseInt(e.opacity),{duration:a.duration,callback:a.complete})}}if(a.complete!=undefined){a.complete()}},getAjax:function(a,b){Ext.Ajax.request({url:a,success:function(c){b(c.responseText)}})}};Ext.namespace("Ext.ux.plugins");function array_unique(e){var d,c,b,a=e;for(c=a.length;c;){for(d=--c;d>0;){if(a[c]===a[--d]){for(b=d;--d&&a[c]===a[d];){}c-=a.splice(d+1,b-d).length}}}return a}Ext.ux.plugins.TreeGridStatefull=function(a){Ext.apply(this,a)};Ext.extend(Ext.ux.plugins.TreeGridStatefull,Ext.util.Observable,{init:function(a){Ext.apply(a,{cp:null,state:null,n_state:new Array(),n_st_scroll:new Array(),n_SelectedRow:new Array(),statefull:true,is_restore:false,n_saveState_node:function(c){var c=array_unique(c).sort();a.n_state[a.tree_id]=c;a.cp.set("TreeGrid_"+a.id+"_"+a.tree_id,c)}});if(!a.statefull){a.statefull=true}if(!a.cp){if(this.cp){a.cp=this.cp}else{a.cp=new Ext.state.CookieProvider()}}a.n_SelectedRow=(a.cp.get("TreeGrid_sel_"+a.id)||new Array());var b=a.cp.get("TreeGrid_"+a.id+"_"+a.tree_id);if(!b){a.n_state[a.tree_id]=new Array()}else{a.n_state[a.tree_id]=b}a.on({Render:{fn:function(c,d){c=a.getStore();view=a.getView();c.on({load:{fn:function(e,f){if(Ext.ux.Utility.isNullOrUndefined(a.n_state[a.tree_id])){var h=a.cp.get("TreeGrid_"+a.id+"_"+a.tree_id);if(!h){a.n_state[a.tree_id]=new Array()}else{a.n_state[a.tree_id]=h}}temp_state=a.n_state[a.tree_id];if(temp_state){a.is_restore=true;for(var g=0;g<temp_state.length;++g){var j=temp_state[g];rec=e.getById(j);if(rec){e.expandNode(e.getById(j))}}a.is_restore=false}if(a.tree_change==true){if(!(a.n_SelectedRow[a.tree_id]==0)){rec=e.getById(a.n_SelectedRow[a.tree_id]);if(rec){sm=a.getSelectionModel(),e.setActiveNode(e.getById(a.n_SelectedRow[a.tree_id]));a.cp.set("TreeGrid_sel_"+a.id,a.n_SelectedRow);row=e.indexOf(rec);sm.selectRow(row);if(!(Ext.ux.Utility.isNullOrUndefined(a.n_st_scroll[a.tree_id]))){if(a.n_st_scroll[a.tree_id].top==0){view.focusRow(row)}}}}a.tree_change=false}if(!(Ext.ux.Utility.isNullOrUndefined(a.n_st_scroll[a.tree_id]))){view.restoreScroll(a.n_st_scroll[a.tree_id])}},scope:this},expandnode:{fn:function(f,e){if(a.is_restore==false){if(Ext.ux.Utility.isNullOrUndefined(a.n_state[a.tree_id])){var g=new Array(0)}else{var g=a.n_state[a.tree_id]}g.push(e.id);a.n_saveState_node(g)}},scope:this},collapsenode:{fn:function(f,e){if(a.is_restore==false){a.n_state[a.tree_id].remove(e.id);a.n_saveState_node(a.n_state[a.tree_id])}},scope:this},activenodechange:{fn:function(e,g,f){if(!(Ext.ux.Utility.isNullOrUndefined(f))){if((f)&&(a.is_restore==false)){a.n_SelectedRow[a.tree_id]=f.id;a.cp.set("TreeGrid_sel_"+a.id,a.n_SelectedRow)}}},scope:this}});view.on({beforerefresh:{fn:function(e){if(!(a.tree_change==true)){a.n_st_scroll[a.tree_id]=view.getScrollState()}else{a.n_st_scroll[a.tree_id_old]=view.getScrollState()}},scope:this}})},scope:this}})}});Ext.reg("TreeGridStatefull",Ext.ux.plugins.TreeGridStatefull);(function(){function ab(A,p){A||(A={});for(var R in p){A[R]=p[R]}return A}function Y(p){return p!==s&&p!==null}function T(A,p,ac){var aa,S="setAttribute",R;if(typeof p=="string"){if(Y(ac)){A[S](p,ac)}else{if(A&&A.getAttribute){R=A.getAttribute(p)}}}else{if(Y(p)&&typeof p=="object"){for(aa in p){A[S](aa,p[aa])}}}return R}function ak(p){if(!p||p.constructor!=Array){p=[p]}return p}function at(){var A=arguments,p,R;for(p=0;p<A.length;p++){R=A[p];if(Y(R)){return R}}}function O(A){var p="",R;for(R in A){p+=C(R)+":"+A[R]+";"}return p}function c(A,p){if(d){if(p&&p.opacity!==s){p.filter="alpha(opacity="+p.opacity*100+")"}}ab(A.style,p)}function N(A,p,aa,S,R){A=aH.createElement(A);p&&ab(A,p);R&&c(A,{padding:0,border:f,margin:0});aa&&c(A,aa);S&&S.appendChild(A);return A}function a0(){var p=aN.global.useUTC;aQ=p?Date.UTC:function(A,a3,ac,aa,S,R){return(new Date(A,a3,at(ac,1),at(aa,0),at(S,0),at(R,0))).getTime()};l=p?"getUTCMinutes":"getMinutes";aZ=p?"getUTCHours":"getHours";aK=p?"getUTCDay":"getDay";av=p?"getUTCDate":"getDate";ao=p?"getUTCMonth":"getMonth";aA=p?"getUTCFullYear":"getFullYear";aL=p?"setUTCMinutes":"setMinutes";au=p?"setUTCHours":"setHours";ar=p?"setUTCDate":"setDate";W=p?"setUTCMonth":"setMonth";F=p?"setUTCFullYear":"setFullYear"}function e(p){aN=j(aN,p);a0();return aN}function aS(){return aN}function ad(p){K||(K=N(a));p&&K.appendChild(p);K.innerHTML=""}function aT(A,p){var R=function(){};R.prototype=new A;ab(R.prototype,p);return R}function aC(A,p,a3,ac){var aa=aN.lang;A=A;var S=isNaN(p=aq(p))?2:p;p=a3===undefined?aa.decimalPoint:a3;ac=ac===undefined?aa.thousandsSep:ac;aa=A<0?"-":"";a3=parseInt(A=aq(+A||0).toFixed(S),10)+"";var R=(R=a3.length)>3?R%3:0;return aa+(R?a3.substr(0,R)+ac:"")+a3.substr(R).replace(/(\d{3})(?=\d)/g,"$1"+ac)+(S?p+aq(A-a3).toFixed(S).slice(2):"")}function af(A){for(var p={x:A.offsetLeft,y:A.offsetTop};A.offsetParent;){A=A.offsetParent;p.x+=A.offsetLeft;p.y+=A.offsetTop;if(A!=aH.body&&A!=aH.documentElement){p.x-=A.scrollLeft;p.y-=A.scrollTop}}return p}function w(){}function L(bT){function bS(cP,cT){function cM(){var cb=[],cW;ci=cd=null;b1=[];J(a5,function(cX){cW=false;J(["xAxis","yAxis"],function(c0){if(cX.isCartesian&&(c0=="xAxis"&&ce||c0=="yAxis"&&!ce)&&(cX.options[c0]==cT.index||cX.options[c0]===s&&cT.index===0)){cX[c0]=bZ;b1.push(cX);cW=true}});if(!cX.visible&&bb.ignoreHiddenSeries){cW=false}if(cW){var cZ,cY;if(!ce){cZ=cX.options.stacking;cU=cZ=="percent";if(cZ){cY=cb[cX.type]||[];cb[cX.type]=cY}if(cU){ci=0;cd=99}}if(cX.isCartesian){J(cX.data,function(c2){var c0=c2.x,c1=c2.y;if(ci===null){ci=cd=c2[bV]}if(ce){if(c0>cd){cd=c0}else{if(c0<ci){ci=c0}}}else{if(Y(c1)){if(cZ){cY[c0]=cY[c0]?cY[c0]+c1:c1}c2=cY?cY[c0]:c1;if(!cU){if(c2>cd){cd=c2}else{if(c2<ci){ci=c2}}}if(cZ){cm[cX.type][c0]={total:c2,cum:c2}}}}});if(/(area|column|bar)/.test(cX.type)&&!ce){if(ci>=0){ci=0;cc=true}else{if(cd<0){cd=0;cS=true}}}}}})}function cG(cb,cZ,cW){var cY=1,cX=0;if(cW){cY*=-1;cX=cQ}if(cv){cY*=-1;cX-=cY*cQ}if(cZ){if(cv){cb=cQ-cb}cb=cb/cq+b9}else{cb=cY*(cb-b9)*cq+cX}return cb}function ch(cb,c0,cX){if(cX){var cZ,cY,c1;cZ=cG(cb);var cW;cb=cY=cZ+b6;cZ=c1=bl-cZ-b6;if(bY){cZ=bd;c1=bl-by;if(cb<A||cb>A+a6){cW=true}}else{cb=A;cY=bs-bB;if(cZ<bd||cZ>bd+bh){cW=true}}cW||a8.path(a8.crispLine([az,cb,cZ,aX,cY,c1],cX)).attr({stroke:c0,"stroke-width":cX}).add(b8)}}function cg(cb,cY,cW){cb=aM(cb,b9);cY=D(cY,bW);var cX=(cY-cb)*cq;ch(cb+(cY-cb)/2,cW,cX)}function cl(c0,cX,c5,c1,cb,cW,c4){var cY,c2,cZ,c3=cT.labels;if(cX=="inside"){cb=-cb}if(bU){cb=-cb}cX=c2=cG(c0+cs)+b6;cY=cZ=bl-cG(c0+cs)-b6;if(bY){cY=bl-by-(bU?bh:0)+cA;cZ=cY+cb}else{cX=A+(bU?a6:0)+cA;c2=cX-cb}c1&&a8.path(a8.crispLine([az,cX,cY,aX,c2,cZ],c1)).attr({stroke:c5,"stroke-width":c1}).add(cN);if(cW&&c3.enabled){if((c0=co.call({index:c4,isFirst:c0==cn[0],isLast:c0==cn[cn.length-1],dateTimeLabelFormat:cC,value:cx&&cx[c0]?cx[c0]:c0}))||c0===0){cX=cX+c3.x-(cs&&bY?cs*cq*(cv?-1:1):0);cY=cY+c3.y-(cs&&!bY?cs*cq*(cv?1:-1):0);a8.text(c0,cX,cY,c3.style,c3.rotation,c3.align).add(cN)}}}function cE(cb,cY){var cW;b0=cY?1:aI.pow(10,ah(aI.log(cb)/aI.LN10));cW=cb/b0;if(!cY){cY=[1,2,2.5,5,10];if(cT.allowDecimals===false){if(b0==1){cY=[1,2,5,10]}else{if(b0<=0.1){cY=[1/b0]}}}}for(var cX=0;cX<cY.length;cX++){cb=cY[cX];if(cW<=(cY[cX]+(cY[cX+1]||cY[cX]))/2){break}}cb*=b0;return cb}function cL(){cn=[];var c3,cZ=aN.global.useUTC,c9=1000/ae,c5=60000/ae,cX=3600000/ae,cY=86400000/ae,c8=604800000/ae,c1=2592000000/ae,c6=31556952000/ae,c2=[["second",c9,[1,2,5,10,15,30]],["minute",c5,[1,2,5,10,15,30]],["hour",cX,[1,2,3,4,6,8,12]],["day",cY,[1,2]],["week",c8,[1,2]],["month",c1,[1,2,3,4,6]],["year",c6,null]],c7=c2[6],c0=c7[1],cW=c7[2];for(c3=0;c3<c2.length;c3++){c7=c2[c3];c0=c7[1];cW=c7[2];if(c2[c3+1]){var c4=(c0*cW[cW.length-1]+c2[c3+1][1])/2;if(ca<=c4){break}}}if(c0==c6&&ca<5*c0){cW=[1,2,5]}c2=cE(ca/c0,cW);var cb;cW=new Date(b9*ae);cW.setMilliseconds(0);if(c0>=c9){cW.setSeconds(c0>=c5?0:c2*ah(cW.getSeconds()/c2))}if(c0>=c5){cW[aL](c0>=cX?0:c2*ah(cW[l]()/c2))}if(c0>=cX){cW[au](c0>=cY?0:c2*ah(cW[aZ]()/c2))}if(c0>=cY){cW[ar](c0>=c1?1:c2*ah(cW[av]()/c2))}if(c0>=c1){cW[W](c0>=c6?0:c2*ah(cW[ao]()/c2));cb=cW[aA]()}if(c0>=c6){cb-=cb%c2;cW[F](cb)}c0==c8&&cW[ar](cW[av]()-cW[aK]()+cT.startOfWeek);c3=1;cb=cW[aA]();c9=cW.getTime()/ae;c5=cW[ao]();for(cX=cW[av]();c9<bW&&c3<a6;){cn.push(c9);if(c0==c6){c9=aQ(cb+c3*c2,0)/ae}else{if(c0==c1){c9=aQ(cb,c5+c3*c2)/ae}else{if(!cZ&&(c0==cY||c0==c8)){c9=aQ(cb,c5,cX+c3*c2*(c0==cY?1:7))}else{c9+=c0*c2}}}c3++}cn.push(c9);cC=cT.dateTimeLabelFormats[c7[0]]}function cr(cb){var cW=(b0<1?aB(1/b0):1)*10;return aB(cb*cW)/cW}function b3(){var cb;cb=ah(b9/ca)*ca;var cW=aI.ceil(bW/ca)*ca;cn=[];for(cb=cr(cb);cb<=cW;){cn.push(cb);cb=cr(cb+ca)}if(cx){b9-=0.5;bW+=0.5}}function cO(){cD?cL():b3();var cb=cn[0],cW=cn[cn.length-1];if(cT.startOnTick){b9=cb}else{b9>cb&&cn.shift()}if(cT.endOnTick){bW=cW}else{bW<cW&&cn.pop()}}function cw(){if(!cD&&!cx){var cb=b7,cW=cn.length;b7=bE[bV];if(cW<b7){for(;cn.length<b7;){cn.push(cr(cn[cn.length-1]+ca))}cq*=(cW-1)/(b7-1)}if(Y(cb)&&b7!=cb){bZ.isDirty=true}}}function cB(){var cb,cZ,cW,cY=b9,cX=bW;cb=cT.maxZoom;var c0;cM();b9=at(cI,cT.min,ci);bW=at(cR,cT.max,cd);if(ct){c0=cP[ce?"xAxis":"yAxis"][cT.linkedTo];c0=c0.getExtremes();b9=at(c0.min,c0.dataMin);bW=at(c0.max,c0.dataMax)}if(bW-b9<cb){c0=(cb-bW+b9)/2;b9=aM(b9-c0,at(cT.min,b9-c0));bW=D(b9+cb,at(cT.max,b9+cb))}if(!cx&&!cU&&!ct&&Y(b9)&&Y(bW)){cb=bW-b9||1;if(!Y(cT.min)&&!Y(cI)&&cy&&(ci<0||!cc)){b9-=cb*cy}if(!Y(cT.max)&&!Y(cR)&&cf&&(cd>0||!cS)){bW+=cb*cf}}ca=cx||b9==bW?1:at(cT.tickInterval,(bW-b9)*cT.tickPixelInterval/cQ);if(!cD&&!Y(cT.tickInterval)){ca=cE(ca)}b2=cT.minorTickInterval==="auto"&&ca?ca/5:cT.minorTickInterval;cO();cq=cQ/(bW-b9||1);bE||(bE={x:0,y:0});if(!cD&&cn.length>bE[bV]){bE[bV]=cn.length}if(!ce){for(cZ in cm){for(cW in cm[cZ]){cm[cZ][cW].cum=cm[cZ][cW].total}}}if(!bZ.isDirty){bZ.isDirty=b9!=cY||bW!=cX}}function b5(cb,cX,cW){cW=at(cW,true);ay(bZ,"setExtremes",{min:cb,max:cX},function(){if(cx){if(cb<0){cb=0}if(cX>cx.length-1){cX=cx.length-1}}cI=cb;cR=cX;cW&&cP.redraw()})}function cj(){return{min:b9,max:bW,dataMin:ci,dataMax:cd}}function bX(cb){if(b9>cb){cb=b9}else{if(bW<cb){cb=bW}}return cG(cb,0,1)}function cV(cb){var cX=cb.width,cW=cX?cK:cu;cW.push(cb);cX?ch(cb.value,cb.color,cb.width):cg(cb.from,cb.to,cb.color)}function cJ(){var cb=cT.title,cZ=cT.alternateGridColor,cW=cT.minorTickWidth,cY=cT.lineWidth,cX,c0;cX=b1.length&&Y(b9)&&Y(bW);if(cN){cN.empty();b8.empty()}else{cN=a8.g("axis").attr({zIndex:7}).add();b8=a8.g("grid").attr({zIndex:1}).add()}if(cX||ct){cZ&&J(cn,function(c1,c2){if(c2%2===0&&c1<bW){cg(c1,cn[c2+1]!==s?cn[c2+1]:bW,cZ)}});J(cu,function(c1){cg(c1.from,c1.to,c1.color)});if(b2&&!cx){for(cX=b9;cX<=bW;cX+=b2){ch(cX,cT.minorGridLineColor,cT.minorGridLineWidth);cW&&cl(cX,cT.minorTickPosition,cT.minorTickColor,cW,cT.minorTickLength)}}J(cn,function(c1,c2){c0=c1+cs;ch(c0,cT.gridLineColor,cT.gridLineWidth);cl(c1,cT.tickPosition,cT.tickColor,cT.tickWidth,cT.tickLength,!(c1==b9&&!cT.showFirstLabel||c1==bW&&!cT.showLastLabel),c2)});J(cK,function(c1){ch(c1.value,c1.color,c1.width)})}if(!bZ.hasRenderedLine&&cY){cW=A+(bU?a6:0)+cA;cX=bl-by-(bU?bh:0)+cA;a8.path(a8.crispLine([az,bY?A:cW,bY?cX:bd,aX,bY?bs-bB:cW,bY?cX:bl-by],cY)).attr({stroke:cT.lineColor,"stroke-width":cY,zIndex:7}).add();bZ.hasRenderedLine=true}if(!bZ.hasRenderedTitle&&!bZ.axisTitle&&cb&&cb.text){cY=bY?A:bd;cY={low:cY+(bY?0:cQ),middle:cY+cQ/2,high:cY+(bY?cQ:0)}[cb.align];cW=(bY?bd+bh:A)+(bY?1:-1)*(bU?-1:1)*cb.margin-(d?parseInt(cb.style.fontSize||12,10)/3:0);bZ.axisTitle=a8.text(cb.text,bY?cY:cW+(bU?a6:0)+cA,bY?cW-(bU?bh:0)+cA:cY,cb.style,cb.rotation||0,{low:"left",middle:"center",high:"right"}[cb.align]).attr({zIndex:7}).add();bZ.hasRenderedTitle=true}bZ.isDirty=false}function cH(cb){J([cu,cK],function(cX){for(var cW=0;cW<cX.length;cW++){if(cX[cW].id==cb){cX.splice(cW,1);break}}});cJ()}function ck(){bq.resetTracker&&bq.resetTracker();cJ();J(b1,function(cb){cb.isDirty=true})}function b4(cb,cW){bZ.categories=cx=cb;J(b1,function(cX){cX.translate();cX.setTooltipPoints(true)});bZ.isDirty=true;at(cW,true)&&ck()}var ce=cT.isX,bU=cT.opposite,bY=aa?!ce:ce,cm={bar:{},column:{},area:{},areaspline:{},line:{}};cT=j(ce?aD:aw,bY?bU?aU:X:bU?aE:aj,cT);var bZ=this,cD=cT.type=="datetime",cA=cT.offset||0,bV=ce?"x":"y",cQ=bY?a6:bh,cq,b6=bY?A:by,cN,b8,ci,cd,b1,cI,cR,bW=null,b9=null,cy=cT.minPadding,cf=cT.maxPadding,ct=Y(cT.linkedTo),cc,cS,cU,cz=cT.events,cF,cu=cT.plotBands||[],cK=cT.plotLines||[],ca,b2,b0,cn,b7,cC,co=cT.labels.formatter||function(){var cb=this.value;return cC?ag(cC,cb):cb},cx=cT.categories||ce&&cP.columnCount,cv=cT.reversed,cs=cx&&cT.tickmarkPlacement=="between"?0.5:0;if(aa&&ce&&cv===s){cv=true}bU||(cA*=-1);if(bY){cA*=-1}ab(bZ,{addPlotBand:cV,addPlotLine:cV,adjustTickAmount:cw,categories:cx,getExtremes:cj,getThreshold:bX,isXAxis:ce,options:cT,render:cJ,setExtremes:b5,setScale:cB,setCategories:b4,translate:cG,redraw:ck,removePlotBand:cH,removePlotLine:cH,reversed:cv,stacks:cm});for(cF in cz){z(bZ,cF,cz[cF])}cB()}function bR(){function bU(bX,bZ,bY,b0){if(!bW[bX]){bZ=a8.text(bZ,A+a6-20,bd+30,bT.toolbar.itemStyle,0,"right").on("click",b0).attr({zIndex:20}).add();bW[bX]=bZ}}function bV(bX){ad(bW[bX].element);bW[bX]=null}var bW={};return{add:bU,remove:bV}}function bQ(b0){function b5(cc,cb){b6=ca?cc:(2*b6+cc)/3;b1=ca?cb:(b1+cb)/2;b2.translate(b6,b1);bg=aq(cc-b6)>1||aq(cb-b1)>1?function(){b5(cc,cb)}:null}function bW(){ca=true;b2.hide()}function b9(cf){var cc=cf.series,cb=b0.borderColor||cf.color||cc.color||"#606060",ce,cd;cd=cf.tooltipText;ce=cf.tooltipPos;b8=cc;cc=ce?ce[0]:aa?a6-cf.plotY:cf.plotX;cf=ce?ce[1]:aa?bh-cf.plotX:cf.plotY;ce=br(cc,cf);if(cd===false||!ce){bW()}else{if(ca){b2.show();ca=false}b3.attr({text:cd});cd=b3.getBBox();b4=cd.width;bU=cd.height;bY.attr({width:b4+2*bZ,height:bU+2*bZ,stroke:cb});cb=cc-b4+A-25;cc=cf-bU+bd+10;if(cb<7){cb=7;cc-=20}if(cc<5){cc=5}else{if(cc+bU>bl){cc=bl-bU-5}}b5(aB(cb-bX),aB(cc-bX))}}var b8,b7=b0.borderWidth,bV=b0.style,bZ=parseInt(bV.padding,10),bX=b7+bZ,ca=true,b4,bU,b6=0,b1=0;bV.padding=0;var b2=a8.g("tooltip").attr({zIndex:8}).add(),bY=a8.rect(bX,bX,0,0,b0.borderRadius,b7).attr({fill:b0.backgroundColor,"stroke-width":b7}).add(b2).shadow(b0.shadow),b3=a8.text("",bZ+bX,parseInt(bV.fontSize,10)+bZ+bX).attr({zIndex:1}).css(bV).add(b2);return{refresh:b9,hide:bW}}function bO(b4,b8){function b2(cb){cb=cb||h.event;if(!cb.target){cb.target=cb.srcElement}if(cb.type!="mousemove"||h.opera){a9=af(bP)}if(cb.layerX===s){if(d){cb.layerX=cb.x;cb.layerY=cb.y}else{cb.layerX=cb.pageX-a9.x;cb.layerY=cb.pageY-a9.y}}return cb}function b0(cd){var cb={xAxis:[],yAxis:[]};J(bH,function(ch){var cg=ch.translate,cf=ch.isXAxis,ce=aa?!cf:cf;cb[cf?"xAxis":"yAxis"].push({axis:ch,value:cg(ce?cd.layerX-A:bh-cd.layerY+bd,true)})});return cb}function bZ(cd){var cb=b4.hoverPoint,ce=b4.hoverSeries;if(ce&&ce.tracker){(cd=ce.tooltipPoints[aa?cd.layerY:cd.layerX-A])&&cd!=cb&&cd.onMouseOver()}}function bY(){var cd=b4.hoverSeries,cb=b4.hoverPoint;cb&&cb.onMouseOut();cd&&cd.onMouseOut();ac&&ac.hide()}function b1(){if(bV){var cd={xAxis:[],yAxis:[]},cb=bV.getBBox(),cf=cb.x-A,ce=cb.y-bd;if(ca){J(bH,function(ci){var cg=ci.translate,ch=ci.isXAxis,ck=aa?!ch:ch,cj=cg(ck?cf:bh-ce-cb.height,true);cg=cg(ck?cf+cb.width:bh-ce,true);cd[ch?"xAxis":"yAxis"].push({axis:ci,min:D(cj,cg),max:aM(cj,cg)})});ay(b4,"selection",cd,bz)}bV=bV.destroy()}b4.mouseIsDown=bi=ca=false}function b5(){var cb=true;bP.onmousedown=function(cd){cd=b2(cd);cd.preventDefault&&cd.preventDefault();b4.mouseIsDown=bi=true;bU=cd.layerX;b6=cd.layerY;if(bt&&(b9||cc)){bV||(bV=a8.rect(A,bd,bX?1:a6,bW?1:bh,0).attr({fill:"rgba(69,114,167,0.25)",zIndex:7}).add())}};bP.onmousemove=function(ce){ce=b2(ce);ce.returnValue=false;var cg=ce.layerX,cf=ce.layerY,cd=!br(cg-A,cf-bd);if(bi){ca=Math.sqrt(Math.pow(bU-cg,2)+Math.pow(b6-cf,2))>10;if(bX){ce=cg-bU;bV.attr({width:aq(ce),x:(ce>0?0:ce)+bU})}if(bW){cf=cf-b6;bV.attr({height:aq(cf),y:(cf>0?0:cf)+b6})}}else{cd||bZ(ce)}if(cd&&!cb){bY();b1()}cb=cd;return false};bP.onmouseup=function(){b1()};bP.onclick=function(ce){var cg=b4.hoverPoint;ce=b2(ce);ce.cancelBubble=true;if(!ca){if(cg&&T(ce.target,"isTracker")){var cf=cg.plotX,cd=cg.plotY;ab(cg,{pageX:a9.x+A+(aa?a6-cd:cf),pageY:a9.y+bd+(aa?bh-cf:cd)});ay(b4.hoverSeries,"click",ab(ce,{point:cg}));cg.firePointEvent("click",ce)}else{ab(ce,b0(ce));br(ce.layerX-A,ce.layerY-bd)&&ay(b4,"click",ce)}}ca=false}}function b7(){b4.trackerGroup=a4=a8.g("tracker");aa&&a4.attr({width:b4.plotWidth,height:b4.plotHeight}).invert();a4.attr({zIndex:9}).translate(A,bd).add()}var bU,b6,ca,bV,b3=bb.zoomType,b9=/x/.test(b3),cc=/y/.test(b3),bX=b9&&!aa||cc&&aa,bW=cc&&!aa||b9&&aa;b7();if(b8.enabled){b4.tooltip=ac=bQ(b8)}b5();ba=setInterval(function(){bg&&bg()},32);ab(this,{zoomX:b9,zoomY:cc,resetTracker:bY})}function bN(bU){var bW=bU.type||bb.defaultSeriesType,bX=x[bW],bV=bx.hasRendered;if(bV){if(aa&&bW=="column"){bX=x.bar}else{if(!aa&&bW=="bar"){bX=x.column}}}bW=new bX;bW.init(bx,bU);if(!bV&&bW.inverted){aa=true}if(bW.isCartesian){bt=bW.isCartesian}a5.push(bW);return bW}function bL(bU,bV){var bW;bV=at(bV,true);ay(bx,"addSeries",{options:bU},function(){bW=bN(bU);bW.isDirty=true;bx.isDirty=true;bV&&bx.redraw()});return bW}function bJ(){bb.alignTicks!==false&&J(bH,function(bU){bU.adjustTickAmount()})}function bI(){for(var bU=bx.isDirty,bX,bY=a5.length,bV=bY,bW;bV--;){bW=a5[bV];if(bW.isDirty&&bW.options.stacking){bX=true;break}}if(bX){for(bV=bY;bV--;){bW=a5[bV];if(bW.options.stacking){bW.isDirty=true}}}J(a5,function(bZ){if(bZ.isDirty){bZ.cleanData();bZ.getSegments();if(bZ.options.legendType=="point"){bU=true}}});bE=null;if(bt){J(bH,function(bZ){bZ.setScale()});bJ();J(bH,function(bZ){bZ.isDirty&&bZ.redraw()})}J(a5,function(bZ){bZ.isDirty&&bZ.visible&&bZ.redraw()});if(bU&&bC.renderLegend){bC.renderLegend();bx.isDirty=false}bq&&bq.resetTracker&&bq.resetTracker();ay(bx,"redraw")}function bG(){var bU=bT.loading;if(!a3){a3=N(a,{className:"highcharts-loading"},ab(bU.style,{left:A+U,top:bd+U,width:a6+U,height:bh+U,zIndex:10,display:f}),bP);N("span",{innerHTML:bT.lang.loading},bU.labelStyle,a3)}if(!bk){c(a3,{opacity:0,display:""});b(a3,{opacity:bU.style.opacity},{duration:bU.showDuration});bk=true}}function bF(){b(a3,{opacity:0},{duration:bT.loading.hideDuration,complete:function(){c(a3,{display:f})}});bk=false}function bA(bU){var bW,bX,bV;for(bW=0;bW<bH.length;bW++){if(bH[bW].options.id==bU){return bH[bW]}}for(bW=0;bW<a5.length;bW++){if(a5[bW].options.id==bU){return a5[bW]}}for(bW=0;bW<a5.length;bW++){bV=a5[bW].data;for(bX=0;bX<bV.length;bX++){if(bV[bX].id==bU){return bV[bX]}}}return null}function bw(){var bU=bT.xAxis||{},bV=bT.yAxis||{},bW;bU=ak(bU);J(bU,function(bX,bY){bX.index=bY;bX.isX=true});bV=ak(bV);J(bV,function(bX,bY){bX.index=bY});bH=bU.concat(bV);bx.xAxis=[];bx.yAxis=[];bH=M(bH,function(bX){bW=new bS(bx,bX);bx[bW.isXAxis?"xAxis":"yAxis"].push(bW);return bW});bJ()}function S(){var bU=[];J(a5,function(bV){bU=bU.concat(y(bV.data,function(bW){return bW.selected}))});return bU}function bj(){return y(a5,function(bU){return bU.selected})}function a7(){var bU=bT.title,bX=bU.align,bY=bT.subtitle,bV=bY.align,bW={left:0,center:bs/2,right:bs};bU&&bU.text&&a8.text(bU.text,bW[bX]+bU.x,bU.y,bU.style,0,bX).attr({"class":"highcharts-title"}).add();bY&&bY.text&&a8.text(bY.text,bW[bV]+bY.x,bY.y,bY.style,0,bV).attr({"class":"highcharts-subtitle"}).add()}function p(){bv=bb.renderTo;bM=B+al++;if(typeof bv=="string"){bv=aH.getElementById(bv)}bv.innerHTML="";if(!bv.offsetWidth){bm=bv.cloneNode(0);c(bm,{position:aO,top:"-9999px",display:""});aH.body.appendChild(bm)}var bU=(bm||bv).offsetHeight;bx.chartWidth=bs=bb.width||(bm||bv).offsetWidth||600;bx.chartHeight=bl=bb.height||(bU>bd+by?bU:0)||400;bx.plotWidth=a6=bs-A-bB;bx.plotHeight=bh=bl-bd-by;bx.plotLeft=A;bx.plotTop=bd;bx.container=bP=N(a,{className:"highcharts-container"+(bb.className?" "+bb.className:""),id:bM},ab({position:aP,overflow:k,width:bs+U,height:bl+U,textAlign:"left"},bb.style),bm||bv);bx.renderer=a8=bb.renderer=="SVG"?new ax(bP,bs,bl):new am(bP,bs,bl)}function bf(){var bU,bY=bT.labels,bZ=bT.credits,bV=bb.borderWidth||0,bX=bb.backgroundColor,bW=bb.plotBackgroundColor,b0=bb.plotBackgroundImage;bU=2*bV+(bb.shadow?8:0);if(bV||bX){a8.rect(bU/2,bU/2,bs-bU,bl-bU,bb.borderRadius,bV).attr({stroke:bb.borderColor,"stroke-width":bV,fill:bX||f}).add().shadow(bb.shadow)}bW&&a8.rect(A,bd,a6,bh,0).attr({fill:bW}).add().shadow(bb.plotShadow);b0&&a8.image(b0,A,bd,a6,bh).add();bb.plotBorderWidth&&a8.rect(A,bd,a6,bh,0,bb.plotBorderWidth).attr({stroke:bb.plotBorderColor,"stroke-width":bb.plotBorderWidth,zIndex:4}).add();bt&&J(bH,function(b1){b1.render()});a7();bY.items&&J(bY.items,function(){var b3=ab(bY.style,this.style),b2=parseInt(b3.left,10)+A,b1=parseInt(b3.top,10)+bd+12;delete b3.left;delete b3.top;a8.text(this.html,b2,b1,b3).attr({zIndex:2}).add()});J(a5,function(b1){b1.render()});bC=bx.legend=new bu(bx);if(!bx.toolbar){bx.toolbar=bR(bx)}bZ.enabled&&!bx.credits&&a8.text(bZ.text,bs-10,bl-5,bZ.style,0,"right").on("click",function(){location.href=bZ.href}).attr({zIndex:8}).add();bx.hasRendered=true;if(bm){bv.appendChild(bP);ad(bm)}}function bp(){var bU=a5.length;aW(h,"unload",bp);aW(bx);for(J(bH,function(bV){aW(bV)});bU--;){a5[bU].destroy()}bP.innerHTML="";bP=null;clearInterval(ba);for(bU in bx){delete bx[bU]}}function bK(){var bU="onreadystatechange";if(d&&aH.readyState!="complete"){aH.attachEvent(bU,function(){aH.detachEvent(bU,arguments.callee);bK()})}else{p();J(bT.series||[],function(bV){bN(bV)});bx.inverted=aa=at(aa,bT.chart.inverted);bx.plotSizeX=be=aa?bh:a6;bx.plotSizeY=R=aa?a6:bh;bx.tracker=bq=new bO(bx,bT.tooltip);bw();J(a5,function(bV){bV.translate();bV.setTooltipPoints()});bx.render=bf;bf();ay(bx,"load")}}aD=j(aD,aN.xAxis);aw=j(aw,aN.yAxis);aN.xAxis=aN.yAxis=null;bT=j(aN,bT);var bb=bT.chart,bn=bb.margin;bn=typeof bn=="number"?[bn,bn,bn,bn]:bn;var bd=at(bb.marginTop,bn[0]),bB=at(bb.marginRight,bn[1]),by=at(bb.marginBottom,bn[2]),A=at(bb.marginLeft,bn[3]),bv,bm,bP,bM,bs,bl,bx=this;bn=bb.events;var bD,bo,br,ac,bi,a3,bk,bh,a6,be,R,bq,a4,bC,a9,bt=bb.showAxes,bH=[],bE,a5=[],aa,a8,bg,ba,bz,bc,bu=function(ci){function cm(cw,cx){var cu=cw.legendItem,cb=cw.legendLine,ct=cw.legendSymbol,cy=cn.color,cv=cx?ce.itemStyle.color:cy;cw=cx?cw.color:cy;cu&&cu.attr({fill:cv});cb&&cb.attr({stroke:cw});ct&&ct.attr({stroke:cw,fill:cw})}function cf(cv,cw,cu){var cb=cv.legendItem,ct=cv.legendLine,cx=cv.legendSymbol;cv=cv.checkbox;cb&&cb.attr({x:cw,y:cu});ct&&ct.translate(cw,cu-4);cx&&cx.translate(cw,cu);if(cv){cv.x=cw;cv.y=cu}}function b8(ct){for(var cu=ck.length,cb=ct.checkbox;cu--;){if(ck[cu]==ct){ck.splice(cu,1);break}}J(["legendItem","legendLine","legendSymbol"],function(cv){ct[cv]&&ct[cv].destroy()});cb&&ad(ct.checkbox)}function b7(cu){var cv,ct,cb=cu.legendItem;ct=cu.series||cu;if(!cb){ct=/^(bar|pie|area|column)$/.test(ct.type);cu.legendItem=cb=a8.text(ce.labelFormatter.call(cu),0,0).css(bV).on("mouseover",function(){cu.setState(P);cb.css(cg)}).on("mouseout",function(){cb.css(cu.visible?bV:cn);cu.setState()}).on("click",function(){var cw="legendItemClick",cx=function(){cu.setVisible()};cu.firePointEvent?cu.firePointEvent(cw,null,cx):ay(cu,cw,null,cx)}).attr({zIndex:2}).add(bY);if(!ct&&cu.options&&cu.options.lineWidth){cu.legendLine=a8.path([az,-cl-bU,0,aX,-bU,0]).attr({"stroke-width":cu.options.lineWidth,zIndex:2}).add(bY)}if(ct){cv=a8.rect(-cl-bU,-11,cl,12,2).attr({"stroke-width":0,zIndex:3}).add(bY)}else{if(cu.options&&cu.options.marker&&cu.options.marker.enabled){cv=a8.symbol(cu.symbol,-cl/2-bU,-4,cu.options.marker.radius).attr(cu.pointAttr[o]).attr({zIndex:3}).add(bY)}}cu.legendSymbol=cv;cm(cu,cu.visible);if(cu.options&&cu.options.showCheckbox){cu.checkbox=N("input",{type:"checkbox",checked:cu.selected,defaultChecked:cu.selected},ce.itemCheckboxStyle,bP);z(cu.checkbox,"click",function(cw){cw=cw.target;ay(cu,"checkboxClick",{checked:cw.checked},function(){cu.select()})})}}cf(cu,ca,bZ);cv=cb.getBBox();b4=bZ;cu.legendItemWidth=cv=ce.itemWidth||cl+bU+cv.width+b3;if(cj){ca+=cv;ch=cd||aM(ca-b9,ch);if(ca-b9+cv>(cd||bs-2*cq-b9)){ca=b9;bZ+=b0}}else{bZ+=b0;ch=cd||aM(cv,ch)}ck.push(cu)}function b5(){ca=b9;bZ=cc;b4=ch=0;bY||(bY=a8.g("legend").attr({zIndex:7}).add());b6&&cs.reverse();J(cs,function(cw){if(cw.options.showInLegend){cw=cw.options.legendType=="point"?cw.data:[cw];J(cw,b7)}});b6&&cs.reverse();b2=cd||ch;bW=b4-cc+b0;if(bX||cr){b2+=2*cq;bW+=2*cq;if(b1){b1.attr({height:bW,width:b2})}else{b1=a8.rect(0,0,b2,bW,ce.borderRadius,bX||0).attr({stroke:ce.borderColor,"stroke-width":bX||0,fill:cr||f}).add(bY).shadow(ce.shadow)}}for(var cu=["left","right","top","bottom"],cv,ct=4;ct--;){cv=cu[ct];if(co[cv]&&co[cv]!="auto"){ce[ct<2?"align":"verticalAlign"]=cv;ce[ct<2?"x":"y"]=parseInt(co[cv],10)*(ct%2?-1:1)}}var cb=bo(ab({width:b2,height:bW},ce));bY.translate(cb.x,cb.y);J(ck,function(cw){var cx=cw.checkbox;cx&&c(cx,{left:cb.x+cw.legendItemWidth+cx.x-40+U,top:cb.y+cx.y-11+U})})}var ce=ci.options.legend;if(ce.enabled){var cj=ce.layout=="horizontal",cl=ce.symbolWidth,bU=ce.symbolPadding,ck=[],co=ce.style,bV=ce.itemStyle,cg=ce.itemHoverStyle,cn=ce.itemHiddenStyle,cq=parseInt(co.padding,10),b3=20,b0=ce.lineHeight||16,cc=18,b9=4+cq+cl+bU,ca,bZ,b4,b1,bX=ce.borderWidth,cr=ce.backgroundColor,bY,ch,cd=ce.width,b2,bW,cs=ci.series,b6=ce.reversed;b5();return{colorizeItem:cm,destroyItem:b8,renderLegend:b5}}};br=function(bU,bW){var bX=0,bV=0;return bU>=bX&&bU<=bX+a6&&bW>=bV&&bW<=bV+bh};bc=function(){ay(bx,"selection",{resetSelection:true},bz);bx.toolbar.remove("zoom")};bz=function(bU){var bV=aN.lang;bx.toolbar.add("zoom",bV.resetZoom,bV.resetZoomTitle,bc);!bU||bU.resetSelection?J(bH,function(bW){bW.setExtremes(null,null,false)}):J(bU.xAxis.concat(bU.yAxis),function(bX){var bW=bX.axis;if(bx.tracker[bW.isXAxis?"zoomX":"zoomY"]){bW.setExtremes(bX.min,bX.max,false)}});bI()};bo=function(bU){var bY=bU.align,bZ=bU.verticalAlign,bV=bU.x||0,bX=bU.y||0,bW={x:bV||0,y:bX||0};if(/^(right|center)$/.test(bY)){bW.x=(bs-bU.width)/{right:1,center:2}[bY]+bV}if(/^(bottom|middle)$/.test(bZ)){bW.y=(bl-bU.height)/{bottom:1,middle:2}[bZ]+bX}return bW};g=a1=0;z(h,"unload",bp);if(bn){for(bD in bn){z(bx,bD,bn[bD])}}bx.options=bT;bx.series=a5;bx.addSeries=bL;bx.destroy=bp;bx.get=bA;bx.getAlignment=bo;bx.getSelectedPoints=S;bx.getSelectedSeries=bj;bx.hideLoading=bF;bx.isInsidePlot=br;bx.redraw=bI;bx.showLoading=bG;bK()}function Z(A){var p=[],a3=[],ac;for(ac=0;ac<A.length;ac++){p[ac]=A[ac].plotX;a3[ac]=A[ac].plotY}this.xdata=p;this.ydata=a3;A=[];this.y2=[];var aa=a3.length;this.n=aa;this.y2[0]=0;this.y2[aa-1]=0;A[0]=0;for(ac=1;ac<aa-1;ac++){var S=p[ac+1]-p[ac-1];S=(p[ac]-p[ac-1])/S;var R=S*this.y2[ac-1]+2;this.y2[ac]=(S-1)/R;A[ac]=(a3[ac+1]-a3[ac])/(p[ac+1]-p[ac])-(a3[ac]-a3[ac-1])/(p[ac]-p[ac-1]);A[ac]=(6*A[ac]/(p[ac+1]-p[ac-1])-S*A[ac-1])/R}for(p=aa-2;p>=0;p--){this.y2[p]=this.y2[p]*this.y2[p+1]+A[p]}}var aH=document,h=window,aI=Math,aB=aI.round,ah=aI.floor,aM=aI.max,D=aI.min,aq=aI.abs,aG=aI.cos,an=aI.sin,n=navigator.userAgent,d=/msie/i.test(n)&&!h.opera,aY=/AppleWebKit/.test(n),I=h.SVGAngle||aH.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),a1,g,aJ={},al=0,ae=1,K,aN,ag,s,a="div",aO="absolute",aP="relative",k="hidden",B="highcharts-",H="visible",U="px",f="none",az="M",aX="L",v="rgba(192,192,192,0.005)",o="",P="hover",q="select",aQ,l,aZ,aK,av,ao,aA,aL,au,ar,W,F,ai=h.HighchartsAdapter,a2=ai||{},J=a2.each,y=a2.grep,M=a2.map,j=a2.merge,C=a2.hyphenate,z=a2.addEvent,aW=a2.removeEvent,ay=a2.fireEvent,b=a2.animate,aV=a2.stop;a2=a2.getAjax;var x={};if(!ai&&h.jQuery){var aR=jQuery;J=function(A,p){for(var S=0,R=A.length;S<R;S++){if(p.call(A[S],A[S],S,A)===false){return S}}};y=aR.grep;M=function(A,p){for(var aa=[],S=0,R=A.length;S<R;S++){aa[S]=p.call(A[S],A[S],S,A)}return aa};j=function(){var p=arguments;return aR.extend(true,null,p[0],p[1],p[2],p[3])};C=function(p){return p.replace(/([A-Z])/g,function(A,R){return"-"+R.toLowerCase()})};z=function(A,p,R){aR(A).bind(p,R)};aW=function(A,p,S){var R=aH.removeEventListener?"removeEventListener":"detachEvent";if(aH[R]&&!A[R]){A[R]=function(){}}aR(A).unbind(p,S)};ay=function(A,p,ac,aa){var S=aR.Event(p),R="detached"+p;ab(S,ac);if(A[p]){A[R]=A[p];A[p]=null}aR(A).trigger(S);if(A[R]){A[p]=A[R];A[R]=null}aa&&!S.isDefaultPrevented()&&aa(S)};b=function(A,p,R){A=aR(A);A.stop();A.animate(p,R)};aV=function(p){aR(p).stop()};a2=function(A,p){aR.get(A,null,p)};aR.extend(aR.easing,{easeOutQuad:function(A,p,aa,S,R){return -S*(p/=R)*(p-2)+aa}});var ap=jQuery.fx.step._default,V=jQuery.fx.prototype.cur;aR.fx.step._default=function(A){var p=A.elem;p.attr?p.attr(A.prop,A.now):ap.apply(this,arguments)};aR.fx.prototype.cur=function(){var p=this.elem;return p=p.attr?p.attr(this.prop):V.apply(this,arguments)}}else{if(!ai&&h.MooTools){J=$each;M=function(A,p){return A.map(p)};y=function(A,p){return A.filter(p)};j=$merge;C=function(p){return p.hyphenate()};z=function(A,p,R){if(typeof p=="string"){if(p=="unload"){p="beforeunload"}if(!A.addEvent){if(A.nodeName){A=$(A)}else{ab(A,new Events)}}A.addEvent(p,R)}};aW=function(A,p,R){if(p){if(p=="unload"){p="beforeunload"}A.removeEvent(p,R)}};ay=function(A,p,S,R){p=new Event({type:p,target:A});p=ab(p,S);p.preventDefault=function(){R=null};A.fireEvent&&A.fireEvent(p.type,p);R&&R(p)};b=function(A,p,S){var R=A.attr;if(R&&!A.setStyle){A.setStyle=A.getStyle=A.attr;A.$family=A.uid=true}aV(A);S=new Fx.Morph(R?A:$(A),ab(S,{transition:Fx.Transitions.Quad.easeInOut}));S.start(p);A.fx=S};aV=function(p){p.fx&&p.fx.cancel()};a2=function(A,p){(new Request({url:A,method:"get",onSuccess:p})).send()}}}ai={enabled:true,align:"center",x:0,y:15,style:{color:"#666",fontSize:"11px"}};aN={colors:["#4572A7","#AA4643","#89A54E","#80699B","#3D96AE","#DB843D","#92A8CD","#A47D7C","#B5CA92"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:","},global:{useUTC:true},chart:{margin:[50,50,90,80],borderColor:"#4572A7",borderRadius:5,defaultSeriesType:"line",ignoreHiddenSeries:true,style:{fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif',fontSize:"12px"},backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0"},title:{text:"Chart title",x:0,y:20,align:"center",style:{color:"#3E576F",fontSize:"16px"}},subtitle:{text:"",x:0,y:40,align:"center",style:{color:"#6D869F"}},plotOptions:{line:{allowPointSelect:false,showCheckbox:false,animation:true,events:{},lineWidth:2,shadow:true,marker:{enabled:true,lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:j(ai,{enabled:false,y:-6,formatter:function(){return this.y}}),showInLegend:true,states:{hover:{lineWidth:3,marker:{}},select:{marker:{}}},stickyTracking:true}},labels:{style:{position:aO,color:"#3E576F"}},legend:{enabled:true,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderWidth:1,borderColor:"#909090",borderRadius:5,shadow:false,style:{padding:"5px"},itemStyle:{cursor:"pointer",color:"#3E576F"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#C0C0C0"},itemCheckboxStyle:{position:aO,width:"13px",height:"13px"},symbolWidth:16,symbolPadding:5,verticalAlign:"bottom",x:15,y:-15},loading:{hideDuration:100,labelStyle:{fontWeight:"bold",position:aP,top:"1em"},showDuration:100,style:{position:aO,backgroundColor:"white",opacity:0.5,textAlign:"center"}},tooltip:{enabled:true,formatter:function(){var A=this,p=A.series,S=p.xAxis,R=A.x;return"<b>"+(A.point.name||p.name)+"</b><br/>"+(Y(R)?"X value: "+(S&&S.options.type=="datetime"?ag(null,R):R)+"<br/>":"")+"Y value: "+A.y},backgroundColor:"rgba(255, 255, 255, .85)",borderWidth:2,borderRadius:5,shadow:true,snap:10,style:{color:"#333333",fontSize:"12px",padding:"5px",whiteSpace:"nowrap"}},toolbar:{itemStyle:{color:"#4572A7",cursor:"pointer"}},credits:{enabled:true,text:"Highcharts.com",href:"http://www.highcharts.com",style:{cursor:"pointer",color:"#909090",fontSize:"10px"}}};var aD={dateTimeLabelFormats:{second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:false,gridLineColor:"#C0C0C0",labels:ai,lineColor:"#C0D0E0",lineWidth:1,max:null,min:null,minPadding:0.01,maxPadding:0.01,maxZoom:null,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",minorTickWidth:1,showFirstLabel:true,showLastLabel:false,startOfWeek:1,startOnTick:false,tickColor:"#C0D0E0",tickLength:5,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",tickWidth:1,title:{align:"middle",margin:35,style:{color:"#6D869F",fontWeight:"bold"}},type:"linear"},aw=j(aD,{endOnTick:true,gridLineWidth:1,tickPixelInterval:72,showLastLabel:true,labels:{align:"right",x:-8,y:3},lineWidth:0,maxPadding:0.05,minPadding:0.05,startOnTick:true,tickWidth:0,title:{margin:40,rotation:270,text:"Y-values"}}),aj={labels:{align:"right",x:-8,y:3},title:{rotation:270}},aE={labels:{align:"left",x:8,y:3},title:{rotation:90}},X={labels:{align:"center",x:0,y:14},title:{rotation:0}},aU=j(X,{labels:{y:-5}});ai=aN.plotOptions;a2=ai.line;ai.spline=j(a2);ai.scatter=j(a2,{lineWidth:0,states:{hover:{lineWidth:0}}});ai.area=j(a2,{});ai.areaspline=j(ai.area);ai.column=j(a2,{borderColor:"#FFFFFF",borderWidth:1,borderRadius:0,groupPadding:0.2,marker:null,pointPadding:0.1,minPointLength:0,states:{hover:{brightness:0.1,shadow:false},select:{color:"#C0C0C0",borderColor:"#000000",shadow:false}}});ai.bar=j(ai.column,{dataLabels:{align:"left",x:5,y:0}});ai.pie=j(a2,{borderColor:"#FFFFFF",borderWidth:1,center:["50%","50%"],colorByPoint:true,legendType:"point",marker:null,size:"90%",slicedOffset:10,states:{hover:{brightness:0.1,shadow:false}}});a0();var Q=function(A){function p(a4){if(R=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/.exec(a4)){S=[parseInt(R[1],10),parseInt(R[2],10),parseInt(R[3],10),parseFloat(R[4],10)]}else{if(R=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(a4)){S=[parseInt(R[1],16),parseInt(R[2],16),parseInt(R[3],16),1]}}}function a3(a4){return a4=S&&!isNaN(S[0])?a4=="rgb"?"rgb("+S[0]+","+S[1]+","+S[2]+")":a4=="a"?S[3]:"rgba("+S.join(",")+")":A}function ac(a5){if(typeof a5=="number"&&a5!==0){for(var a4=0;a4<3;a4++){S[a4]+=parseInt(a5*255,10);if(S[a4]<0){S[a4]=0}if(S[a4]>255){S[a4]=255}}}return this}function aa(a4){S[3]=a4;return this}var S=[],R;p(A);return{get:a3,brighten:ac,setOpacity:aa}};ag=function(a7,a6,a5){function a4(a9){return a9.toString().replace(/^([0-9])$/,"0$1")}if(!Y(a6)||isNaN(a6)){return"Invalid date"}a7=at(a7,"%Y-%m-%d %H:%M:%S");a6=new Date(a6*ae);var a3=a6[aZ](),ac=a6[aK](),aa=a6[av](),S=a6[ao](),R=a6[aA](),A=aN.lang,p=A.weekdays;A=A.months;a6={a:p[ac].substr(0,3),A:p[ac],d:a4(aa),e:aa,b:A[S].substr(0,3),B:A[S],m:a4(S+1),y:R.toString().substr(2,2),Y:R,H:a4(a3),I:a4(a3%12||12),l:a3%12||12,M:a4(a6[l]()),p:a3<12?"AM":"PM",P:a3<12?"am":"pm",S:a4(a6.getSeconds())};for(var a8 in a6){a7=a7.replace("%"+a8,a6[a8])}return a5?a7.substr(0,1).toUpperCase()+a7.substr(1):a7};w.prototype={init:function(A,p){this.element=aH.createElementNS("http://www.w3.org/2000/svg",p);this.renderer=A},animate:function(A,p){b(this,A,p)},attr:function(a7,a6){var a5,a4,a3,ac=this.element,aa=ac.nodeName,S=this.renderer,R,A=this.shadows,p,a8=this;if(typeof a7=="string"&&Y(a6)){a5=a7;a7={};a7[a5]=a6}if(typeof a7=="string"){a5=a7;if(aa=="circle"){a5={x:"cx",y:"cy"}[a5]||a5}else{if(a5=="strokeWidth"){a5="stroke-width"}}a8=parseFloat(T(ac,a5)||this[a5]||0)}else{for(a5 in a7){a6=a7[a5];if(a5=="d"){if(typeof a6!="string"){a6=a6.join(" ")}}else{if(a5=="x"&&aa=="text"){for(a4=0;a4<ac.childNodes.length;a4++){a3=ac.childNodes[a4];T(a3,"x")==T(ac,"x")&&T(a3,"x",a6)}}else{if(a5=="fill"){a6=S.color(a6,ac,a5)}else{if(aa=="circle"){a5={x:"cx",y:"cy"}[a5]||a5}else{if(a5=="translateX"||a5=="translateY"){this[a5]=a6;this.updateTransform();R=true}else{if(a5=="stroke"){a6=S.color(a6,ac,a5)}else{if(a5=="isTracker"){this[a5]=a6}}}}}}}if(a5=="strokeWidth"){a5="stroke-width"}if(aY&&a5=="stroke-width"&&a6===0){a6=0.000001}if(this.symbolName&&/^(x|y|r|start|end|innerR)/.test(a5)){if(!p){this.symbolAttr(a7);p=true}R=true}if(A&&/^(width|height|visibility|x|y|d)$/.test(a5)){for(a4=A.length;a4--;){T(A[a4],a5,a6)}}if(a5=="text"){S.buildText(ac,a6)}else{R||T(ac,a5,a6)}}}return a8},symbolAttr:function(A){var p=this;p.x=at(A.x,p.x);p.y=at(A.y,p.y);p.r=at(A.r,p.r);p.start=at(A.start,p.start);p.end=at(A.end,p.end);p.width=at(A.width,p.width);p.height=at(A.height,p.height);p.innerR=at(A.innerR,p.innerR);p.attr({d:p.renderer.symbols[p.symbolName](p.x,p.y,p.r,{start:p.start,end:p.end,width:p.width,height:p.height,innerR:p.innerR})})},clip:function(p){return this.attr("clip-path","url("+this.renderer.url+"#"+p.id+")")},css:function(A){var p=this;if(A&&A.color){A.fill=A.color}A=ab(p.styles,A);p.attr({style:O(A)});p.styles=A;return p},on:function(A,p){this.element["on"+A]=p;return this},translate:function(A,p){var R=this;R.translateX=A;R.translateY=p;R.updateTransform();return R},invert:function(){var p=this;p.inverted=true;p.updateTransform();return p},updateTransform:function(){var A=this,p=A.translateX||0,aa=A.translateY||0,S=A.inverted,R=[];if(S){p+=A.attr("width");aa+=A.attr("height")}if(p||aa){R.push("translate("+p+","+aa+")")}S&&R.push("rotate(90) scale(-1,1)");R.length&&T(A.element,"transform",R.join(" "))},toFront:function(){var p=this.element;p.parentNode.appendChild(p);return this},getBBox:function(){return this.element.getBBox()},show:function(){return this.attr({visibility:H})},hide:function(){return this.attr({visibility:k})},add:function(A){var p=A?A.element:this.renderer.box,a3=p.childNodes,ac=this.element,aa=T(ac,"zIndex"),S,R;this.parentInverted=A&&A.inverted;for(R=0;R<a3.length;R++){A=a3[R];S=T(A,"zIndex");if(A!=ac&&(S>aa||!Y(aa)&&Y(S))){p.insertBefore(ac,A);return this}}p.appendChild(ac);return this},destroy:function(){var A=this,p=A.element,aa=A.shadows,S=p.parentNode,R;p.onclick=p.onmouseout=p.onmouseover=p.onmousemove=null;aV(A);S&&S.removeChild(p);aa&&J(aa,function(ac){(S=ac.parentNode)&&S.removeChild(ac)});for(R in A){delete A[R]}return null},empty:function(){for(var A=this.element,p=A.childNodes,R=p.length;R--;){A.removeChild(p[R])}},shadow:function(A){var p=[],aa,S=this.element,R=this.parentInverted?"(-1,-1)":"(1,1)";if(A){for(A=1;A<=3;A++){aa=S.cloneNode(0);T(aa,{isShadow:"true",stroke:"rgb(0, 0, 0)","stroke-opacity":0.05*A,"stroke-width":7-2*A,transform:"translate"+R,fill:f});S.parentNode.insertBefore(aa,S);p.push(aa)}this.shadows=p}return this}};var ax=function(){this.init.apply(this,arguments)};ax.prototype={init:function(A,p,aa){var S=aH.createElementNS("http://www.w3.org/2000/svg","svg"),R=location;T(S,{width:p,height:aa,xmlns:"http://www.w3.org/2000/svg",version:"1.1"});A.appendChild(S);this.Element=w;this.box=S;this.url=R.href.replace(/#.*?$/,"");this.defs=this.createElement("defs").add()},createElement:function(A){var p=new this.Element;p.init(this,A);return p},buildText:function(A,p){p=p.toString().replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split("<br/>");var a3=A.childNodes,ac=/style="([ 0-9a-z:;\-]+)"/,aa=/href="([^"]+)"/,S=T(A,"x"),R;for(R=a3.length-1;R>=0;R--){A.removeChild(a3[R])}J(p,function(a6,a5){var a4=0;a6=a6.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||");a6=a6.split("|||");J(a6,function(a9){if(a9!==""){var a7={},a8=aH.createElementNS("http://www.w3.org/2000/svg","tspan");ac.test(a9)&&T(a8,"style",a9.match(ac)[1].replace(/(;| |^)color([ :])/,"$1fill$2"));if(aa.test(a9)){T(a8,"onclick",'location.href="'+a9.match(aa)[1]+'"');c(a8,{cursor:"pointer"})}a9=a9.replace(/<(.|\n)*?>/g,"");a8.appendChild(aH.createTextNode(a9));if(a4){a7.dx=3}else{a7.x=S}if(a5&&!a4){a7.dy=16}T(a8,a7);A.appendChild(a8);a4++}})})},crispLine:function(A,p){if(A[1]==A[4]){A[1]=A[4]=aB(A[1])+p%2/2}if(A[2]==A[5]){A[2]=A[5]=aB(A[2])+p%2/2}return A},path:function(p){return this.createElement("path").attr({d:p,fill:f})},circle:function(A,p,R){A=typeof A=="object"?A:{x:A,y:p,r:R};return this.createElement("circle").attr(A)},arc:function(A,p,ac,aa,S,R){if(typeof A=="object"){p=A.y;ac=A.r;aa=A.innerR;S=A.start;R=A.end;A=A.x}return this.symbol("arc",A||0,p||0,ac||0,{innerR:aa||0,start:S||0,end:R||0})},rect:function(A,p,a3,ac,aa,S){if(arguments.length>1){var R=(S||0)%2/2;A=aB(A||0)+R;p=aB(p||0)+R;a3=aB((a3||0)-2*R);ac=aB((ac||0)-2*R)}R=typeof A=="object"?A:{x:A,y:p,width:aM(a3,0),height:aM(ac,0)};return this.createElement("rect").attr(ab(R,{rx:aa||R.r,ry:aa||R.r,fill:f}))},g:function(p){return this.createElement("g").attr(Y(p)&&{"class":B+p})},image:function(A,p,aa,S,R){p=this.createElement("image").attr({x:p,y:aa,width:S,height:R,preserveAspectRatio:f});p.element.setAttributeNS("http://www.w3.org/1999/xlink","href",A);return p},symbol:function(A,p,a4,a3,ac){var aa,S=this.symbols[A];S=S&&S(p,a4,a3,ac);var R=/^url\((.*?)\)$/;if(S){aa=this.path(S);ab(aa,{symbolName:A,x:p,y:a4,r:a3});ac&&ab(aa,ac)}else{if(R.test(A)){A=A.match(R)[1];aa=this.image(A).attr({visibility:k});N("img",{onload:function(){var a5=this;a5=aJ[a5.src]||[a5.width,a5.height];aa.attr({x:aB(p-a5[0]/2)+U,y:aB(a4-a5[1]/2)+U,width:a5[0],height:a5[1],visibility:"inherit"})},src:A})}else{aa=this.circle(p,a4,a3)}}return aa},symbols:{square:function(A,p,R){R=0.707*R;return[az,A-R,p-R,aX,A+R,p-R,A+R,p+R,A-R,p+R,"Z"]},triangle:function(A,p,R){return[az,A,p-1.33*R,aX,A+R,p+0.67*R,A-R,p+0.67*R,"Z"]},"triangle-down":function(A,p,R){return[az,A,p+1.33*R,aX,A-R,p-0.67*R,A+R,p-0.67*R,"Z"]},diamond:function(A,p,R){return[az,A,p-R,aX,A+R,p,A,p+R,A-R,p,"Z"]},arc:function(a7,a6,a5,a4){var a3=Math.PI,ac=a4.start,aa=a4.end-0.000001,S=a4.innerR,R=aG(ac),A=an(ac),p=aG(aa);aa=an(aa);a4=a4.end-ac<a3?0:1;return[az,a7+a5*R,a6+a5*A,"A",a5,a5,0,a4,1,a7+a5*p,a6+a5*aa,aX,a7+S*p,a6+S*aa,"A",S,S,0,a4,0,a7+S*R,a6+S*A,"Z"]}},clipRect:function(A,p,ac,aa){var S=B+al++,R=this.createElement("clipPath").attr({id:S}).add(this.defs);A=this.rect(A,p,ac,aa,0).add(R);A.id=S;return A},color:function(a6,a5,a4){var a3,ac=/^rgba/;if(a6&&a6.linearGradient){var aa=this;a5="linearGradient";a4=a6[a5];var S=B+al++,R,A,p;R=aa.createElement(a5).attr({id:S,gradientUnits:"userSpaceOnUse",x1:a4[0],y1:a4[1],x2:a4[2],y2:a4[3]}).add(aa.defs);J(a6.stops,function(a7){if(ac.test(a7[1])){a3=Q(a7[1]);A=a3.get("rgb");p=a3.get("a")}else{A=a7[1];p=1}aa.createElement("stop").attr({offset:a7[0],"stop-color":A,"stop-opacity":p}).add(R)});return"url("+this.url+"#"+S+")"}else{if(ac.test(a6)){a3=Q(a6);T(a5,a4+"-opacity",a3.get("a"));return a3.get("rgb")}else{return a6}}},text:function(A,p,a4,a3,ac,aa){a3=a3||{};aa=aa||"left";ac=ac||0;var S=a3.color||"#000000",R=aN.chart.style;p=aB(at(p,0));a4=aB(at(a4,0));ab(a3,{fontFamily:a3.fontFamily||R.fontFamily,fontSize:a3.fontSize||R.fontSize});a3=O(a3);A={x:p,y:a4,text:A,fill:S,style:a3.replace(/"/g,"'")};if(ac||aa!="left"){A=ab(A,{"text-anchor":{left:"start",center:"middle",right:"end"}[aa],transform:"rotate("+ac+" "+p+" "+a4+")"})}return this.createElement("text").attr(A)}};var m;if(!I){var E=aT(w,{init:function(A,p){var S=["<",p,' filled="f" stroked="f"'],R=["position: ",aO,";"];if(p=="shape"||p==a){R.push("left:0;top:0;width:10px;height:10px;")}S.push(' style="',R.join(""),'"/>');if(p){S=p==a||p=="span"||p=="img"?S.join(""):A.prepVML(S);this.element=N(S)}this.renderer=A},add:function(A){var p=this,aa=p.renderer,S=p.element,R=aa.box;aa=A&&A.inverted;A=A?A.element||A:R;if(aa){aa=A.style;c(S,{flip:"x",left:parseInt(aa.width,10)-10,top:parseInt(aa.height,10)-10,rotation:-90})}A.appendChild(S);return p},attr:function(a9,a8){var a6,a5,a4,a3=this.element,ac=a3.style,aa=a3.nodeName,S=this.renderer,R=this.symbolName,A,ba=this.shadows,a7,p=this;if(typeof a9=="string"&&Y(a8)){a6=a9;a9={};a9[a6]=a8}if(typeof a9=="string"){a6=a9;p=a6=="strokeWidth"||a6=="stroke-width"?a3.strokeweight:at(this[a6],parseInt(ac[{x:"left",y:"top"}[a6]||a6],10))}else{for(a6 in a9){a5=a9[a6];a7=false;if(R&&/^(x|y|r|start|end|width|height|innerR)/.test(a6)){if(!A){this.symbolAttr(a9);A=true}a7=true}else{if(a6=="d"){a4=a5.length;for(a7=[];a4--;){a7[a4]=typeof a5[a4]=="number"?aB(a5[a4]*10)-5:a5[a4]=="Z"?"x":a5[a4]}a5=a7.join(" ")||"x";a3.path=a5;if(ba){for(a4=ba.length;a4--;){ba[a4].path=a5}}a7=true}else{if(a6=="zIndex"||a6=="visibility"){ac[a6]=a5;a7=true}else{if(/^(width|height)$/.test(a6)){ac[a6]=a5;this.updateClipping&&this.updateClipping();a7=true}else{if(/^(x|y)$/.test(a6)){if(a6=="y"&&a3.tagName=="SPAN"&&a3.lineHeight){a5-=a3.lineHeight}ac[{x:"left",y:"top"}[a6]]=a5}else{if(a6=="class"){a3.className=a5}else{if(a6=="stroke"){a5=S.color(a5,a3,a6);a6="strokecolor"}else{if(a6=="stroke-width"||a6=="strokeWidth"){a3.stroked=a5?true:false;a6="strokeweight";if(typeof a5=="number"){a5+=U}}else{if(a6=="fill"){if(aa=="SPAN"){ac.color=a5}else{a3.filled=a5!=f?true:false;a5=S.color(a5,a3,a6);a6="fillcolor"}}else{if(a6=="translateX"||a6=="translateY"){this[a6]=a8;this.updateTransform();a7=true}}}}}}}}}}if(ba&&a6=="visibility"){for(a4=ba.length;a4--;){ba[a4].style[a6]=a5}}if(a6=="text"){a3.innerHTML=a5}else{if(!a7){if(aH.documentMode==8){a3[a6]=a5}else{T(a3,a6,a5)}}}}}return p},clip:function(A){var p=this,S=A.members,R=S.length;S.push(p);p.destroyClip=function(){S.splice(R,1)};return p.css({clip:A.getCSS(p.inverted)})},css:function(A){var p=this;c(p.element,A);return p},destroy:function(){var p=this;p.destroyClip&&p.destroyClip();w.prototype.destroy.apply(this)},empty:function(){var A=this.element;A=A.childNodes;for(var p=A.length,R;p--;){R=A[p];R.parentNode.removeChild(R)}},getBBox:function(){var A=this.element,p,S=A.offsetWidth,R=A.parentNode;S||aH.body.appendChild(A);p={x:A.offsetLeft,y:A.offsetTop,width:A.offsetWidth,height:A.offsetHeight};S||(R?R.appendChild(A):aH.body.removeChild(A));return p},on:function(A,p){this.element["on"+A]=function(){var R=h.event;R.target=R.srcElement;p(R)};return this},updateTransform:function(){var A=this,p=A.translateX||0,R=A.translateY||0;if(p||R){A.css({left:p,top:R})}},shadow:function(A){var p=[],a3=this.element,ac=this.renderer,aa,S=a3.style,R;if(A&&typeof a3.path=="string"){for(A=1;A<=3;A++){R=['<shape isShadow="true" strokeweight="',7-2*A,'" filled="false" path="',a3.path,'" coordsize="100,100" style="',a3.style.cssText,'" />'];aa=N(ac.prepVML(R),null,{left:parseInt(S.left,10)+1,top:parseInt(S.top,10)+1});R=['<stroke color="black" opacity="',0.05*A,'"/>'];N(ac.prepVML(R),null,null,aa);a3.parentNode.insertBefore(aa,a3);p.push(aa)}this.shadows=p}return this}});m=function(){this.init.apply(this,arguments)};m.prototype=j(ax.prototype,{isIE8:n.indexOf("MSIE 8.0")>-1,init:function(A,p,R){this.box=N(a,null,{width:p+U,height:R+U},A);this.Element=E;if(!aH.namespaces.hcv){aH.namespaces.add("hcv","urn:schemas-microsoft-com:vml");aH.createStyleSheet().cssText="hcv\\:fill, hcv\\:path, hcv\\:textpath, hcv\\:shape, hcv\\:stroke, hcv\\:line { behavior:url(#default#VML); display: inline-block; } "}},clipRect:function(A,p,aa,S){var R=this.createElement();return ab(R,{members:[],element:{style:{left:A,top:p,width:aa,height:S}},getCSS:function(a6){var a5=R.element.style,a4=a5.top,a3=a5.left,ac=a3+a5.width;a5=a4+a5.height;return"rect("+(a6?a3:a4)+"px,"+(a6?a5:ac)+"px,"+(a6?ac:a5)+"px,"+(a6?a4:a3)+"px)"},updateClipping:function(){J(R.members,function(ac){ac.css({clip:R.getCSS(ac.inverted)})})}})},color:function(a7,a6,a5){var a4,a3=/^rgba/;if(a7&&a7.linearGradient){var ac,aa;a5=a7.linearGradient;var S,R,A,p;J(a7.stops,function(a8,a9){if(a3.test(a8[1])){a4=Q(a8[1]);ac=a4.get("rgb");aa=a4.get("a")}else{ac=a8[1];aa=1}if(a9){A=ac;p=aa}else{S=ac;R=aa}});a7=90-aI.atan((a5[3]-a5[1])/(a5[2]-a5[0]))*180/aI.PI;a7=['<fill colors="0% ',S,",100% ",A,'" angle="',a7,'" opacity="',p,'" o:opacity2="',R,'" type="gradient" focus="100%" />'];N(this.prepVML(a7),null,null,a6)}else{if(a3.test(a7)){a4=Q(a7);a7=["<",a5,' opacity="',a4.get("a"),'"/>'];N(this.prepVML(a7),null,null,a6);return a4.get("rgb")}else{return a7}}},prepVML:function(A){var p="display:inline-block;behavior:url(#default#VML);",R=this.isIE8;A=A.join("");if(R){A=A.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />');A=A.indexOf('style="')==-1?A.replace("/>",' style="'+p+'" />'):A.replace('style="','style="'+p)}else{A=A.replace("<","<hcv:")}return A},text:function(a7,a6,a5,a4,a3,ac){a4=a4||{};ac=ac||"left";a3=a3||0;var aa=aB(parseInt(a4.fontSize||12,10)*1.2),S=aN.chart.style;a6=aB(a6);a5=aB(a5);ab(a4,{color:a4.color||"#000000",whiteSpace:"nowrap",fontFamily:a4.fontFamily||S.fontFamily,fontSize:a4.fontSize||S.fontSize});if(a3){S=(a3||0)*aI.PI*2/360;a3=aG(S);S=an(S);var R=10;aa=aa*0.3;var A=ac=="left",p=ac=="right",a8=A?a6:a6-R*a3;a6=p?a6:a6+R*a3;A=A?a5:a5-R*S;a5=p?a5:a5+R*S;a8+=aa*S;a6+=aa*S;A-=aa*a3;a5-=aa*a3;if(aq(a8-a6)<0.1){a8+=0.1}if(aq(A-a5)<0.1){A+=0.1}a5=this.createElement("line").attr({from:a8+", "+A,to:a6+", "+a5});a3=a5.element;N("hcv:fill",{on:true,color:a4.color},null,a3);N("hcv:path",{textpathok:true},null,a3);N('<hcv:textpath style="v-text-align:'+ac+";"+O(a4).replace(/"/g,"'")+'" on="true" string="'+a7+'">',null,null,a3)}else{a5=this.createElement("span").attr({x:a6,y:a5-aa,text:a7});a3=a5.element;a3.lineHeight=aa;c(a3,a4);if(ac!="left"){a7=a5.getBBox().width;c(a3,{left:a6-a7/{right:1,center:2}[ac]+U})}}return a5},path:function(p){return this.createElement("shape").attr({coordsize:"100 100",d:p})},circle:function(A,p,R){return this.path(this.symbols.circle(A,p,R))},g:function(A){var p;if(A){p={className:B+A,"class":B+A}}return A=this.createElement(a).attr(p)},image:function(A,p,aa,S,R){return this.createElement("img").attr({src:A}).css({left:p,top:aa,width:S,height:R})},rect:function(A,p,a3,ac,aa,S){if(arguments.length>1){var R=(S||0)%2/2;A=aB(A||0)+R;p=aB(p||0)+R;a3=aB((a3||0)-2*R);ac=aB((ac||0)-2*R)}if(typeof A=="object"){p=A.y;a3=A.width;ac=A.height;aa=A.r;A=A.x}return this.symbol("rect",A||0,p||0,aa||0,{width:a3||0,height:ac||0})},symbol:function(A,p,S){var R;R=/^url\((.*?)\)$/;return R=R.test(A)?this.createElement("img").attr({onload:function(){var ac=this,aa=[ac.width,ac.height];c(ac,{left:aB(p-aa[0]/2),top:aB(S-aa[1]/2)})},src:A.match(R)[1]}):ax.prototype.symbol.apply(this,arguments)},symbols:{arc:function(a6,a5,a4,a3){var ac=a3.start,aa=a3.end,S=aa-ac==2*Math.PI?aa-0.001:aa,R=aG(ac),A=an(ac),p=aG(S);S=an(S);a3=a3.innerR;if(aa-ac===0){return["x"]}return["wa",a6-a4,a5-a4,a6+a4,a5+a4,a6+a4*R,a5+a4*A,a6+a4*p,a5+a4*S,"at",a6-a3,a5-a3,a6+a3,a5+a3,a6+a3*p,a5+a3*S,a6+a3*R,a5+a3*A,"x","e"]},circle:function(A,p,R){return["wa",A-R,p-R,A+R,p+R,A+R,p,A+R,p,"e"]},rect:function(A,p,a3,ac){var aa=ac.width;ac=ac.height;var S=A+aa,R=p+ac;a3=D(a3,aa,ac);return[az,A+a3,p,aX,S-a3,p,"wa",S-2*a3,p,S,p+2*a3,S-a3,p,S,p+a3,aX,S,R-a3,"wa",S-2*a3,R-2*a3,S,R,S,R-a3,S-a3,R,aX,A+a3,R,"wa",A,R-2*a3,A+2*a3,R,A+a3,R,A,R-a3,aX,A,p+a3,"wa",A,p,A+2*a3,p+2*a3,A,p+a3,A+a3,p,"x","e"]}}})}var am=I?ax:m,u=function(){};u.prototype={init:function(A,p){var R=this;R.series=A;R.applyOptions(p);R.pointAttr={};if(A.options.colorByPoint){A=aN.colors;if(!R.options){R.options={}}R.color=R.options.color=R.color||A[a1++];if(a1>=A.length){a1=0}}return R},applyOptions:function(A){var p=this,R=p.series;if(typeof A=="number"||A===null){p.y=A}else{if(typeof A=="object"&&typeof A.length!="number"){ab(p,A);p.options=A}else{if(typeof A[0]=="string"){p.name=A[0];p.y=A[1]}else{if(typeof A[0]=="number"){p.x=A[0];p.y=A[1]}}}}if(p.x===s){p.x=R.autoIncrement()}},destroy:function(){var A=this,p;A==A.series.chart.hoverPoint&&A.onMouseOut();aW(A);J(["dataLabel","graphic","tracker","group"],function(R){A[R]&&A[R].destroy()});A.legendItem&&A.series.chart.legend.destroyItem(A);for(p in A){A[p]=null}},select:function(A,p){var S=this,R=S.series;R=R.chart;S.selected=A=at(A,!S.selected);S.firePointEvent(A?"select":"unselect");S.setState(q);p||J(R.getSelectedPoints(),function(aa){if(aa.selected&&aa!=S){aa.selected=false;aa.setState(o);aa.firePointEvent("unselect")}})},onMouseOver:function(){var A=this,p=A.series.chart,S=p.tooltip,R=p.hoverPoint;R&&R!=A&&R.onMouseOut();A.firePointEvent("mouseOver");S&&S.refresh(A);A.setState(P);p.hoverPoint=A},onMouseOut:function(){var p=this;p.firePointEvent("mouseOut");p.setState(o);p.series.chart.hoverPoint=null},update:function(A,p){var S=this,R=S.series;p=at(p,true);S.firePointEvent("update",{options:A},function(){S.applyOptions(A);R.isDirty=true;p&&R.chart.redraw()})},remove:function(A){var p=this,ac=p.series,aa=ac.chart,S=ac.data,R=S.length;A=at(A,true);p.firePointEvent("remove",null,function(){for(;R--;){if(S[R]==p){S.splice(R,1);break}}p.destroy();ac.isDirty=true;A&&aa.redraw()})},firePointEvent:function(A,p,aa){var S=this,R=this.series;R=R.options;if(R.point.events[A]||S.options&&S.options.events&&S.options.events[A]){this.importEvents()}if(A=="click"&&R.allowPointSelect){aa=function(ac){S.select(null,ac.ctrlKey||ac.metaKey||ac.shiftKey)}}ay(this,A,p,aa)},importEvents:function(){if(!this.hasImportedEvents){var A=this,p=j(A.series.options.point,A.options);p=p.events;var R;A.events=p;for(R in p){z(A,R,p[R])}this.hasImportedEvents=true}},setState:function(a5){var a4=this,a3=a4.series,ac=a3.options.states,aa=a3.options.marker,S=aa&&!aa.enabled,R=(aa=aa&&aa.states[a5])&&aa.enabled===false,A=a3.chart,p=a4.pointAttr;a5||(a5=o);if(!(a4.selected&&a5!=q||ac[a5]&&ac[a5].enabled===false||a5&&(R||S&&!aa.enabled))){if(a5&&!a4.graphic){if(!a3.stateMarkerGraphic){a3.stateMarkerGraphic=A.renderer.circle(0,0,p[a5].r).attr(p[a5]).add(a3.group)}a3.stateMarkerGraphic.translate(a4.plotX,a4.plotY)}else{a4.graphic&&a4.graphic.attr(p[a5])}}},setTooltipText:function(){var p=this;p.tooltipText=p.series.chart.options.tooltip.formatter.call({series:p.series,point:p,x:p.category,y:p.y,percentage:p.percentage,total:p.total||p.stackTotal})}};var G=function(){};G.prototype={isCartesian:true,type:"line",pointClass:u,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},init:function(A,p){var aa=this,S,R=A.series.length;aa.chart=A;p=aa.setOptions(p);ab(aa,{index:R,options:p,name:p.name||"Series "+(R+1),state:o,pointAttr:{},visible:p.visible!==false,selected:p.selected===true});A=p.events;for(S in A){z(aa,S,A[S])}aa.getColor();aa.getSymbol();aa.setData(p.data,false)},autoIncrement:function(){var A=this,p=A.options,R=A.xIncrement;R=at(R,p.pointStart,0);A.pointInterval=at(A.pointInterval,p.pointInterval,1);A.xIncrement=R+A.pointInterval;return R},cleanData:function(){var A=this;A=A.data;var p;A.sort(function(S,R){return S.x-R.x});for(p=A.length-1;p>=0;p--){A[p-1]&&A[p-1].x==A[p].x&&A.splice(p-1,1)}},getSegments:function(){var A=-1,p=[],R=this.data;J(R,function(aa,S){if(aa.y===null){S>A+1&&p.push(R.slice(A+1,S));A=S}else{S==R.length-1&&p.push(R.slice(A+1,S+1))}});this.segments=p},setOptions:function(A){var p=this.chart.options.plotOptions;return A=j(p[this.type],p.series,A)},getColor:function(){var p=this.chart.options.colors;this.color=this.options.color||p[a1++]||"#0000ff";if(a1>=p.length){a1=0}},getSymbol:function(){var A=this.chart.options.symbols,p=this.options.marker.symbol||A[g++];this.symbol=p;if(g>=A.length){g=0}},addPoint:function(A,p,aa){var S=this,R=S.data;A=(new S.pointClass).init(S,A);p=at(p,true);R.push(A);aa&&R[0].remove(false);S.isDirty=true;p&&S.chart.redraw()},setData:function(A,p){var ac=this,aa=ac.data,S=ac.initialColor,R=aa&&aa.length||0;ac.xIncrement=null;if(Y(S)){a1=S}for(A=M(ak(A||[]),function(a3){return(new ac.pointClass).init(ac,a3)});R--;){aa[R].destroy()}ac.data=A;ac.cleanData();ac.getSegments();ac.isDirty=true;at(p,true)&&ac.chart.redraw()},remove:function(A){var p=this,R=p.chart;A=at(A,true);if(!p.isRemoving){p.isRemoving=true;ay(p,"remove",null,function(){p.destroy();R.isDirty=true;A&&R.redraw()})}p.isRemoving=false},translate:function(){for(var a7=this,a6=a7.chart,a5=a7.options.stacking,a4=a7.xAxis.categories,a3=a7.yAxis,ac=a3.stacks[a7.type],aa=a7.data,S=aa.length;S--;){var R=aa[S],A=R.x,p=R.y,a8;R.plotX=a7.xAxis.translate(A);if(a5&&a7.visible&&ac[A]){a8=ac[A];A=a8.total;a8.cum=a8=a8.cum-p;p=a8+p;if(a5=="percent"){a8=A?a8*100/A:0;p=A?p*100/A:0}R.percentage=A?R.y*100/A:0;R.stackTotal=A;R.yBottom=a3.translate(a8,0,1)}if(p!==null){R.plotY=a3.translate(p,0,1)}R.clientX=a6.inverted?a6.plotHeight-R.plotX:R.plotX;R.category=a4&&a4[R.x]!==s?a4[R.x]:R.x}},setTooltipPoints:function(a5){var a4=this,a3=a4.chart,ac=a3.inverted,aa=[],S=(ac?a3.plotTop:a3.plotLeft)+a3.plotSizeX,R,A,p=[];if(a5){a4.tooltipPoints=null}J(a4.segments,function(a6){aa=aa.concat(a6)});if(a4.xAxis&&a4.xAxis.reversed){aa=aa.reverse()}J(aa,function(a6,a7){a4.tooltipPoints||a6.setTooltipText();R=aa[a7-1]?aa[a7-1].high+1:0;for(A=a6.high=aa[a7+1]?ah((a6.plotX+(aa[a7+1]?aa[a7+1].plotX:S))/2):S;R<=A;){p[ac?S-R++:R++]=a6}});a4.tooltipPoints=p},onMouseOver:function(){var A=this,p=A.chart,S=p.hoverSeries,R=A.stateMarkerGraphic;if(!p.mouseIsDown){R&&R.show();S&&S!=A&&S.onMouseOut();A.options.events.mouseOver&&ay(A,"mouseOver");A.tracker&&A.tracker.toFront();A.setState(P);p.hoverSeries=A}},onMouseOut:function(){var A=this,p=A.options,aa=A.chart,S=aa.tooltip,R=aa.hoverPoint;R&&R.onMouseOut();A&&p.events.mouseOut&&ay(A,"mouseOut");S&&!p.stickyTracking&&S.hide();A.setState();aa.hoverSeries=null},animate:function(A){var p=this,S=p.chart,R=p.clipRect;if(A){if(!R.isAnimating){R.attr("width",0);R.isAnimating=true}}else{R.animate({width:S.plotSizeX},{complete:function(){R.isAnimating=false},duration:1000});this.animate=null}},drawPoints:function(){var a6=this,a5,a4=a6.data,a3=a6.chart,ac,aa,S,R,A,p;if(a6.options.marker.enabled){for(S=a4.length;S--;){R=a4[S];ac=R.plotX;aa=R.plotY;p=R.graphic;if(R.plotY!==s){a5=R.pointAttr[R.selected?q:o];A=a5.r;if(p){p.attr({x:ac,y:aa,r:A})}else{R.graphic=a3.renderer.symbol(at(R.marker&&R.marker.symbol,a6.symbol),ac,aa,A).attr(a5).add(a6.group)}}}}},convertAttribs:function(A,p,a4,a3){var ac=this.pointAttrToOptions,aa,S,R={};A=A||{};p=p||{};a4=a4||{};a3=a3||{};for(aa in ac){S=ac[aa];R[aa]=at(A[S],p[aa],a4[aa],a3[aa])}return R},getAttribs:function(){var a7=this,a6=a7.options.marker||a7.options,a5=a6.states,a4=a5[P],a3,ac={},aa=a7.color,S=a7.data,R=[],A,p=a7.pointAttrToOptions;if(a7.options.marker){ac={stroke:aa,fill:aa};a4.radius=a4.radius||a6.radius+2;a4.lineWidth=a4.lineWidth||a6.lineWidth+1}else{ac={fill:aa};a4.color=a4.color||Q(a4.color||aa).brighten(a4.brightness).get()}R[o]=a7.convertAttribs(a6,ac);J([P,q],function(a9){R[a9]=a7.convertAttribs(a5[a9],R[o])});a7.pointAttr=R;for(ac=S.length;ac--;){aa=S[ac];a6=aa.options&&aa.options.marker||aa.options;a3=false;if(aa.options){for(var a8 in p){if(a6[p[a8]]){a3=true}}}if(a3){A=[];a5=a6.states||{};a3=a5[P]=a5[P]||{};if(!a7.options.marker){a3.color=Q(a3.color||aa.options.color).brighten(a3.brightness||a4.brightness).get()}A[o]=a7.convertAttribs(a6,R[o]);A[P]=a7.convertAttribs(a5[P],R[P],A[o]);A[q]=a7.convertAttribs(a5[q],R[q],A[o])}else{A=R}aa.pointAttr=A}},destroy:function(){var A=this,p=A.chart,aa=p.series,S=A.clipRect,R;aW(A);A.legendItem&&A.chart.legend.destroyItem(A);J(A.data,function(ac){ac.destroy()});J(["area","graph","dataLabelsGroup","group","tracker"],function(ac){A[ac]&&A[ac].destroy()});S&&S!=A.chart.clipRect&&S.destroy();if(p.hoverSeries==A){p.hoverSeries=null}J(aa,function(a3,ac){a3==A&&aa.splice(ac,1)});for(R in A){delete A[R]}},drawDataLabels:function(){if(this.options.dataLabels.enabled){var a7=this,a6,a5,a4=a7.data,a3=a7.options.dataLabels,ac,aa=a7.dataLabelsGroup,S=a7.chart,R=S.inverted,A=a7.type,p,a8;if(!aa){aa=a7.dataLabelsGroup=S.renderer.g(B+"data-labels").attr({visibility:a7.visible?H:k,zIndex:4}).translate(S.plotLeft,S.plotTop).add()}p=a3.color;if(p=="auto"){p=null}a3.style.color=at(p,a7.color);J(a4,function(bd){var bc=at(bd.barX,bd.plotX),a9=bd.plotY,bb=bd.tooltipPos,ba=bd.dataLabel;if(ba){bd.dataLabel=ba.destroy()}ac=a3.formatter.call({x:bd.x,y:bd.y,series:a7,point:bd,percentage:bd.percentage,total:bd.total||bd.stackTotal});a6=(R?S.plotWidth-a9:bc)+a3.x;a5=(R?S.plotHeight-bc:a9)+a3.y;if(bb){a6=bb[0]+a3.x;a5=bb[1]+a3.y}a8=a3.align;if(A=="column"){a6+={center:bd.barW/2,right:bd.barW}[a8]||0}if(ac){bd.dataLabel=S.renderer.text(ac,a6,a5,a3.style,a3.rotation,a8).attr({zIndex:1}).add(aa)}a7.drawConnector&&a7.drawConnector(bd)})}},drawGraph:function(){var a8=this,a7=a8.options,a5=a8.chart,a4=a8.graph,a3=[],ac=a8.area,aa=a8.group,S=a7.lineColor||a8.color,R=a7.lineWidth,A;a5=a5.renderer;var p=a8.yAxis.getThreshold(a7.threshold||0),a9=/^area/.test(a8.type),a6=[];J(a8.segments,function(bd){if(bd.length>0){A=[];J(bd,function(bf,be){be<2&&A.push([az,aX][be]);if(be&&a7.step){be=bd[be-1];A.push(bf.plotX,be.plotY)}A.push(bf.plotX,bf.plotY)});a3=a3.concat(A);if(a9&&bd.length>1){var ba=[],bc,bb=A.length;for(bc=0;bc<bb;bc++){ba.push(A[bc])}if(a7.stacking&&a8.type!="areaspline"){for(bc=bd.length-1;bc>=0;bc--){ba.push(bd[bc].plotX,bd[bc].yBottom)}}else{ba.push(bd[bd.length-1].plotX,p,bd[0].plotX,p,"z")}a6=a6.concat(ba)}}});a8.graphPath=a3;if(a4){a4.attr({d:a3})}else{if(R){a8.graph=a5.path(a3).attr({stroke:S,"stroke-width":R+U}).add(aa).shadow(a7.shadow)}}if(a9){a4=at(a7.fillColor,Q(a8.color).setOpacity(a7.fillOpacity||0.75).get());if(ac){ac.attr({d:a6})}else{a8.area=a8.chart.renderer.path(a6).attr({fill:a4}).add(a8.group)}}},render:function(){var A=this,p=A.chart,S,R=A.options.animation&&A.animate;S=p.renderer;if(!A.clipRect){A.clipRect=!p.hasRendered&&p.clipRect?p.clipRect:S.clipRect(0,0,p.plotSizeX,p.plotSizeY);if(!p.clipRect){p.clipRect=A.clipRect}}if(!A.group){S=A.group=S.g("series");p.inverted&&S.attr({width:p.plotWidth,height:p.plotHeight}).invert();S.clip(A.clipRect).attr({visibility:A.visible?H:k,zIndex:3}).translate(p.plotLeft,p.plotTop).add()}A.drawDataLabels();R&&A.animate(true);A.getAttribs();A.drawGraph&&A.drawGraph();A.drawPoints();A.options.enableMouseTracking!==false&&A.drawTracker();R&&A.animate();A.isDirty=false},redraw:function(){var p=this;p.translate();p.setTooltipPoints(true);p.render()},setState:function(A){var p=this,ac=p.options,aa=p.graph,S=ac.states,R=p.stateMarkerGraphic;ac=ac.lineWidth;A=A||o;if(p.state!=A){p.state=A;if(!(S[A]&&S[A].enabled===false)){if(A){ac=S[A].lineWidth||ac}else{R&&R.hide()}if(aa){aa.animate({"stroke-width":ac},A?0:500)}}}},setVisible:function(a7,a6){var a5=this,a4=a5.chart,a3=a5.legendItem,ac=a5.group,aa=a5.tracker,S=a5.dataLabelsGroup,R,A=a5.data,p=a4.options.chart.ignoreHiddenSeries;R=a5.visible;R=(a5.visible=a7=a7===s?!R:a7)?"show":"hide";if(a7){a5.isDirty=p}ac&&ac[R]();if(aa){aa[R]()}else{for(ac=A.length;ac--;){aa=A[ac];aa.tracker&&aa.tracker[R]()}}S&&S[R]();a3&&a4.legend.colorizeItem(a5,a7);p&&a5.options.stacking&&J(a4.series,function(a8){if(a8.options.stacking&&a8.visible){a8.isDirty=true}});a6!==false&&a4.redraw();ay(a5,R)},show:function(){this.setVisible(true)},hide:function(){this.setVisible(false)},select:function(A){var p=this;p.selected=A=A===s?!p.selected:A;if(p.checkbox){p.checkbox.checked=A}ay(p,A?"select":"unselect")},drawTracker:function(){var A=this,p=A.options,a4=A.graphPath,a3=A.chart,ac=a3.options.tooltip.snap,aa=A.tracker,S=p.cursor;S=S&&{cursor:S};var R;for(R=0;R<a4.length;R++){if(a4[R]==az&&a4[R+3]==az){a4[R+1]-=2;a4.splice(R+3,0,aX,a4[R+1]+4,a4[R+2])}}if(aa){aa.attr({d:a4})}else{A.tracker=a3.renderer.path(a4).attr({isTracker:true,stroke:v,fill:f,"stroke-width":p.lineWidth+2*ac,"stroke-linecap":"round",visibility:A.visible?H:k,zIndex:1}).on("mouseover",function(){a3.hoverSeries!=A&&A.onMouseOver()}).on("mouseout",function(){p.stickyTracking||A.onMouseOut()}).css(S).add(a3.trackerGroup)}}};n=aT(G);x.line=n;n=aT(G,{type:"area"});x.area=n;Z.prototype={get:function(A){A||(A=50);var p=this.n;p=(this.xdata[p-1]-this.xdata[0])/(A-1);var ac=[],aa=[];ac[0]=this.xdata[0];aa[0]=this.ydata[0];for(var S=[{plotX:ac[0],plotY:aa[0]}],R=1;R<A;R++){ac[R]=ac[0]+R*p;aa[R]=this.interpolate(ac[R]);S[R]={plotX:ac[R],plotY:aa[R]}}return S},interpolate:function(A){for(var p=this.n-1,aa=0;p-aa>1;){var S=(p+aa)/2;if(this.xdata[ah(S)]>A){p=S}else{aa=S}}p=ah(p);aa=ah(aa);S=this.xdata[p]-this.xdata[aa];var R=(this.xdata[p]-A)/S;A=(A-this.xdata[aa])/S;return R*this.ydata[aa]+A*this.ydata[p]+((R*R*R-R)*this.y2[aa]+(A*A*A-A)*this.y2[p])*S*S/6}};n=aT(G,{type:"spline",drawGraph:function(){var A=this,p=A.segments;A.splinedata=A.getSplineData();A.segments=A.splinedata;G.prototype.drawGraph.apply(A,arguments);A.segments=p},getSplineData:function(){var A=this,p=A.chart,S=[],R;J(A.segments,function(a4){if(A.xAxis.reversed){a4=a4.reverse()}var a3=[],ac,aa;J(a4,function(a6,a5){ac=a4[a5+2]||a4[a5+1]||a6;aa=a4[a5-2]||a4[a5-1]||a6;ac.plotX>=0&&aa.plotX<=p.plotWidth&&a3.push(a6)});if(a3.length>1){R=aB(aM(p.plotWidth,a3[a3.length-1].clientX-a3[0].clientX)/3)}S.push(a4.length>1?R?(new Z(a3)).get(R):[]:a4)});return S}});x.spline=n;n=aT(n,{type:"areaspline"});x.areaspline=n;var aF=aT(G,{type:"column",pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color",r:"borderRadius"},init:function(){G.prototype.init.apply(this,arguments);var A=this,p=A.chart;p.hasRendered&&J(p.series,function(R){if(R.type==A.type){R.isDirty=true}})},translate:function(){var a9=this,a8=a9.chart,a6=0,a5=a9.xAxis.reversed,a4=a9.xAxis.categories,a3;G.prototype.translate.apply(a9);J(a8.series,function(bc){if(bc.type==a9.type){if(bc.options.stacking){Y(a3)||(a3=a6++);bc.columnIndex=a3}else{bc.columnIndex=a6++}}});var ac=a9.options,aa=a9.data,S=a9.closestPoints;a8=aq(aa[1]?aa[S].plotX-aa[S-1].plotX:a8.plotSizeX/(a4?a4.length:1));a4=a8*ac.groupPadding;S=a8-2*a4;S=S/a6;var R=ac.pointWidth,A=Y(R)?(S-R)/2:S*ac.pointPadding,bb=at(R,S-2*A);R=(a5?a6-a9.columnIndex:a9.columnIndex)||0;var a7=A+(a4+R*S-a8/2)*(a5?-1:1),p=a9.yAxis.getThreshold(ac.threshold||0),ba=ac.minPointLength;J(aa,function(bg){var bc=bg.plotY,bi=bg.plotX+a7,bh=D(bc,p),bf=bb,be=aq((bg.yBottom||p)-bc),bd;if(aq(be)<(ba||5)){if(ba){be=ba;bh=p-(bc<=p?ba:0)}bd=bh-3}ab(bg,{barX:bi,barY:bh,barW:bf,barH:be});bg.shapeType="rect";bg.shapeArgs={x:bi,y:bh,width:bf,height:be,r:ac.borderRadius};if(Y(bd)){bg.trackerArgs=j(bg.shapeArgs,{height:6,y:bd})}})},getSymbol:function(){},drawGraph:function(){},drawPoints:function(){var A=this,p=A.options,aa=A.chart.renderer,S,R;J(A.data,function(ac){if(Y(ac.plotY)){S=ac.graphic;R=ac.shapeArgs;if(S){S.attr(R)}else{ac.graphic=aa[ac.shapeType](R).attr(ac.pointAttr[ac.selected?q:o]).add(A.group).shadow(p.shadow)}}})},drawTracker:function(){var a5=this,a4=a5.chart,a3=a4.renderer,ac,aa,S=+new Date,R=a5.options.cursor,A=R&&{cursor:R},p;J(a5.data,function(a6){aa=a6.tracker;ac=a6.trackerArgs||a6.shapeArgs;if(aa){aa.attr(ac)}else{a6.tracker=a3[a6.shapeType](ac).attr({isTracker:S,fill:v,visibility:a5.visible?H:k,zIndex:1}).on("mouseover",function(a7){p=a7.relatedTarget||a7.fromElement;a4.hoverSeries!=a5&&T(p,"isTracker")!=S&&a5.onMouseOver();a6.onMouseOver()}).on("mouseout",function(a7){if(!a5.options.stickyTracking){p=a7.relatedTarget||a7.toElement;T(p,"isTracker")!=S&&a5.onMouseOut()}}).css(A).add(a4.trackerGroup)}})},cleanData:function(){var A=this,p=A.data,ac,aa,S,R;G.prototype.cleanData.apply(A);for(R=p.length-1;R>=0;R--){if(p[R-1]){ac=p[R].x-p[R-1].x;if(aa===s||ac<aa){aa=ac;S=R}}}A.closestPoints=S},animate:function(A){var p=this,R=p.data;if(!A){J(R,function(aa){var S=aa.graphic;if(S){S.attr({height:0,y:p.yAxis.translate(0,0,1)});S.animate({height:aa.barH,y:aa.barY},{duration:1000})}});p.animate=null}},remove:function(){var A=this,p=A.chart;p.hasRendered&&J(p.series,function(R){if(R.type==A.type){R.isDirty=true}});G.prototype.remove.apply(A,arguments)}});x.column=aF;n=aT(aF,{type:"bar",init:function(p){p.inverted=this.inverted=true;aF.prototype.init.apply(this,arguments)}});x.bar=n;n=aT(G,{type:"scatter",translate:function(){var p=this;G.prototype.translate.apply(p);J(p.data,function(A){A.shapeType="circle";A.shapeArgs={x:A.plotX,y:A.plotY,r:p.chart.options.tooltip.snap}})},drawTracker:function(){var A=this,p=A.options.cursor,S=p&&{cursor:p},R;J(A.data,function(aa){(R=aa.graphic)&&R.attr({isTracker:true}).on("mouseover",function(){A.onMouseOver();aa.onMouseOver()}).on("mouseout",function(){A.options.stickyTracking||A.onMouseOut()}).css(S)})},cleanData:function(){}});x.scatter=n;n=aT(u,{init:function(){u.prototype.init.apply(this,arguments);var A=this,p;ab(A,{visible:A.visible!==false,name:at(A.name,"Slice")});p=function(){A.slice()};z(A,"select",p);z(A,"unselect",p);return A},setVisible:function(A){var p=this,R=p.series.chart;if(p.visible=A=A===s?!p.visible:A){p.group.show();p.tracker.show()}else{p.group.hide();p.tracker.hide()}p.legendItem&&R.legend.colorizeItem(p,A)},slice:function(A,p){var aa=this,S=aa.series;S=S.chart;var R=aa.slicedTranslation;at(p,true);A=aa.sliced=Y(A)?A:!aa.sliced;aa.group.animate({translateX:A?R[0]:S.plotLeft,translateY:A?R[1]:S.plotTop},100)}});n=aT(G,{type:"pie",isCartesian:false,pointClass:n,pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},getColor:function(){this.initialColor=a1},translate:function(){var ba=0,a9=this,a7=-0.25,a6=a9.options,a5=a6.slicedOffset,a4=a6.center,a3=a9.chart,aa=a3.plotWidth,S=a3.plotHeight,R,A,bc;a9=a9.data;var a8=2*aI.PI,p,bb=D(aa,S),ac;a4.push(a6.size,a6.innerSize||0);a4=M(a4,function(bd,be){return(ac=/%$/.test(bd))?[aa,S,bb,bb][be]*parseInt(bd,10)/100:bd});J(a9,function(bd){ba+=bd.y});J(a9,function(bd){p=ba?bd.y/ba:0;R=a7*a8;a7+=p;A=a7*a8;bd.shapeType="arc";bd.shapeArgs={x:a4[0],y:a4[1],r:a4[2]/2,innerR:a4[3]/2,start:R,end:A};bc=(A+R)/2;bd.slicedTranslation=M([aG(bc)*a5+a3.plotLeft,an(bc)*a5+a3.plotTop],aB);bd.tooltipPos=[a4[0]+aG(bc)*a4[2]*0.35,a4[1]+an(bc)*a4[2]*0.35];bd.percentage=p*100;bd.total=ba});this.setTooltipPoints()},render:function(){var p=this;p.getAttribs();this.drawPoints();p.options.enableMouseTracking!==false&&p.drawTracker();this.drawDataLabels();p.isDirty=false},drawPoints:function(){var A=this,p=A.chart,ac=p.renderer,aa,S,R;J(A.data,function(a3){S=a3.graphic;R=a3.shapeArgs;if(!a3.group){aa=a3.sliced?a3.slicedTranslation:[p.plotLeft,p.plotTop];a3.group=ac.g("point").attr({zIndex:3}).add().translate(aa[0],aa[1])}if(S){S.attr(R)}else{a3.graphic=ac.arc(R).attr(a3.pointAttr[o]).add(a3.group)}a3.visible===false&&a3.setVisible(false)})},drawTracker:aF.prototype.drawTracker,getSymbol:function(){}});x.pie=n;h.Highcharts={Chart:L,dateFormat:ag,getOptions:aS,numberFormat:aC,Point:u,Renderer:am,seriesTypes:x,setOptions:e,Series:G,addEvent:z,createElement:N,discardElement:ad,css:c,each:J,extend:ab,map:M,merge:j,pick:at,extendClass:aT}})();Ext.ux.HighChart=Ext.extend(Ext.BoxComponent,{defaultSerieType:null,resizable:true,updateDelay:0,loadMask:true,addSeries:function(e,a){a=(a==null)?true:false;var j=new Array(),h=new Array(),b,g;for(var d=0;d<e.length;d++){var f=e[d];if(!f.serieCls){if(f.type!=null||this.defaultSerieType!=null){b=Ext.ux.HighChart.Series.get(f.type!=null?f.type:this.defaultSerieType)}else{b=Ext.ux.HighChart.Serie}g=new b(f)}else{g=f}h.push(g.config);j.push(g)}if(this.chart){if(!a){this.removeAllSeries();this.series=j;this.chartConfig.series=h}else{this.chartConfig.series=this.chartConfig.series?this.chartConfig.series.concat(h):h;this.series=this.series?this.series.concat(j):j}for(var d=0;d<h.length;d++){this.chart.addSeries(h[d],true)}this.refresh()}else{if(a){this.chartConfig.series=this.chartConfig.series?this.chartConfig.series.concat(h):h;this.series=this.series?this.series.concat(j):j}else{this.chartConfig.series=h;this.series=j}}},removeSerie:function(b,a){a=a||true;if(this.chart){this.chart.series[b].remove(a);this.chartConfig.series.splice(b,1)}this.series.splice(b,1)},removeAllSeries:function(){var b=this.chartConfig.series.length;for(var a=0;a<b;a++){this.removeSerie(0)}},setTitle:function(a){if(this.chartConfig.title){this.chartConfig.title.text=a}else{this.chartConfig.title={text:a}}if(this.chart&&this.chart.titleLayer){this.chart.titleLayer.div.firstChild.innerHTML=a}},setSubTitle:function(a){if(this.chartConfig.subtitle){this.chartConfig.subtitle.text=a}else{this.chartConfig.subtitle={text:a}}if(this.chart&&this.chart.titleLayer){this.chart.titleLayer.div.lastChild.innerHTML=a}},initComponent:function(){if(this.store){this.store=Ext.StoreMgr.lookup(this.store)}Ext.ux.HighChart.superclass.initComponent.call(this)},initEvents:function(){if(this.loadMask){this.loadMask=new Ext.LoadMask(this.el,Ext.apply({store:this.store},this.loadMask))}},afterRender:function(){if(this.store){this.bindStore(this.store,true)}Ext.ux.HighChart.superclass.afterRender.call(this);this.bindComponent(true);Ext.applyIf(this.chartConfig.chart,{renderTo:this.el.dom,events:{load:function(){}}});Ext.applyIf(this.chartConfig,{xAxis:[{}]});if(this.xField&&this.store){this.updatexAxisData()}if(this.series){this.addSeries(this.series,false)}else{this.series=[]}this.initEvents();this.update(500)},onMove:function(){},draw:function(){if(this.chart&&this.rendered){if(this.resizable){for(var a=0;a<this.series.length;a++){this.series[a].visible=this.chart.series[a].visible}this.chart.destroy();delete this.chart;this.chart=new Highcharts.Chart(this.chartConfig)}}else{if(this.rendered){this.chart=new Highcharts.Chart(this.chartConfig)}}for(a=0;a<this.series.length;a++){if(!this.series[a].visible){this.chart.series[a].hide()}}this.refresh()},onContainerResize:function(){this.draw()},updatexAxisData:function(){var c=[],a=this.store.data.items;if(this.xField&&this.store){for(var b=0;b<a.length;b++){c.push(a[b].data[this.xField])}if(this.chart){this.chart.xAxis[0].setCategories(c,true)}else{this.chartConfig.xAxis[0].categories=c}}},bindComponent:function(c){var b=function(d){if(d.ownerCt){return b(d.ownerCt)}else{return d}};var a=b(this);if(c){a.on("move",this.onMove,this);if(this.ownerCt){this.ownerCt.on("render",this.update,this)}}else{if(this.ownerCt){this.ownerCt.un("render",this.update,this)}a.un("move",this.onMove,this)}},bindStore:function(a,b){if(!b&&this.store){if(a!==this.store&&this.store.autoDestroy){this.store.destroy()}else{this.store.un("datachanged",this.onDataChange,this);this.store.un("load",this.onLoad,this);this.store.un("add",this.onAdd,this);this.store.un("remove",this.onRemove,this);this.store.un("update",this.onUpdate,this);this.store.un("clear",this.onClear,this)}}if(a){a=Ext.StoreMgr.lookup(a);a.on({scope:this,load:this.onLoad,datachanged:this.onDataChange,add:this.onAdd,remove:this.onRemove,update:this.onUpdate,clear:this.onClear})}this.store=a;if(a&&!b){this.refresh()}},refresh:function(){if(this.store&&this.chart){var b=new Array(),a=this.chart.series.length,c;for(c=0;c<a;c++){b.push(new Array())}var f=this.store.data.items;var g=[];for(var h=0;h<f.length;h++){var d=f[h];if(this.xField){g.push(d.data[this.xField])}for(c=0;c<a;c++){var e=this.series[c],j;if((e.type=="pie"&&e.useTotals)){if(h==0){e.clear()}j=e.getData(d,h)}else{j=e.getData(d,h);b[c].push(j)}}}for(c=0;c<a;c++){if(this.series[c].useTotals){this.chart.series[c].setData(this.series[c].getTotals())}else{if(b[c].length>0){this.chart.series[c].setData(b[c],true)}}}if(this.xField){this.updatexAxisData()}}},refreshRow:function(b){var c=this.store.indexOf(b);if(this.chart){for(var d=0;d<this.chart.series.length;d++){var e=this.chart.series[d];var a=this.series[d].getData(b,c);if(this.series[d].type=="pie"&&this.series[d].useTotals){this.series[d].update(b);this.chart.series[d].setData(this.series[d].getTotals())}else{e.data[c].update(a)}}if(this.xField){this.updatexAxisData()}}},update:function(a){var b=a||this.updateDelay;if(!this.updateTask){this.updateTask=new Ext.util.DelayedTask(this.draw,this)}this.updateTask.delay(b)},onDataChange:function(){this.refresh()},onClear:function(){this.refresh()},onUpdate:function(b,a){this.refreshRow(a)},onAdd:function(a,b,f){var k=false,g=[];for(var c=0;c<b.length;c++){var d=b[c];if(c==b.length-1){k=true}if(this.xField){g.push(d.data[this.xField])}for(var h=0;h<this.chart.series.length;h++){var e=this.chart.series[h],l=this.series[h];var j=l.getData(d,f+c);if(!(l.type=="pie"&&l.useTotals)){e.addPoint(j,k)}}}if(this.xField){this.chart.xAxis[0].setCategories(g,true)}},onResize:function(){Ext.ux.HighChart.superclass.onResize.call(this);this.update()},onRemove:function(f,a,b,e){for(var c=0;c<this.series.length;c++){var d=this.series[c];if(d.type=="pie"&&d.useTotals){d.removeData(a,b);this.chart.series[c].setData(d.getTotals())}else{this.chart.series[c].data[b].remove(true)}}Ext.each(this.chart.series,function(g){g.data[b].remove(true)});if(this.xField){this.updatexAxisData()}},onLoad:function(){this.refresh()},destroy:function(){delete this.series;if(this.chart){this.chart.destroy();delete this.chart}this.bindStore(null);this.bindComponent(null);Ext.ux.HighChart.superclass.destroy.call(this)}});Ext.reg("highchart",Ext.ux.HighChart);Ext.ux.HighChart.Series=function(){var b=new Array(),a=new Array();return{reg:function(d,c){b.push(c);a.push(d)},get:function(c){return b[a.indexOf(c)]}}}();Ext.ux.HighChart.Serie=function(a){a.type=this.type;if(!a.data){a.data=[]}Ext.apply(this,a);this.config=a};Ext.ux.HighChart.Serie.prototype={type:null,xField:null,yField:null,visible:true,clear:Ext.emptyFn,getData:function(b,c){var d=this.yField||this.dataIndex,e=this.xField,a={data:b.data,y:b.data[d]};if(e){a.x=b.data[e]}return a},serieCls:true};Ext.ux.HighChart.SplineSerie=Ext.extend(Ext.ux.HighChart.Serie,{type:"spline"});Ext.ux.HighChart.Series.reg("spline",Ext.ux.HighChart.SplineSerie);Ext.ux.HighChart.ColumnSerie=Ext.extend(Ext.ux.HighChart.Serie,{type:"column"});Ext.ux.HighChart.Series.reg("column",Ext.ux.HighChart.ColumnSerie);Ext.ux.HighChart.BarSerie=Ext.extend(Ext.ux.HighChart.Serie,{type:"bar"});Ext.ux.HighChart.Series.reg("bar",Ext.ux.HighChart.BarSerie);Ext.ux.HighChart.LineSerie=Ext.extend(Ext.ux.HighChart.Serie,{type:"line"});Ext.ux.HighChart.Series.reg("line",Ext.ux.HighChart.LineSerie);Ext.ux.HighChart.AreaSerie=Ext.extend(Ext.ux.HighChart.Serie,{type:"area"});Ext.ux.HighChart.Series.reg("area",Ext.ux.HighChart.AreaSerie);Ext.ux.HighChart.AreaSplineSerie=Ext.extend(Ext.ux.HighChart.Serie,{type:"areaspline"});Ext.ux.HighChart.Series.reg("areaspline",Ext.ux.HighChart.AreaSplineSerie);Ext.ux.HighChart.ScatterSerie=Ext.extend(Ext.ux.HighChart.Serie,{type:"scatter"});Ext.ux.HighChart.Series.reg("scatter",Ext.ux.HighChart.ScatterSerie);Ext.ux.HighChart.PieSerie=Ext.extend(Ext.ux.HighChart.Serie,{type:"pie",categorieField:null,dataField:null,useTotals:false,columns:[],constructor:function(a){Ext.ux.HighChart.PieSerie.superclass.constructor.apply(this,arguments);if(this.useTotals){this.columnData={};var c=this.columns.length;for(var b=0;b<c;b++){this.columnData[this.columns[b]]=100/c}}},addData:function(a){for(var b=0;b<this.columns.length;b++){var d=this.columns[b];this.columnData[d]=this.columnData[d]+a.data[d]}},update:function(a){for(var b=0;b<this.columns.length;b++){var d=this.columns[b];if(a.modified[d]){this.columnData[d]=this.columnData[d]+a.data[d]-a.modified[d]}}},removeData:function(a,b){for(var d=0;d<this.columns.length;d++){var e=this.columns[d];this.columnData[e]=this.columnData[e]-a.data[e]}},clear:function(){for(var a=0;a<this.columns.length;a++){var b=this.columns[a];this.columnData[b]=0}},getData:function(a,b){if(this.useTotals){this.addData(a);return[]}return[a.data[this.categorieField],a.data[this.dataField]]},getTotals:function(){var b=new Array();for(var d=0;d<this.columns.length;d++){var e=this.columns[d];b.push([e,this.columnData[e]])}return b}});Ext.ux.HighChart.Series.reg("pie",Ext.ux.HighChart.PieSerie);if(top.TC&&top.TC.notifyScriptLoaded){top.TC.notifyScriptLoaded("HighCharts-ExtJsControl.js",document)}Ext.ns("cacti.plugin.camm");cacti.plugin.camm.def_grid=Ext.extend(Ext.grid.GridPanel,{initComponent:function(){var b=this.tbar||[];var a=this.plugins||[];Ext.apply(this,{viewConfig:{forceFit:true},layout:"fit",stripeRows:true,plugins:a.concat([new Ext.ux.grid.AutoSizeColumns]),loadMask:true,tbar:b.concat([{text:"Export to Excel...",iconCls:"excel_export",listeners:{click:{scope:this,fn:function(){document.location="data:application/vnd.ms-excel;base64,"+Base64.encode(this.getExcelXml())}}}},{text:"Clear Chart filter",iconCls:"icon-clear-filter",id:"id_menu_cl_flt",scope:this,hidden:true,listeners:{click:{scope:this,fn:function(){delete this.store.baseParams.filter_chart;delete this.store.baseParams.rule_id;this.store.load({params:{start:0}})}}}}])});this.bbar=new Ext.PagingToolbar({plugins:[(new Ext.ux.Andrie.AutoRefresher),(new Ext.ux.Andrie.pPageSize({beforeText:"Rows:",afterText:""}))],pageSize:50,store:this.store,stateful:true,displayInfo:true,displayMsg:"Show {0} - {1} of {2} for {3}sec ({4}ms/row)",emptyMsg:"No rows to display"});cacti.plugin.camm.def_grid.superclass.initComponent.apply(this,arguments)},onRender:function(){this.store.on({scope:this,beforeload:function(){this.store.start_time=new Date();Ext.apply(this.store.baseParams,{limit:this.bottomToolbar.pageSize})},load:function(){var a=this.topToolbar.items.find(function(b){return b.id=="id_menu_cl_flt"});if(a){if((!Ext.ux.Utility.isNullOrUndefined(this.store.baseParams.filter_chart))&&(this.store.baseParams.filter_chart!="")){a.show()}else{a.hide()}}},exception:cacti.plugin.camm.loadexception});cacti.plugin.camm.def_grid.superclass.onRender.apply(this,arguments)}});Ext.reg("camm_def_grid",cacti.plugin.camm.def_grid);Ext.ns("cacti.plugin.camm");cacti.plugin.camm.testtrapstab_grid=Ext.extend(cacti.plugin.camm.def_grid,{initComponent:function(){this.selmod=new Ext.grid.RowSelectionModel();Ext.apply(this,{store:new Ext.data.Store({id:"testTrpDataStore",proxy:new Ext.data.HttpProxy({url:"camm_db_admin.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"results",totalProperty:"total",id:"id"},[{name:"id",type:"int",mapping:"id"},{name:"description",type:"string",mapping:"description"},{name:"eventname",type:"string",mapping:"eventname"},{name:"eventid",type:"string",mapping:"eventid"},{name:"trapoid",type:"string",mapping:"trapoid"},{name:"enterprise",type:"string",mapping:"enterprise"},{name:"community",type:"string",mapping:"community"},{name:"category",type:"string",mapping:"category"},{name:"hostname",type:"string",mapping:"hostname"},{name:"severity",type:"string",mapping:"severity"},{name:"traptime",type:"date",mapping:"traptime",dateFormat:"Y-m-d H:i:s"},{name:"formatline",type:"string",mapping:"formatline"},{name:"alert",type:"int",mapping:"alert"}]),baseParams:{task:"camm_test_rule",type:"snmptt"},autoDestroy:true,sortInfo:{field:"traptime",direction:"DESC"}}),cm:new Ext.grid.ColumnModel([{header:"id",dataIndex:"id",width:60,hidden:true},{header:"Description",readOnly:true,dataIndex:"description",width:210},{header:"EventName",readOnly:true,dataIndex:"eventname",width:140},{header:"EventId",dataIndex:"eventid",width:100,hidden:true},{header:"TrapOid",hidden:true,dataIndex:"trapoid",width:100},{header:"Enterprise",hidden:true,dataIndex:"enterprise",width:100},{header:"Community",hidden:true,dataIndex:"community",width:100},{header:"Category",hidden:true,dataIndex:"category",width:100},{header:"HostName",dataIndex:"hostname",width:110},{header:"Severity",dataIndex:"severity",width:60},{header:"Trap Time",readOnly:true,dataIndex:"traptime",renderer:Ext.util.Format.dateRenderer("Y-m-d H:i:s"),width:125},{id:"formatlinecolumn",header:"Format Line",dataIndex:"formatline",width:380,readOnly:true},{header:"Alert",dataIndex:"alert",renderer:this.rendalert,width:40}]),only_new_mode:false,selModel:this.selmod,viewConfig:{forceFit:true},enableColLock:false,layout:"fit",autoExpandColumn:"formatlinecolumn",loadMask:true,footer:true,tbar:[{text:"Use only new record",iconCls:"icon_bullet_new",enableToggle:true,pressed:this.only_new_mode,listeners:{click:{scope:this,fn:function(a){this.only_new_mode=(!this.only_new_mode);this.store.reload()}}}}]});cacti.plugin.camm.testtrapstab_grid.superclass.initComponent.apply(this,arguments)},onRender:function(){this.store.on({scope:this,beforeload:function(){this.store.baseParams={task:"camm_test_rule",type:"snmptt",only_new:this.only_new_mode,filter:Ext.util.JSON.encode(filterModel.getFilterObj())}}});cacti.plugin.camm.testtrapstab_grid.superclass.onRender.apply(this,arguments)},rendalert:function(e,a,b,f,d,c){if(e>0){a.css="alerted"}}});Ext.reg("TestTrapsGrid",cacti.plugin.camm.testtrapstab_grid);var wndTest=new Ext.Window({caption:"Test Rule Rezults",frame:true,height:500,width:750,resizable:true,closeAction:"hide",modal:true,maximizable:true,layout:"fit",constrain:true,buttonAlign:"center",items:[{xtype:"TestTrapsGrid",id:"TestTrapsGrid_id"}],buttons:[{text:"Close",handler:function(){wndTest.hide(null)}}]});cacti.plugin.camm.testsyslstab_grid=Ext.extend(cacti.plugin.camm.def_grid,{initComponent:function(){this.selmod=new Ext.grid.RowSelectionModel();Ext.apply(this,{store:new Ext.data.Store({id:"testSysDataStore",proxy:new Ext.data.HttpProxy({url:"camm_db_admin.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"results",totalProperty:"total",id:"id"},[{name:"id",type:"int",mapping:"id"},{name:"device_id",type:"int",mapping:"device_id"},{name:"description",type:"string",mapping:"description"},{name:"facility",type:"string",mapping:"facility"},{name:"priority",type:"string",mapping:"priority"},{name:"sys_date",type:"date",mapping:"sys_date",dateFormat:"Y-m-d H:i:s"},{name:"host",type:"string",mapping:"host"},{name:"message",type:"string",mapping:"message"}]),baseParams:{task:"camm_test_rule",type:"syslog"},autoDestroy:true,sortInfo:{field:"sys_date",direction:"DESC"}}),cm:new Ext.grid.ColumnModel([{header:"id",dataIndex:"id",width:60,hidden:true,sortable:true},{header:"device_id",dataIndex:"device_id",width:60,hidden:true},{header:"Description",dataIndex:"description",width:210},{header:"host",dataIndex:"host",width:100},{header:"facility",dataIndex:"facility",width:140},{header:"priority",dataIndex:"priority",width:100},{header:"DateTime",dataIndex:"sys_date",renderer:Ext.util.Format.dateRenderer("Y-m-d H:i:s"),width:125},{id:"formatlinecolumn",header:"message",dataIndex:"message",width:380},{header:"Alert",dataIndex:"alert",renderer:this.rendalert,width:47}]),selModel:this.selmod,viewConfig:{forceFit:true,getRowClass:function(d,b){var a="";var c=d.data.priority;switch(c){case"crit":a="crit-row";break;case"warning":a="warn-row";break;case"alert":a="alert-row";break;case"debug":a="debug-row";break;case"err":a="err-row";break}return a}},only_new_mode:false,enableColLock:false,layout:"fit",autoExpandColumn:"formatlinecolumn",loadMask:true,footer:true,tbar:[{text:"Use only new record",iconCls:"icon_bullet_new",enableToggle:true,pressed:this.only_new_mode,listeners:{click:{scope:this,fn:function(a){this.only_new_mode=(!this.only_new_mode);this.store.reload()}}}}]});cacti.plugin.camm.testsyslstab_grid.superclass.initComponent.apply(this,arguments)},onRender:function(){this.store.on({scope:this,beforeload:function(){this.store.baseParams={task:"camm_test_rule",type:"syslog",only_new:this.only_new_mode,filter:Ext.util.JSON.encode(filterModel.getFilterObj())}}});cacti.plugin.camm.testsyslstab_grid.superclass.onRender.apply(this,arguments)},rendalert:function(e,a,b,f,d,c){if(b.data.status==0){a.css="record_new"}else{if(e>100){a.css="alerted"}else{if(e>0){return'<img src="'+camm_start_var.cacti_path+'/plugins/camm/images/flag_red.png"> ['+e+"]"}}}}});Ext.reg("TestSyslGrid",cacti.plugin.camm.testsyslstab_grid);var wndSysTest=new Ext.Window({caption:"Test Rule Rezults",frame:true,height:500,width:750,resizable:true,closeAction:"hide",modal:true,maximizable:true,layout:"fit",constrain:true,buttonAlign:"center",items:[{xtype:"TestSyslGrid",id:"TestSyslsGrid_id"}],buttons:[{text:"Close",handler:function(){wndSysTest.hide(null)}}]});cacti.plugin.camm.RuleFilterEdit=Ext.extend(Ext.Window,{id:"id_RuleFilterEdit_wnd",layout:"fit",width:580,height:450,resizable:true,plain:true,border:false,closeAction:"hide",modal:true,title:"Edit filter for rule",constrain:true,buttonAlign:"center",initComponent:function(){this.wndTest=wndTest;this.wndSysTest=wndSysTest;var c=new Ext.data.Store({autoLoad:false,autoDestroy:true,proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"names"},[{name:"label"},{name:"value"}]),baseParams:{task:"camm_get_eventnames"}});var g=new Ext.data.Store({autoLoad:false,autoDestroy:true,proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"names"},[{name:"label"},{name:"value"}]),baseParams:{task:"camm_get_severites"}});var e=new Ext.data.Store({autoLoad:false,autoDestroy:true,proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"names"},[{name:"label"},{name:"value"}]),baseParams:{task:"camm_get_facilitys"}});var a=new Ext.data.Store({autoLoad:false,autoDestroy:true,proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"names"},[{name:"label"},{name:"value"}]),baseParams:{task:"camm_get_prioritys"}});var f=new Ext.data.Store({autoLoad:false,autoDestroy:true,proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"names"},[{name:"label"},{name:"value"}]),baseParams:{task:"camm_get_host_types"}});var b=[{id:"host_template_id",label:"universal - host type",type:"string",availableValues:f,remoteStore:true},{id:"eventname",label:"snmptt - eventname",type:"string",availableValues:c,remoteStore:true},{id:"hostname",label:"snmptt - hostname"},{id:"severity",label:"snmptt - severity",type:"string",availableValues:g,remoteStore:true},{id:"traptime",label:"snmptt - traptime",type:"date",format:"Y-m-d H:i:s"},{id:"formatline",label:"snmptt - formatline"},{id:"facility",label:"syslog - facility",type:"string",availableValues:e,remoteStore:true},{id:"host",label:"syslog - host"},{id:"priority",label:"syslog - priority",type:"string",availableValues:a,remoteStore:true},{id:"sys_date",label:"syslog - message time",type:"date",format:"Y-m-d H:i:s"},{id:"message",label:"syslog - message"}];filterModel=new Ext.ux.netbox.core.FilterModel(b);localFilterResolver=new Ext.ux.netbox.core.LocalStoreFilterResolver(filterModel);var d=new Ext.Button({text:"Apply"});Ext.apply(this,{items:[{filterModel:filterModel,xtype:"dynamicFilter"}],buttons:[{text:"Done",iconCls:"icon-accept",handler:function(){this.clearFilterElementary();this.getEl().mask("Processing ...");Ext.Ajax.request({url:"camm_db_admin.php",method:"POST",scope:this,callback:cacti.plugin.camm.requestCallback,params:{task:"camm_convert_json_to_sql_string",filter:Ext.util.JSON.encode(filterModel.getFilterObj())}})},scope:this},{text:"Test it",formBind:true,handler:function(){this.clearFilterElementary();if(this.record_type=="snmptt"){this.wndTest.show();this.wndTest.findById("TestTrapsGrid_id").getStore().load({params:{start:0,limit:50}})}else{if(this.record_type=="syslog"){this.wndSysTest.show();this.wndSysTest.findById("TestSyslsGrid_id").getStore().load({params:{start:0,limit:50}})}}},scope:this},{text:"Cancel",iconCls:"icon-cancel",handler:function(){this.hide()},scope:this}]});cacti.plugin.camm.RuleFilterEdit.superclass.initComponent.apply(this,arguments)},onRender:function(){cacti.plugin.camm.RuleFilterEdit.superclass.onRender.apply(this,arguments)},clearFilterElementary:function(){var b=this.record_type.substring(0,6);var a=new Array();var a=filterModel.getAllElementaryFilters();imax=a.length;for(var d=0;d<imax;++d){var e=a[d];var c=e.field.label.substring(0,6);if((!(c==b))&&(c!="univer")){filterModel.removeElementaryFilterById(e.id)}}},EditFilterRule:function(a){this.record=a.rec;this.record_type=a.type;this.show();if(!(this.record.data.json_filter=="")){filterModel.setFilterObj(Ext.util.JSON.decode(this.record.data.json_filter))}else{filterModel.setFilterObj(null)}}});Ext.reg("RuleFilterEdit",cacti.plugin.camm.RuleFilterEdit);cacti.plugin.camm.RuleWin=Ext.extend(Ext.Window,{layout:"fit",width:520,resizable:false,plain:true,border:false,autoHeight:true,closeAction:"hide",constrain:true,modal:true,initComponent:function(){this.win_RuleFilterEdit=new cacti.plugin.camm.RuleFilterEdit();this.frmpnlAddRule=new Ext.FormPanel({url:"camm_db_admin.php",id:"frmpnlAddRule",frame:true,bodyStyle:"padding:20px 20px 20px",monitorValid:true,labelWidth:85,buttonAlign:"center",autoHeight:true,width:600,bodyStyle:"padding-top:15px",items:[new Ext.form.TextField({name:"name",id:"id_name_fld",fieldLabel:"Rule name",width:380,height:20,allowBlank:false,minLength:7,msgTarget:"side"}),new Ext.form.NumberField({name:"rule_order",id:"id_rule_order_nmrfld",fieldLabel:"Rule order",width:380,maxValue:9999,allowBlank:false,msgTarget:"side"}),new Ext.form.ComboBox({name:"rule_type",id:"id_rule_type_cmbbx",fieldLabel:"Rule Type",store:new Ext.data.SimpleStore({fields:["label","value"],autoDestroy:true,data:[["snmptt","snmptt"],["Syslog","syslog"]]}),width:380,height:80,mode:"local",displayField:"label",allowBlank:false,forceSelection:true,valueField:"value",msgTarget:"side",editable:false,triggerAction:"all"}),new Ext.form.ComboBox({name:"rule_enable",id:"id_rule_enable_cmbbx",fieldLabel:"Rule enable",store:new Ext.data.SimpleStore({fields:["label","value"],autoDestroy:true,data:[["enable","enable"],["disable","disable"]]}),width:380,height:80,mode:"local",displayField:"label",allowBlank:false,forceSelection:true,valueField:"value",msgTarget:"side",editable:false,triggerAction:"all"}),new Ext.form.TriggerField({name:"sql_filter",id:"id_sql_filter_trFld",fieldLabel:"Filter (sql)",triggerClass:"x-form-search-trigger",hideTrigger:false,width:380,editable:false,onTriggerClick:this.editFilter.createDelegate(this)}),new Ext.form.TextArea({name:"notes",id:"id_notes_txtfld",fieldLabel:"Notes",grow:true,width:380,height:90}),{xtype:"tabpanel",activeTab:0,height:300,border:false,minTabWidth:130,resizeTabs:true,plain:false,deferredRender:false,defaults:{autoHeight:true,bodyStyle:"padding:5px"},items:[{title:"E-mail Notification",items:[{xtype:"fieldset",id:"id_fldset_email",checkboxToggle:{type:"checkbox",tag:"input",name:"is_email",id:"id_is_email"},title:"E-mail Notification",defaults:{width:345},collapsed:true,items:[{xtype:"textfield",id:"id_email_txtfld",name:"email",fieldLabel:"Email",height:20,allowBlank:false,vtype:"vt_email"},new Ext.form.ComboBox({name:"email_mode",id:"id_email_mode_cmbbx",fieldLabel:"Email Mode",store:new Ext.data.SimpleStore({fields:["label","value"],autoDestroy:true,data:[["All records in the one mail","1"],["Each record in the separate mail","2"]]}),mode:"local",displayField:"label",allowBlank:false,forceSelection:true,valueField:"value",msgTarget:"side",editable:false,triggerAction:"all"}),new Ext.form.ComboBox({name:"email_format",id:"id_email_format_cmbbx",fieldLabel:"Email Format",store:new Ext.data.SimpleStore({fields:["label","value"],autoDestroy:true,data:[["Standart (default)","1"],["HTML","2"]]}),mode:"local",displayField:"label",allowBlank:false,forceSelection:true,valueField:"value",msgTarget:"side",editable:false,triggerAction:"all"}),new Ext.form.ComboBox({name:"inc_cacti_name",id:"id_inc_cacti_name_cmbbx",fieldLabel:"Include Data",store:new Ext.data.SimpleStore({fields:["label","value"],autoDestroy:true,data:[["Don't (default)","1"],["Include Cacti device description in e-mail","2"]]}),mode:"local",displayField:"label",allowBlank:false,forceSelection:true,valueField:"value",msgTarget:"side",editable:false,triggerAction:"all"}),new Ext.form.ComboBox({name:"sup_mode",disabled:true,id:"id_sup_mode_cmbbx",fieldLabel:"Suppress mode",store:new Ext.data.SimpleStore({fields:["label","value"],autoDestroy:true}),mode:"local",displayField:"label",allowBlank:true,forceSelection:true,valueField:"value",msgTarget:"side",editable:false,triggerAction:"all"}),{xtype:"textarea",id:"id_email_msg_txtfld",name:"email_message",fieldLabel:"Email message",height:90,allowBlank:true,minLength:10}]}]},{title:"Other action",items:[{xtype:"fieldset",id:"id_fldset_func",checkboxToggle:{type:"checkbox",tag:"input",name:"is_function",id:"id_is_function"},title:"Execute user function",autoHeight:true,defaults:{width:345},collapsed:false,items:[new Ext.form.ComboBox({name:"function_name",id:"id_function_name_cmbbx",fieldLabel:"Function",store:new Ext.data.Store({autoLoad:false,autoDestroy:true,proxy:new Ext.data.HttpProxy({url:"camm_db_admin.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"data"},[{name:"id"},{name:"func_name"}]),baseParams:{task:"camm_get_user_functions"}}),width:230,height:80,mode:"remote",displayField:"func_name",allowBlank:false,forceSelection:true,valueField:"func_name",msgTarget:"side",editable:false,triggerAction:"all"})]},{xtype:"fieldset",id:"id_fldset_del",checkboxToggle:{type:"checkbox",tag:"input",name:"is_delete",id:"id_is_delete"},title:"Delete Record",autoHeight:true,defaultType:"textfield",collapsed:true},{xtype:"fieldset",id:"id_fldset_mark",checkboxToggle:{type:"checkbox",tag:"input",name:"is_mark",id:"id_is_mark"},title:"Mark Record",autoHeight:true,defaults:{width:345},defaultType:"numberfield",collapsed:true,items:[{xtype:"label",text:"[Rule id] will be used as marker and [rule name] as marker_name;"}]}]}]}],buttons:[{text:"Done",iconCls:"icon-accept",formBind:true,handler:function(){var a=this.frmpnlAddRule;this.sel_record.set("is_delete",Ext.get("id_is_delete").dom.checked);this.sel_record.set("is_email",Ext.get("id_is_email").dom.checked);this.sel_record.set("is_function",Ext.get("id_is_function").dom.checked);this.sel_record.set("is_mark",Ext.get("id_is_mark").dom.checked);this.sel_record.set("sql_filter",this.sel_record.data.sql_filter);this.sel_record.set("json_filter",this.sel_record.data.json_filter);this.sel_record.set("name",a.findById("id_name_fld").getValue());this.sel_record.set("order",a.findById("id_rule_order_nmrfld").getValue());this.sel_record.set("rule_type",a.findById("id_rule_type_cmbbx").getValue());this.sel_record.set("rule_enable",(a.findById("id_rule_enable_cmbbx").getValue()=="enable"?"1":"0"));this.sel_record.set("function_name",a.findById("id_function_name_cmbbx").getValue());this.sel_record.set("email",a.findById("id_email_txtfld").getValue());this.sel_record.set("inc_cacti_name",a.findById("id_inc_cacti_name_cmbbx").getValue());this.sel_record.set("sup_mode",a.findById("id_sup_mode_cmbbx").getValue());this.sel_record.set("email_format",a.findById("id_email_format_cmbbx").getValue());this.sel_record.set("email_mode",a.findById("id_email_mode_cmbbx").getValue());this.sel_record.set("email_message",a.findById("id_email_msg_txtfld").getValue());this.sel_record.set("notes",a.findById("id_notes_txtfld").getValue());this.sel_record.set("date",new Date());this.hide()},scope:this},{text:"Cancel",iconCls:"icon-cancel",handler:function(){if(((this.mode=="add")||(this.mode=="add_on_trap")||(this.mode=="add_on_sys"))){this.sel_record.store.remove(this.sel_record)}this.hide(null)},scope:this}]});Ext.apply(this,{items:[this.frmpnlAddRule]});cacti.plugin.camm.RuleWin.superclass.initComponent.apply(this,arguments)},editFilter:function(){this.win_RuleFilterEdit.EditFilterRule({rec:this.sel_record,type:this.frmpnlAddRule.findById("id_rule_type_cmbbx").getValue()})},addRecord:function(){var a=this.rule_store;if(a.recordType){var b=new a.recordType({newRecord:true});b.fields.each(function(c){b.data[c.name]=c.defaultValue||null});b.commit();a.add(b);return b}return false},showtab:function(b){this.mode=b.mode;switch(b.mode){case"edit":this.setTitle("Edit rule");this.sel_record=b.rec;this.show();break;case"add":this.setTitle("Add new rule");this.sel_record=this.addRecord();this.show();break;case"add_on_trap":this.setTitle("Create new rule based on trap");this.sel_record=this.addRecord();var a=b.rec.data;this.show();this.sel_record.set("rule_type","snmptt");this.sel_record.set("notes","Rule was auto create based on trap");this.sel_record.set("json_filter",'{"left":{"left":{"left":{"left":{"fieldId":"eventname","operatorId":"STRING_EQUAL","values":[{"label":"'+a.eventname+'","value":"'+a.eventname+'"}]},"logicalOperator":"AND","right":{"fieldId":"formatline","operatorId":"STRING_EQUAL","values":[{"label":"'+a.formatline+'","value":"'+a.formatline+'"}]}},"logicalOperator":"AND","right":{"fieldId":"hostname","operatorId":"STRING_EQUAL","values":[{"label":"'+a.hostname+'","value":"'+a.hostname+'"}]}},"logicalOperator":"AND","right":{"fieldId":"severity","operatorId":"STRING_EQUAL","values":[{"label":"'+a.severity+'","value":"'+a.severity+'"}]}},"logicalOperator":"AND","right":{"fieldId":"traptime","operatorId":"DATE_EQUAL","values":[{"value":"'+a.traptime.format("Y-m-d H:i:s")+'","label":"'+a.traptime.format("Y-m-d H:i:s")+'"}]}}');this.win_RuleFilterEdit.EditFilterRule({rec:this.sel_record,type:"snmptt"});break;case"add_on_sys":this.setTitle("Create new rule based on syslog message");this.sel_record=this.addRecord();var a=b.rec.data;this.show();this.sel_record.set("rule_type","syslog");this.sel_record.set("notes","Rule was auto create based on syslog message");this.sel_record.set("json_filter",'{"left":{"left":{"left":{"left":{"fieldId":"host","operatorId":"STRING_EQUAL","values":[{"label":"'+a.host+'","value":"'+a.host+'"}]},"logicalOperator":"AND","right":{"fieldId":"facility","operatorId":"STRING_EQUAL","values":[{"label":"'+a.facility+'","value":"'+a.facility+'"}]}},"logicalOperator":"AND","right":{"fieldId":"priority","operatorId":"STRING_EQUAL","values":[{"label":"'+a.priority+'","value":"'+a.priority+'"}]}},"logicalOperator":"AND","right":{"fieldId":"sys_date","operatorId":"DATE_EQUAL","values":[{"value":"'+a.sys_date.format("Y-m-d H:i:s")+'","label":"'+a.sys_date.format("Y-m-d H:i:s")+'"}]}},"logicalOperator":"AND","right":{"fieldId":"message","operatorId":"STRING_EQUAL","values":[{"label":"'+a.message+'","value":"'+a.message+'"}]}}');this.win_RuleFilterEdit.EditFilterRule({rec:this.sel_record,type:"syslog"});break}this.frmpnlAddRule.getForm().loadRecord(this.sel_record);this.frmpnlAddRule.findById("id_function_name_cmbbx").store.load();this.frmpnlAddRule.findById("id_function_name_cmbbx").setValue(this.sel_record.data.function_name);this.frmpnlAddRule.findById("id_rule_order_nmrfld").setValue(this.sel_record.data.order);this.frmpnlAddRule.findById("id_rule_type_cmbbx").setValue(this.sel_record.data.rule_type);this.frmpnlAddRule.findById("id_email_mode_cmbbx").setValue(this.sel_record.data.email_mode);this.frmpnlAddRule.findById("id_inc_cacti_name_cmbbx").setValue(this.sel_record.data.inc_cacti_name);this.frmpnlAddRule.findById("id_sup_mode_cmbbx").setValue(this.sel_record.data.sup_mode);this.frmpnlAddRule.findById("id_email_format_cmbbx").setValue(this.sel_record.data.email_format);this.frmpnlAddRule.findById("id_rule_enable_cmbbx").setValue(this.sel_record.data.rule_enable==1?"enable":"disable");if(this.sel_record.data.is_function==true){this.frmpnlAddRule.findById("id_fldset_func").expand();Ext.get("id_is_function").dom.checked=true}else{this.frmpnlAddRule.findById("id_fldset_func").collapse();Ext.get("id_is_function").dom.checked=false}if(this.sel_record.data.is_email==true){this.frmpnlAddRule.findById("id_fldset_email").expand();Ext.get("id_is_email").dom.checked=true}else{this.frmpnlAddRule.findById("id_fldset_email").collapse();Ext.get("id_is_email").dom.checked=false}if(this.sel_record.data.is_delete==true){this.frmpnlAddRule.findById("id_fldset_del").expand();Ext.get("id_is_delete").dom.checked=true}else{this.frmpnlAddRule.findById("id_fldset_del").collapse();Ext.get("id_is_delete").dom.checked=false}if(this.sel_record.data.is_mark==true){this.frmpnlAddRule.findById("id_fldset_mark").expand();Ext.get("id_is_mark").dom.checked=true}else{this.frmpnlAddRule.findById("id_fldset_mark").collapse();Ext.get("id_is_mark").dom.checked=false}this.center()}});Ext.reg("RuleWin",cacti.plugin.camm.RuleWin);cacti.plugin.camm.TrapWin=Ext.extend(Ext.Window,{layout:"fit",width:580,resizable:false,plain:true,border:false,autoHeight:true,closeAction:"hide",modal:true,title:"View full trap",constrain:true,initComponent:function(){this.frmpnlFullTrap=new Ext.FormPanel({url:"camm_db.php",id:"frmpnlFullTrap",frame:true,bodyStyle:"padding:10px 10px 0",labelWidth:85,buttonAlign:"center",autoHeight:true,width:550,bodyStyle:"padding-top:10px",defaults:{height:20,width:440},items:[new Ext.form.TextArea({name:"device_id",id:"id_trap_device_id",hidden:true}),new Ext.form.TriggerField({name:"description",fieldLabel:"Cacti host",triggerClass:"x-form-cacti-trigger",onTriggerClick:this.openUrl.createDelegate(this)}),new Ext.form.TextArea({name:"id",id:"id_id",fieldLabel:"ID"}),new Ext.form.TextArea({name:"eventname",fieldLabel:"Eventname"}),new Ext.form.TextArea({name:"eventid",fieldLabel:"Eventid"}),new Ext.form.TextArea({name:"trapoid",fieldLabel:"Trapoid"}),new Ext.form.TextArea({name:"enterprise",fieldLabel:"Enterprise"}),new Ext.form.TextArea({name:"community",fieldLabel:"Community"}),new Ext.form.TextArea({name:"hostname",fieldLabel:"hostname"}),new Ext.form.TextArea({name:"agentip",fieldLabel:"agentip"}),new Ext.form.TextArea({name:"category",fieldLabel:"category"}),new Ext.form.TextArea({name:"severity",fieldLabel:"severity"}),new Ext.form.TextArea({name:"uptime",fieldLabel:"uptime"}),new Ext.form.TextArea({name:"traptime",fieldLabel:"traptime"}),new Ext.form.TextArea({name:"formatline",fieldLabel:"Formatline",grow:true,width:400,height:40}),new Ext.form.TextArea({name:"status",fieldLabel:"status"}),new Ext.form.TextArea({name:"rules_name",fieldLabel:"Rules<br>names",grow:true,width:400,height:10})],buttons:[{text:"Prev by ID",handler:function(){this.frmpnlFullTrap.getForm().load({url:"camm_db.php",callback:cacti.plugin.camm.requestCallback,failure:cacti.plugin.camm.form_load_fail,scope:this,waitMsg:"Loading",method:"POST",params:{task:"camm_get_full_trap",id:"["+this.frmpnlFullTrap.findById("id_id").getValue()+"]",dir:"prev"}})},scope:this},{text:"Close",iconCls:"icon-cancel",handler:function(){this.hide(null)},scope:this},{text:"Next by ID",handler:function(){this.frmpnlFullTrap.getForm().load({url:"camm_db.php",callback:cacti.plugin.camm.requestCallback,failure:cacti.plugin.camm.form_load_fail,scope:this,waitMsg:"Loading",method:"POST",params:{task:"camm_get_full_trap",id:"["+this.frmpnlFullTrap.findById("id_id").getValue()+"]",dir:"next"}})},scope:this}]});Ext.apply(this,{items:[this.frmpnlFullTrap]});cacti.plugin.camm.TrapWin.superclass.initComponent.apply(this,arguments)},openUrl:function(){var b=parseInt(this.frmpnlFullTrap.getForm().findField("id_trap_device_id").getValue());if(Ext.isNumber(b)){var a=String.format(camm_start_var.cacti_path+"host.php?action=edit&id={0}",b);window.open(a,"","location=no");self.focus()}else{cacti.plugin.camm.showError("Undefined device_id")}},showTrap:function(a){this.rec_id=a.rec_id;this.show();this.frmpnlFullTrap.getForm().load({url:"camm_db.php",failure:cacti.plugin.camm.form_load_fail,waitMsg:"Loading",method:"POST",params:{task:"camm_get_full_trap",id:"["+a.rec_id+"]"}})}});Ext.reg("TrapWin",cacti.plugin.camm.TrapWin);cacti.plugin.camm.UnkTrapWin=Ext.extend(Ext.Window,{layout:"fit",width:580,resizable:false,plain:true,border:false,autoHeight:true,closeAction:"hide",modal:true,title:"View full unk trap",constrain:true,initComponent:function(){this.frmpnlFullTrap=new Ext.FormPanel({url:"camm_db.php",id:"frmpnlFullUnkTrap",frame:true,bodyStyle:"padding:10px 10px 0",labelWidth:85,buttonAlign:"center",autoHeight:true,width:550,bodyStyle:"padding-top:10px",defaults:{height:20,width:440},items:[new Ext.form.TextArea({name:"id",fieldLabel:"ID"}),new Ext.form.TextArea({name:"trapoid",fieldLabel:"Trapoid"}),new Ext.form.TextArea({name:"enterprise",fieldLabel:"Enterprise"}),new Ext.form.TextArea({name:"community",fieldLabel:"Community"}),new Ext.form.TextArea({name:"hostname",fieldLabel:"hostname"}),new Ext.form.TextArea({name:"agentip",fieldLabel:"agentip"}),new Ext.form.TextArea({name:"uptime",fieldLabel:"uptime"}),new Ext.form.TextArea({name:"traptime",fieldLabel:"traptime"}),new Ext.form.TextArea({name:"formatline",fieldLabel:"Formatline",grow:true,width:400,height:40})],buttons:[{text:"Close",iconCls:"icon-cancel",handler:function(){this.hide(null)},scope:this}]});Ext.apply(this,{items:[this.frmpnlFullTrap]});cacti.plugin.camm.UnkTrapWin.superclass.initComponent.apply(this,arguments)},showTrap:function(a){this.rec_id=a.rec_id;this.show();this.frmpnlFullTrap.getForm().load({url:"camm_db.php",failure:cacti.plugin.camm.form_load_fail,waitMsg:"Loading",method:"POST",params:{task:"camm_get_full_unk_trap",id:"["+a.rec_id+"]"}})}});Ext.reg("UnkTrapWin",cacti.plugin.camm.UnkTrapWin);var resultTpl=new Ext.XTemplate('<tpl for="."><div class="search-item">','<h3><span>{lastPost:date("M j, Y")}<br />by {author}</span>{title}</h3>',"{excerpt}","</div></tpl>");var resultTpl1=new Ext.Template("<div>Hello {0}.</div>");resultTpl1.compile();cacti.plugin.camm.SysMesWin=Ext.extend(Ext.Window,{layout:"fit",width:580,resizable:false,plain:true,border:false,autoHeight:true,closeAction:"hide",modal:true,title:"View full Syslog message",constrain:true,initComponent:function(){this.frmpnlFullSysMes=new Ext.FormPanel({url:"camm_db.php",id:"frmpnlFullSysMessage",frame:true,bodyStyle:"padding:10px 10px 0",labelWidth:85,buttonAlign:"center",autoHeight:true,width:550,bodyStyle:"padding-top:10px",defaults:{height:20,width:440},items:[new Ext.form.TextArea({name:"device_id",id:"id_device_id",hidden:true}),new Ext.form.TriggerField({name:"description",fieldLabel:"Cacti host",triggerClass:"x-form-cacti-trigger",onTriggerClick:this.openUrl.createDelegate(this)}),new Ext.form.TextField({name:"id",id:"id_sid",fieldLabel:"ID"}),new Ext.form.TextField({name:"facility",fieldLabel:"Facility"}),new Ext.form.TextField({name:"priority",fieldLabel:"Priority"}),new Ext.form.TextField({name:"sys_date",fieldLabel:"Sys_date"}),new Ext.form.TextField({name:"host",fieldLabel:"Host"}),new Ext.form.TextField({name:"sourceip",fieldLabel:"sourceip"}),new Ext.form.TextField({name:"status",fieldLabel:"status"}),new Ext.form.TextField({name:"status",fieldLabel:"status"}),new Ext.form.TextArea({name:"message",fieldLabel:"Message",grow:true,width:400,height:40}),new Ext.form.TextArea({name:"rules_name",fieldLabel:"Rules<br>names",grow:true,width:400,height:10})],buttons:[{text:"Prev by ID",handler:function(){this.frmpnlFullSysMes.getForm().load({url:"camm_db.php",callback:cacti.plugin.camm.requestCallback,failure:cacti.plugin.camm.form_load_fail,scope:this,waitMsg:"Loading",method:"POST",params:{task:"camm_get_full_sys_mes",id:"["+this.frmpnlFullSysMes.findById("id_sid").getValue()+"]",dir:"prev"}})},scope:this},{text:"Close",iconCls:"icon-cancel",handler:function(){this.hide(null)},scope:this},{text:"Next by ID",handler:function(){this.frmpnlFullSysMes.getForm().load({url:"camm_db.php",callback:cacti.plugin.camm.requestCallback,failure:cacti.plugin.camm.form_load_fail,scope:this,waitMsg:"Loading",method:"POST",params:{task:"camm_get_full_sys_mes",id:"["+this.frmpnlFullSysMes.findById("id_sid").getValue()+"]",dir:"next"}})},scope:this}]});Ext.apply(this,{items:[this.frmpnlFullSysMes]});cacti.plugin.camm.SysMesWin.superclass.initComponent.apply(this,arguments)},openUrl:function(){var b=parseInt(this.frmpnlFullSysMes.getForm().findField("id_device_id").getValue());if(Ext.isNumber(b)){var a=String.format(camm_start_var.cacti_path+"host.php?action=edit&id={0}",b);window.open(a,"","location=no");self.focus()}else{cacti.plugin.camm.showError("Undefined device_id")}},showSys:function(a){this.rec_id=a.rec_id;this.show();this.frmpnlFullSysMes.getForm().load({url:"camm_db.php",callback:cacti.plugin.camm.requestCallback,failure:cacti.plugin.camm.form_load_fail,scope:this,waitMsg:"Loading",method:"POST",params:{task:"camm_get_full_sys_mes",id:"["+a.rec_id+"]"}})}});Ext.reg("SysMesWin",cacti.plugin.camm.SysMesWin);var str_chart_host=new Ext.data.JsonStore({url:"camm_db.php",fields:["n",{name:"v",type:"int"}],root:"Pies",baseParams:{task:"camm_get_chart_group_host"},scope:this,listeners:{load:function(){var a=Ext.getCmp("camm_chart_host_id");a.removeAllSeries();a.addSeries([{type:"pie",categorieField:"n",dataField:"v"}])},beforeload:function(){var e=Ext.getCmp("camm_chart_host_id");var b=Ext.getCmp("id_chart_host_most").getValue();var a=Ext.getCmp("id_chart_host_usecacti").getValue();var d=Ext.getCmp("id_chart_host_use_group").getValue();Ext.apply(this.baseParams,{type:e.std.type,filter_by_chart:Ext.util.JSON.encode(e.std.filter_by_chart),rule_id:e.std.rule_id,limit:b,use_cacti:a,use_host_group:d})}}});var wndChartHost=new Ext.Window({caption:"View Chart group by host",frame:true,height:450,width:650,resizable:true,closeAction:"hide",hideMode:"offsets",modal:true,maximizable:true,layout:"fit",constrain:true,buttonAlign:"center",plugins:[new Ext.ux.CenterWindowPlugin()],tbar:["Show top ",new Ext.form.ComboBox({name:"chart_interv",id:"id_chart_host_most",fieldLabel:"Show first ",store:new Ext.data.SimpleStore({fields:["label","value"],autoDestroy:true,data:[["5 rows","5"],["10 rows","10"],["20 rows","20"],["30 rows","30"]]}),value:"10",mode:"local",displayField:"label",valueField:"value",allowBlank:false,forceSelection:true,msgTarget:"side",editable:false,triggerAction:"all"}),"-",new Ext.form.Checkbox({id:"id_chart_host_usecacti",boxLabel:"Use Cacti hostname",checked:true}),"-",new Ext.form.Checkbox({id:"id_chart_host_use_group",boxLabel:"Group by Cacti host templ",checked:false})],items:[new Ext.ux.HighChart({loadMask:true,id:"camm_chart_host_id",store:str_chart_host,chartConfig:{chart:{defaultSeriesType:"pie",margin:[40,10,10,300]},plotArea:{shadow:null,borderWidth:null,backgroundColor:null},tooltip:{formatter:function(){return"<b>"+this.point.name+"</b>: "+this.y+" messages"}},title:{text:"Messages group by host Chart"},subtitle:{text:"Click"},plotOptions:{pie:{allowPointSelect:true,cursor:"pointer"}},legend:{layout:"vertical",style:{left:"10px",top:"50px"}}},series:[]})],buttons:[{text:"Close",handler:function(){wndChartHost.hide(null)}},{text:"Update",iconCls:"arrow_refresh",scope:this,listeners:{click:{scope:this,buffer:200,fn:function(a){str_chart_host.load()}}}}]});Ext.ns("cacti.plugin.camm");cacti.plugin.camm.StatsGrid=Ext.extend(Ext.grid.GridPanel,{idName:"id",objName:"company",initComponent:function(){Ext.apply(this,{store:new Ext.data.GroupingStore({proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"stats"},[{name:"type",type:"string",mapping:"type"},{name:"name",type:"string",mapping:"name"},{name:"value",type:"string",mapping:"value"}]),sortInfo:{field:"type",direction:"ASC"},baseParams:{task:"camm_get_stats"},autoDestroy:true,groupField:"type"}),cm:new Ext.grid.ColumnModel([{header:"name",sortable:true,dataIndex:"name",width:60},{header:"value",dataIndex:"value",sortable:true,width:80},{header:"type",dataIndex:"type",width:60,hidden:true}]),view:new Ext.grid.GroupingView({forceFit:true,groupTextTpl:"{group}"}),selModel:new Ext.grid.RowSelectionModel(),viewConfig:{forceFit:true},enableColLock:false,layout:"fit",autoExpandColumn:"value",loadMask:true,footer:true,tbar:[{text:"Update",iconCls:"arrow_refresh",scope:this,handler:function(){this.store.load()}},{text:"Export to Excel...",iconCls:"excel_export",listeners:{click:{scope:this,fn:function(){document.location="data:application/vnd.ms-excel;base64,"+Base64.encode(this.getExcelXml())}}}}]});cacti.plugin.camm.StatsGrid.superclass.initComponent.apply(this,arguments)},onRender:function(){this.store.on({scope:this,exception:cacti.plugin.camm.loadexception});this.store.load({params:{task:"camm_get_stats"}});cacti.plugin.camm.StatsGrid.superclass.onRender.apply(this,arguments)}});Ext.reg("StatsGrid",cacti.plugin.camm.StatsGrid);cacti.plugin.camm.stat_graph_pan=Ext.extend(Ext.Panel,{initComponent:function(){Ext.apply(this,{title:"Graphs",id:"test1111",width:700,autoLoad:{url:"camm_db.php",method:"POST",nocache:true,timeout:20,params:{task:"camm_get_graphurl"}},tbar:[{text:"Update",iconCls:"arrow_refresh",scope:this,handler:this.updateGraph}]});cacti.plugin.camm.stat_graph_pan.superclass.initComponent.apply(this,arguments)},updateGraph:function(){this.getUpdater().update({url:"camm_db.php",timeout:20,method:"POST",nocache:true,params:{task:"camm_get_graphurl"}})}});Ext.reg("stat_graph_pan",cacti.plugin.camm.stat_graph_pan);cacti.plugin.camm.stat_tab=Ext.extend(Ext.TabPanel,{title:"Stats and Chart",closable:false,activeTab:0,initComponent:function(){this.d=[[1196463600000,5],[1196550000000,10],[1196636400000,12],[1196722800000,0],[1196809200000,0],[1196895600000,0],[1197154800000,77]];for(var a=0;a<this.d.length;++a){this.d[a][0]+=60*60*1000}this.series=[{data:this.d}];Ext.apply(this,{items:[{layout:"border",title:"GeneraL Poller stats",defaults:{split:true,layout:"fit",collapsible:true,collapseMode:"mini"},items:[{xtype:"StatsGrid",region:"center",minSize:400,stateid:"stateid_state_grid"},{xtype:"stat_graph_pan",region:"west",autoScroll:true}]},{layout:"border",disabled:false,title:"Aggregate info on devices",defaults:{split:true,layout:"fit",collapsible:true,collapseMode:"mini"},items:[{layout:"fit",region:"center",height:400,xtype:"IncorDevGrid"}]},{layout:"fit",region:"center",xtype:"graph"}]});cacti.plugin.camm.stat_tab.superclass.initComponent.apply(this,arguments)},afterRender:function(){cacti.plugin.camm.stat_tab.superclass.afterRender.apply(this,arguments)}});Ext.reg("stat_tab",cacti.plugin.camm.stat_tab);Ext.ns("cacti.plugin.camm");cacti.plugin.camm.RezultGrid=Ext.extend(Ext.grid.GridPanel,{idName:"id",objName:"company",title:"Rezults",enableColumnHide:false,enableColumnMove:false,enableHdMenu:false,height:250,initComponent:function(){Ext.apply(this,{store:new Ext.data.GroupingStore({proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"rezults"},[{name:"id",type:"int",mapping:"id"},{name:"group",type:"string",mapping:"group"},{name:"title",type:"string",mapping:"title"},{name:"message",type:"string",mapping:"message"},{name:"step_rezult",type:"string",mapping:"step_rezult"},{name:"step_data",type:"string",mapping:"step_data"},{name:"check_rezult",type:"string",mapping:"check_rezult"},{name:"check_data",type:"string",mapping:"check_data"}]),sortInfo:{field:"id",direction:"ASC"},baseParams:{task:"camm_view_rezults"},autoDestroy:true,groupField:"group"}),cm:new Ext.grid.ColumnModel([{header:"id",hidden:true,sortable:true,dataIndex:"id",width:60},{header:"Group",hidden:true,sortable:true,dataIndex:"group",width:60},{header:"Title",sortable:false,dataIndex:"title",width:300},{header:"Action",sortable:false,dataIndex:"message",width:300},{header:"Rezult",dataIndex:"step_rezult",sortable:false,renderer:this.rendrezult,width:80},{header:"Check",dataIndex:"check_rezult",width:60,renderer:this.rendcheck,sortable:false}]),view:new Ext.grid.GroupingView({forceFit:true,groupTextTpl:'{text} ({[values.rs.length]} {[values.rs.length > 1 ? "Items" : "Item"]})'}),autoExpandColumn:"action",selModel:new Ext.grid.RowSelectionModel(),viewConfig:{forceFit:true},enableColLock:false,layout:"fit",loadMask:true,footer:true});cacti.plugin.camm.RezultGrid.superclass.initComponent.apply(this,arguments)},onRender:function(){cacti.plugin.camm.RezultGrid.superclass.onRender.apply(this,arguments)},rendrezult:function(e,a,b,f,d,c){if(e==="OK"){a.css="rezult_ok"}else{if(e==="no access"){a.css="rezult_no_access"}else{a.css="rezult_no_ok"}}if(b.data.step_data){return e+" ["+b.data.step_data+"]"}else{return e}},rendcheck:function(e,a,b,f,d,c){if(e==="OK"){a.css="rezult_ok"}else{if(e==="no access"){a.css="rezult_no_access"}else{a.css="rezult_no_ok"}}if(b.data.check_data){return e+" ["+b.data.check_data+"]"}else{return e}}});Ext.reg("RezultGrid",cacti.plugin.camm.RezultGrid);cacti.plugin.camm.IncorDevGrid=Ext.extend(cacti.plugin.camm.def_grid,{idName:"id",enableColumnMove:false,height:250,initComponent:function(){Ext.apply(this,{store:new Ext.data.GroupingStore({proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"results",totalProperty:"total",id:"id"},[{name:"id",type:"int"},{name:"device_type_id",type:"int"},{name:"device_type_name",type:"string"},{name:"description",type:"string"},{name:"hostname",type:"string"},{name:"rstatus",type:"int"},{name:"syslog_count",type:"int"},{name:"snmp_count",type:"int"}]),autoload:true,sortInfo:{field:"device_type_id",direction:"ASC"},baseParams:{task:"camm_get_incorrect_devices"},autoDestroy:true,groupField:"device_type_name"}),cm:new Ext.grid.ColumnModel([{header:"Device ID",sortable:true,width:20},{header:"Device type id",hide:true,sortable:true,width:20},{header:"Device Type Name",hidden:true,dataIndex:"device_type_name",sortable:true,width:50},{header:"Description",renderer:this.rend_camm_hostname,sortable:true,width:130},{header:"Hostname",sortable:true,width:90},{header:"Status",css:"text-align : center;",renderer:this.rend_camm_status,sortable:true,width:30},{header:"Syslog count",css:"text-align : center;",renderer:this.rend_camm_count,sortable:true,width:50},{header:"Snmp count",css:"text-align : center;",renderer:this.rend_camm_count,sortable:true,width:50}]),view:new Ext.grid.GroupingView({forceFit:true,groupTextTpl:'{text} ({[values.rs.length]} {[values.rs.length > 1 ? "Items" : "Item"]})'}),autoExpandColumn:"device_type_id",selModel:new Ext.grid.RowSelectionModel(),viewConfig:{forceFit:true},enableColLock:false,layout:"fit",loadMask:true,footer:true});cacti.plugin.camm.IncorDevGrid.superclass.initComponent.apply(this,arguments)},onRender:function(){this.store.load({params:{start:0,limit:50}});cacti.plugin.camm.IncorDevGrid.superclass.onRender.apply(this,arguments)},rend_camm_hostname:function(e,a,b,f,d,c){return String.format("<b><a href="+camm_start_var.cacti_path+"host.php?action=edit&id={1}>{0}</a></b>",e,b.data.id)},rend_camm_status:function(c,a){var b=c;switch(c){case -1:a.css="state_disabled";b="Disabled";break;case 1:a.css="state_down";b="Down";break;case 2:a.css="state_recovering";b="Recovering";break;case 3:a.css="state_up";b="UP";break;case 0:a.css="state_disabled";b="unknown ("+c+")";break}return b},rend_camm_count:function(b,a){if(b<1){a.css="zerro_count"}return b}});Ext.reg("IncorDevGrid",cacti.plugin.camm.IncorDevGrid);cacti.plugin.camm.Graph=Ext.extend(Ext.Panel,{id:"camm_panel_chart_id",title:"Chart",initComponent:function(){this.store=new Ext.data.JsonStore({url:"camm_db.php",fields:[{name:"p",type:"int"}],root:"Points",baseParams:{task:"camm_get_chart",period:"168"}});Ext.apply(this,{layout:"border",items:[new Ext.ux.HighChart({region:"center",loadMask:true,id:"camm_chart_id",store:this.store,chartConfig:{chart:{zoomType:"x"},title:{text:"Messages Chart"},subtitle:{text:"Click and drag in the plot area to zoom in"},xAxis:{type:"datetime",tickPixelInterval:50,maxZoom:1*300000,dateTimeLabelFormats:{hour:"%H %e. %b"},minorTickInterval:24*3600*1000,labels:{formatter:function(){return Highcharts.dateFormat("%H:%M _",this.value)},rotation:270},title:{text:null}},yAxis:{title:{text:"Messages per interval"},min:0,startOnTick:false,showFirstLabel:false},tooltip:{formatter:function(){return"<b>"+(this.point.name||this.series.name)+"</b><br/>Point   :"+Highcharts.dateFormat("%A %B %e %Y  %H:%M:%S",this.x)+":<br/>Messages:"+Highcharts.numberFormat(this.y,0)}},legend:{enabled:true},plotOptions:{area:{fillColor:{linearGradient:[0,0,0,300],stops:[[0,"#4572A7"],[1,"rgba(0,0,0,0)"]]},lineWidth:1,marker:{enabled:false,states:{hover:{enabled:true,radius:3}}},shadow:false,states:{hover:{lineWidth:1}}}}},series:[]}),new Ext.FormPanel({region:"south",id:"frmpnlChart",frame:true,monitorValid:true,labelWidth:105,height:130,buttonAlign:"center",collapsible:false,split:true,style:"margin:5px;",defaults:{columnWidth:".5",border:false},layout:"column",items:[{xtype:"container",layout:"form",items:[new Ext.form.ComboBox({name:"chart_type",id:"id_chart_type_cmbbx",fieldLabel:"Type of messages",store:new Ext.data.SimpleStore({fields:["label","value"],autoDestroy:true,data:[["Snmptt","snmptt"],["Syslog","syslog"]]}),value:"syslog",width:380,height:80,mode:"local",displayField:"label",allowBlank:false,forceSelection:true,valueField:"value",msgTarget:"side",editable:false,triggerAction:"all",listeners:{select:{fn:function(c,b){var a=Ext.getCmp("id_chart_marker_cmbbx");a.store.reload({params:{type:c.getValue()}});a.setValue("0")}}}}),new Ext.form.ComboBox({name:"chart_marker",id:"id_chart_marker_cmbbx",fieldLabel:"Marker",store:new Ext.data.Store({autoLoad:false,autoDestroy:true,proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"data"},[{name:"id"},{name:"marker_name"}]),baseParams:{task:"camm_get_markers",type:"syslog"}}),value:"0",width:380,height:80,displayField:"marker_name",valueField:"id",allowBlank:false,forceSelection:true,msgTarget:"side",editable:false,triggerAction:"all"})]},{xtype:"container",layout:"form",items:[new Ext.form.ComboBox({name:"chart_period",id:"id_chart_period_cmbbx",fieldLabel:"Period",store:new Ext.data.SimpleStore({fields:["label","value"],autoDestroy:true,data:[["All","0"],["Last month","720"],["Last two week","336"],["Last week","168"],["Last 4 day","96"],["Last 2 day","48"],["Last day","24"],["Last 6 hour","6"]]}),value:"168",width:380,height:80,mode:"local",displayField:"label",valueField:"value",allowBlank:false,forceSelection:true,msgTarget:"side",editable:false,triggerAction:"all"}),new Ext.form.ComboBox({name:"chart_interv",id:"id_chart_interv_cmbbx",fieldLabel:"Interval",store:new Ext.data.SimpleStore({fields:["label","value"],autoDestroy:true,data:[["1 day","86400"],["6 hour","21600"],["2 hour","7200"],["1 hour","3600"],["30 minute","1800"],["20 minute","1200"],["10 minute","600"],["5 minute","300"],["1 minute","60"]]}),value:"300",width:380,height:80,mode:"local",displayField:"label",valueField:"value",allowBlank:false,forceSelection:true,msgTarget:"side",editable:false,triggerAction:"all"})]}],buttons:[{text:"Update",formBind:true,iconCls:"arrow_refresh",scope:this,listeners:{click:{scope:this,buffer:200,fn:function(e){var d=Ext.getCmp("frmpnlChart");var f=d.findById("id_chart_type_cmbbx").getValue();var b=d.findById("id_chart_marker_cmbbx").getValue();var c=d.findById("id_chart_period_cmbbx").getValue();var a=d.findById("id_chart_interv_cmbbx").getValue();Ext.apply(this.store.baseParams,{type:f,rule_id:b,period:c,interval:a});Ext.getCmp("id_btn_show_mes").disable();Ext.getCmp("id_btn_show_hst_chart").disable();this.store.load()}}}},{text:"Show source messages",scope:this,id:"id_btn_show_mes",disabled:true,listeners:{click:{scope:this,buffer:200,fn:function(b){var g=Ext.getCmp("frmpnlChart");var f=Ext.getCmp("camm_chart_id");var l=f.chart.xAxis[0].getExtremes();var e=g.findById("id_chart_type_cmbbx").getValue();var j=g.findById("id_chart_marker_cmbbx").getValue();if(e=="syslog"){var c=Ext.getCmp("syslog_tab_id");var a=Ext.getCmp("sysl_tab_sysl_grid_id");var k="sys_date"}else{if(e=="snmptt"){var c=Ext.getCmp("traps_tab_id");var a=Ext.getCmp("trap_tab_trap_grid_id");var k="traptime"}else{Ext.Msg.alert("error","Incorect type of messages ["+e+"]")}}var d=new Date(l.min);var m=new Date(l.max);var h={fieldId:k,operatorId:"DATE_RANGE",values:[{label:d.format("Y-m-d H:i:s"),value:d.format("Y-m-d H:i:s")},{label:m.format("Y-m-d H:i:s"),value:m.format("Y-m-d H:i:s")}]};MainTabs.setActiveTab(c);Ext.apply(a.getStore().baseParams,{filter_chart:Ext.util.JSON.encode(h),rule_id:j});a.getStore().load({params:{start:0}})}}}},{text:"View grouped by host",scope:this,id:"id_btn_show_hst_chart",disabled:true,listeners:{click:{scope:this,buffer:200,fn:function(a){var f=Ext.getCmp("frmpnlChart");var e=Ext.getCmp("camm_chart_id");var d=f.findById("id_chart_type_cmbbx").getValue();var h=f.findById("id_chart_marker_cmbbx").getValue();var k=e.chart.xAxis[0].getExtremes();var b=new Date(k.min);var l=new Date(k.max);if(d=="syslog"){var j="sys_date"}else{if(d=="snmptt"){var j="traptime"}else{Ext.Msg.alert("error","Incorect type of messages ["+d+"]")}}var g={fieldId:j,operatorId:"DATE_RANGE",values:[{label:b.format("Y-m-d H:i:s"),value:b.format("Y-m-d H:i:s")},{label:l.format("Y-m-d H:i:s"),value:l.format("Y-m-d H:i:s")}]};var c=Ext.getCmp("camm_chart_host_id");c.std={type:d,filter_by_chart:g,rule_id:h};wndChartHost.show();c.store.load()}}}}]})]});cacti.plugin.camm.Graph.superclass.initComponent.call(this)},onRender:function(){this.store.on({scope:this,load:function(){var c=Ext.getCmp("camm_chart_id");c.removeAllSeries();c.addSeries([{type:"area",yField:"p",name:this.store.reader.jsonData.message,pointInterval:parseFloat(this.store.reader.jsonData.pointInterval),pointStart:parseFloat(this.store.reader.jsonData.pointStart)}]);Ext.getCmp("id_btn_show_mes").enable();Ext.getCmp("id_btn_show_hst_chart").enable()},exception:cacti.plugin.camm.loadexception});cacti.plugin.camm.Graph.superclass.onRender.apply(this,arguments);var a=Ext.getCmp("frmpnlChart");var b=a.findById("id_chart_marker_cmbbx");b.store.load();this.store.load()}});Ext.reg("graph",cacti.plugin.camm.Graph);cacti.plugin.camm.SyslogStatGrid=Ext.extend(Ext.ux.maximgb.tg.GridPanel,{initComponent:function(){this.PercColumn=new Ext.ux.grid.ProgressColumn({header:"Percent",dataIndex:"perc",width:100,sortable:true,textPst:"%",colored:true});Ext.apply(this,{rootId:"0",store:new Ext.ux.maximgb.tg.AdjacencyListStore({autoLoad:false,rootId:"0",proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),autoDestroy:true,baseParams:{task:"camm_get_topstat",type:"",period:"all"},reader:new Ext.data.JsonReader({id:"_id",root:"data",totalProperty:"total",successProperty:"success"},[{name:"label"},{name:"hostname"},{name:"count",type:"int"},{name:"tree_id",type:"int"},{name:"perc",type:"float"},{name:"_id",type:"int"},{name:"_lvl",type:"int"},{name:"_parent",type:"auto"},{name:"_is_leaf",type:"bool"}])}),master_column_id:"flCol",columns:[{header:"Type, Host, Event",width:130,id:"flCol",renderer:this.render_flCol,sortable:true,dataIndex:"label"},{header:"Count",width:85,sortable:true,dataIndex:"count"},this.PercColumn],loadMask:true,stripeRows:true,autoExpandColumn:"flCol",plugins:[this.PercColumn,new Ext.ux.plugins.TreeGridStatefull({cp:Ext.state.Manager.getProvider()})],root_title:"root",tbar:[new Ext.CycleButton({showText:true,prependText:"View: ",items:[{text:"syslog",checked:(camm_start_var.camm_use_syslog?true:(camm_start_var.camm_use_snmptt?false:true)),disabled:(!camm_start_var.camm_use_syslog||false)},{text:"snmptt",checked:(camm_start_var.camm_use_snmptt&&(!camm_start_var.camm_use_syslog)),disabled:(!camm_start_var.camm_use_snmptt||false)}],changeHandler:function(a,b){Ext.apply(this.getStore().baseParams,{type:b.text});this.getStore().reload()},scope:this}),"-",new Ext.CycleButton({showText:true,prependText:"Period: ",items:[{text:"all",checked:true},{text:"week"},{text:"day"},{text:"hour"}],changeHandler:function(a,b){Ext.apply(this.getStore().baseParams,{period:b.text});this.getStore().reload()},scope:this}),"->",{text:"refresh",iconCls:"x-tbar-loading",handler:function(){this.getStore().reload()},scope:this}]});cacti.plugin.camm.SyslogStatGrid.superclass.initComponent.apply(this,arguments)},onRender:function(){if(camm_start_var.camm_use_syslog){var a="syslog"}else{if(camm_start_var.camm_use_snmptt){var a="snmptt"}else{var a=""}}Ext.apply(this.getStore().baseParams,{type:a});this.getStore().load();cacti.plugin.camm.SyslogStatGrid.superclass.onRender.apply(this,arguments);this.getStore().sort("perc","ASC");this.on({scope:this,cellclick:function(b,j,g,f){if(f.target.tagName=="A"){var k=b.getStore();var d=k.getAt(j);var l=b.getColumnModel().getDataIndex(g);if(l=="label"){var m=new Array();m._lvl=d.data._lvl;if(d.data._lvl==2){m.host_id=d.data.label;var h=k.getById(d.data._parent);m.type_id=h.data.label}else{if(d.data._lvl==3){m.evn_id=d.data.label;var c=k.getById(d.data._parent);m.host_id=c.data.label;var h=k.getById(c.data._parent);m.type_id=h.data.label}}cacti.plugin.camm.OpenTabFilter(k.baseParams.type,m)}}}})},render_flCol:function(c,a,b){if(b.data._lvl>1){return String.format("<a>{0}</a>",c)}else{return c}}});Ext.reg("SyslogStatGrid",cacti.plugin.camm.SyslogStatGrid);Ext.ns("cacti.plugin.camm");cacti.plugin.camm.rules_tab_rules_grid=Ext.extend(cacti.plugin.camm.def_grid,{idName:"id",id:"rules_tab_rules_grid_id",objName:"company",layout:"fit",buttonAlign:"center",initComponent:function(){this.win_addRule=new cacti.plugin.camm.RuleWin();this.recordForm=new Ext.ux.grid.RecordForm({title:"Edit camm Rule",iconCls:"icon-edit-record",columnCount:1,ignoreFields:{id:true,date:true},readonlyFields:{action1:true},disabledFields:{},formConfig:{labelWidth:65,buttonAlign:"center",bodyStyle:"padding-top:10px"},windowConfig:{width:750}});this.rowActions=new Ext.ux.grid.RowActions({header:"Actions",actions:[{iconCls:"icon-minus",qtip:"Delete Rule"},{iconCls:"clone",qtip:"Clone Rule"},{iconCls:"icon-edit-record",qtip:"Edit Rule"},{iconCls:"icon-force_go",qtip:"Force run this Rule"}],widthIntercept:Ext.isSafari?4:2,id:"rule_actions"});this.rowActions.on("action",this.onRowAction,this);Ext.apply(this,{store:new Ext.data.GroupingStore({id:0,proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"results",totalProperty:"total",id:"id"},[{name:"id",type:"int",mapping:"id"},{name:"name",type:"string",mapping:"name"},{name:"order",type:"int",mapping:"order"},{name:"rule_type",type:"string",mapping:"rule_type"},{name:"rule_enable",type:"string",mapping:"rule_enable"},{name:"is_function",type:"boolean",mapping:"is_function"},{name:"is_email",type:"boolean",mapping:"is_email"},{name:"is_mark",type:"boolean",mapping:"is_mark"},{name:"is_delete",type:"boolean",mapping:"is_delete"},{name:"function_name",type:"string",mapping:"function_name"},{name:"email",type:"string",mapping:"email"},{name:"email_mode",type:"int"},{name:"inc_cacti_name",type:"int"},{name:"sup_mode",type:"int"},{name:"email_format",type:"int"},{name:"email_message",type:"string",mapping:"email_message"},{name:"notes",type:"string",mapping:"notes"},{name:"date",type:"date",mapping:"date",dateFormat:"Y-m-d H:i:s"},{name:"username",type:"string",mapping:"username"},{name:"json_filter",type:"string",mapping:"json_filter"},{name:"count_triggered",type:"int",mapping:"count_triggered"},{name:"actual_triggered",type:"int",mapping:"actual_triggered"},{name:"sql_filter",type:"string",mapping:"sql_filter"}]),sortInfo:{field:"id",direction:"ASC"},baseParams:{task:"camm_get_rules_records"}}),cm:new Ext.grid.ColumnModel([this.rowActions,{header:"id",id:"id",sortable:true,dataIndex:"id",hidden:true,width:15},{header:"Order",sortable:true,dataIndex:"order",width:20},{header:"Name",sortable:true,dataIndex:"name",width:60},{header:"Type",sortable:true,dataIndex:"rule_type",width:60},{header:"Enable",sortable:true,dataIndex:"rule_enable",width:20,renderer:this.rend_enable},{header:"Actions",width:110,renderer:this.rend_actions},{header:"is_function",sortable:true,dataIndex:"is_function",hidden:true,width:55},{header:"is_email",sortable:true,dataIndex:"is_email",hidden:true,width:35},{header:"is_mark",sortable:true,dataIndex:"is_mark",hidden:true,width:35},{header:"is_delete",sortable:true,dataIndex:"is_delete",hidden:true,width:45},{header:"Function name",dataIndex:"function_name",sortable:true,hidden:true,width:50},{header:"Email",dataIndex:"email",sortable:true,hidden:true,width:50},{header:"Email_message",id:"id_email_message",dataIndex:"email_message",sortable:true,hidden:true,width:110},{header:"Overall Trig.",sortable:true,dataIndex:"count_triggered",width:30},{header:"Actually Trig.",sortable:true,dataIndex:"actual_triggered",hidden:true,width:30},{header:"Notes",id:"id_notes",dataIndex:"notes",sortable:true,width:110},{header:"Author name",dataIndex:"username",sortable:true,width:30},{header:"Date",dataIndex:"date",sortable:true,renderer:Ext.util.Format.dateRenderer("Y-m-d H:i:s"),width:55},{header:"Filter (SQL)",id:"id_sql_filter",dataIndex:"sql_filter",sortable:true,hidden:true,width:120}]),view:new Ext.grid.GroupingView({forceFit:true,getRowClass:function(d,b){var a="";var c=d.data.rule_enable;switch(c){case"0":a="debug-row";break}return a},groupTextTpl:'{text} ({[values.rs.length]} {[values.rs.length > 1 ? "Items" : "Item"]})'}),selModel:new Ext.grid.RowSelectionModel(),viewConfig:{forceFit:true},columns:this.rowActions,enableColLock:false,layout:"fit",plugins:[this.rowActions,this.recordForm],autoExpandColumn:"FormatLine",loadMask:true,footer:true,buttons:[{text:"Save",iconCls:"icon-disk",scope:this,disabled:!(is_camm_admin==1),handler:this.commitChanges},{text:"Reset",iconCls:"icon-undo",scope:this,disabled:!(is_camm_admin==1),handler:function(){this.store.rejectChanges()}}],tbar:[{text:"Add Rule",disabled:!(is_camm_admin==1),iconCls:"icon-form-add",listeners:{click:{scope:this,buffer:200,fn:function(a){this.win_addRule.showtab({mode:"add"})}}}}]});cacti.plugin.camm.rules_tab_rules_grid.superclass.initComponent.apply(this,arguments)},onRender:function(){this.store.load({params:{start:0,limit:(camm_start_var.camm_num_rows||50),task:"camm_get_rules_records",filter:""}});cacti.plugin.camm.rules_tab_rules_grid.superclass.onRender.apply(this,arguments);this.win_addRule.rule_store=this.store;this.on({scope:this,celldblclick:function(b,c){var a=this.store.getAt(c);this.win_addRule.showtab({mode:"edit",rec:a})}})},rend_actions:function(e,a,b,f,d,c){rezult="";if(b.data.is_function===true){rezult=rezult+"Execute user function ["+b.data.function_name+"]<br>"}if(b.data.is_email){rezult=rezult+"send e-mail to ["+b.data.email+"]";if(b.data.email_mode==1){rezult=rezult+" (one message)<br>"}else{rezult=rezult+" (separate messages)<br>"}}if(b.data.is_mark){rezult=rezult+"mark this record with marker ["+b.data.id+"].<br>"}if(b.data.is_delete){rezult=rezult+"delete this record.<br>"}return rezult},rend_enable:function(e,a,b,f,d,c){if(e==1){return"true"}else{return"false"}},addRecord:function(){var a=this.store;if(a.recordType){var b=new a.recordType({newRecord:true});b.fields.each(function(c){b.data[c.name]=c.defaultValue||null});b.commit();a.add(b);return b}return false},onRowAction:function(c,a,d,e,b){if(is_camm_admin==1){switch(d){case"icon-minus":this.deleteRecord(a);break;case"icon-edit-record":this.win_addRule.showtab({mode:"edit",rec:a});break;case"icon-force_go":if(a.dirty){Ext.Msg.show({title:"Record changed",msg:"<b>You NEED</b> save rule to apply changes before execute it.",buttons:Ext.Msg.OK,icon:Ext.Msg.INFO});return}Ext.Msg.show({title:"Force Execute Rule ?",msg:"Do you really want to force execute rule  <b>"+a.get("name")+"</b>?<br/>It will mention all records already processed.</br>There is no undo.",icon:Ext.Msg.QUESTION,buttons:Ext.Msg.YESNO,scope:this,fn:function(f){if("yes"!==f){return}this.getEl().mask("Execute rule ... ");var g=[];g.push(a.get("id"));Ext.Ajax.request({waitMsg:"Please Wait",url:"camm_db_admin.php",method:"POST",timeout:240000,scope:this,callback:cacti.plugin.camm.requestCallback,params:{task:"camm_execute_rule",id:Ext.encode(g)}})}});break;case"clone":Ext.Msg.show({title:"Clone Rule ?",msg:"Please, enter name for new rule",icon:Ext.Msg.INFO,buttons:Ext.Msg.OKCANCEL,prompt:true,value:a.get("name")+"(clone)",scope:this,fn:function(g,f){if("ok"!==g){return}this.getEl().mask("Clone rule ... ");var h=[];h.push(a.get("id"));Ext.Ajax.request({waitMsg:"Please Wait",url:"camm_db_admin.php",method:"POST",timeout:30000,scope:this,callback:cacti.plugin.camm.requestCallback,params:{task:"camm_clone_rule",n_name:f,id:Ext.encode(h)}})}});break}}else{Ext.Msg.alert("error","You do not have rigth for this action")}},commitChanges:function(){var a=this.store.getModifiedRecords();if(!a.length){return}this.getEl().mask("saving");var b=[];Ext.each(a,function(e,d){var f=e.getChanges();if(e.data.newRecord){f.newRecord=true}f[this.idName]=e.get(this.idName);b.push(f)},this);var c={url:"camm_db_admin.php",method:"POST",callback:cacti.plugin.camm.requestCallback,scope:this,params:{task:"camm_save_rule",objName:this.objName,data:Ext.encode(b)}};Ext.Ajax.request(c)},deleteRecord:function(a){var b=this;Ext.Msg.show({title:"Delete record?",msg:"Do you really want to delete <b>"+a.get("name")+"</b><br/>There is no undo.",icon:Ext.Msg.QUESTION,buttons:Ext.Msg.YESNO,scope:this,fn:function(c){if("yes"!==c){return}this.getEl().mask("Deleting rule ... ");var d=[];d.push(a.get("id"));Ext.Ajax.request({waitMsg:"Please Wait",url:"camm_db_admin.php",method:"POST",scope:b,callback:cacti.plugin.camm.requestCallback,params:{task:"camm_delete_rule",id:Ext.encode(d)}})}})}});Ext.reg("RulesGrid",cacti.plugin.camm.rules_tab_rules_grid);cacti.plugin.camm.rule_tab=Ext.extend(Ext.Panel,{title:"Rules",layout:"border",closable:false,initComponent:function(){this.nettp_type_store=new Ext.data.SimpleStore({fields:["label","value"],data:[["camm","camm"],["syslog","syslog"]]}),this.rulesfilterCfg=[{id:"name",label:"name"},{id:"rule_type",label:"type",type:"string",availableValues:this.nettp_type_store,remoteStore:false},{id:"message",label:"FormatLine"},{id:"user",label:"user"},{id:"email",label:"email"},{id:"notes",label:"notes"},{id:"date",label:"date",type:"date",format:"Y-m-d H:i:s"}],this.rulesfieldManager=new Ext.ux.netbox.core.FieldManager(this.rulesfilterCfg),this.rulesfilterModel=new Ext.ux.netbox.core.FilterModel(this.rulesfieldManager),this.ruleslocalFilterResolver=new Ext.ux.netbox.core.LocalStoreFilterResolver(this.rulesfilterModel);Ext.apply(this,{items:[{id:"pn_rule_filter_grid",stateid:"stateid_panel_rile_grid",layout:"fit",title:"Global Search (in database)",height:195,region:"north",split:false,collapsible:true,collapseMode:"mini",animCollapse:true,animate:true,collapsed:true,items:[{filterModel:this.rulesfilterModel,id:"rulesfilter",colsNumber:3,labelWidth:45,labelAlign:"top",rowSize:40,ratio:33,labelPad:1,xtype:"staticFilter",itemCls:"filter",buttonAlign:"center",buttons:[{text:"Apply Filter",listeners:{click:{scope:this,fn:function(){this.apllyFilter()}}}},{text:"Clear Filter",listeners:{click:{scope:this,fn:function(){this.clearFilter()}}}}]}]},{xtype:"RulesGrid",region:"center",stateid:"stateid_rile_grid",plugins:[new Ext.ux.netbox.core.FilterHeaderPlugin(this.rulesfilterModel)]}]});cacti.plugin.camm.rule_tab.superclass.initComponent.apply(this,arguments);this.filterPanel=this.items.itemAt(0);this.gridPanel=this.items.itemAt(1);this.gridstore=this.gridPanel.store;this.gridPanel.on({scope:this,render:function(){this.gridstore.on({scope:this,beforeload:function(){this.gridstore.baseParams={filter:Ext.util.JSON.encode(this.rulesfilterModel.getFilterObj()),task:"camm_get_rules_records"}}})}})},afterRender:function(){cacti.plugin.camm.rule_tab.superclass.afterRender.apply(this,arguments)},apllyFilter:function(){this.gridstore.load({params:{start:0,limit:50}})},clearFilter:function(){this.rulesfilterModel.setFilterObj(null);this.gridstore.load({params:{start:0,limit:50}})}});Ext.reg("rule_tab",cacti.plugin.camm.rule_tab);Ext.ns("cacti.plugin.camm");cacti.plugin.camm.syslogtab_grid=Ext.extend(cacti.plugin.camm.def_grid,{id:"sysl_tab_sysl_grid_id",initComponent:function(){this.win_FullSysMes=new cacti.plugin.camm.SysMesWin();this.rowActions=new Ext.ux.grid.RowActions({header:"Actions",actions:[{iconCls:"icon-edit-magnifier",qtip:"Edit Record"},{iconCls:"x-icon-modify",qtip:"create rule based on this message"}],widthIntercept:Ext.isSafari?4:2,id:"syslog_actions"});this.rowActions.on("action",this.onRowAction,this);this.selmod=new Ext.grid.CheckboxSelectionModel();Ext.apply(this,{store:new Ext.data.GroupingStore({storeId:"SyslogDataStore",proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"results",totalProperty:"total",id:"id"},[{name:"id",type:"int",mapping:"id"},{name:"device_id",type:"int",mapping:"device_id"},{name:"description",type:"string",mapping:"description"},{name:"facility",type:"string",mapping:"facility"},{name:"priority",type:"string",mapping:"priority"},{name:"sys_date",type:"date",mapping:"sys_date",dateFormat:"Y-m-d H:i:s"},{name:"host",type:"string",mapping:"host"},{name:"message",type:"string",mapping:"message"},{name:"status",type:"int",mapping:"status"},{name:"rule_id",type:"string",mapping:"rule_id"},{name:"add",type:"string",mapping:"add"}]),baseParams:{task:"camm_get_syslog_records",tree_id:"root",filter:""},sortInfo:{field:"sys_date",direction:"DESC"}}),cm:new Ext.grid.ColumnModel([this.selmod,this.rowActions,{header:"id",dataIndex:"id",width:60,hidden:true,sortable:true},{header:"device id",dataIndex:"device_id",width:60,hidden:true},{header:"Description",dataIndex:"description",width:210},{header:"host",dataIndex:"host",width:100},{header:"facility",dataIndex:"facility",width:140},{header:"priority",dataIndex:"priority",width:100},{header:"DateTime",dataIndex:"sys_date",renderer:Ext.util.Format.dateRenderer("Y-m-d H:i:s"),width:125},{id:"formatlinecolumn",header:"Message",dataIndex:"message",width:380},{header:"Rule",dataIndex:"rule_id",renderer:this.rendalert,width:58},{header:"Additional",dataIndex:"add",width:180,hidden:true}]),view:new Ext.grid.GroupingView({forceFit:true,getRowClass:function(d,b){var a="";var c=Ext.util.Format.lowercase(d.data.priority);switch(c){case"emergency":case"emerg":a="emergency-row";break;case"critical":case"crit":a="critical-row";break;case"notice":a="notice-row";break;case"info":a="info-row";break;case"debug":a="debug-row";break;case"warning":case"warn":a="warning-row";break;case"alert":a="alert-row";break;case"error":case"err":a="error-row";break}return a},onLoad:Ext.emptyFn,listeners:{beforerefresh:function(a){a.scrollTop=a.scroller.dom.scrollTop;a.scrollHeight=a.scroller.dom.scrollHeight},refresh:function(a){a.scroller.dom.scrollTop=a.scrollTop+(a.scrollTop==0?0:a.scroller.dom.scrollHeight-a.scrollHeight)}},groupTextTpl:'{text} ({[values.rs.length]} {[values.rs.length > 1 ? "Items" : "Item"]})'}),selModel:this.selmod,viewConfig:{forceFit:true},columns:this.rowActions,plugins:[this.rowActions,new Ext.ux.plugins.CheckBoxMemory()],enableColLock:false,layout:"fit",autoExpandColumn:"formatlinecolumn",loadMask:true,footer:true,tbar:[{text:"Actions",tooltip:"Actions with selected rows",menu:new Ext.menu.Menu({id:"sys_mainMenu",items:[{text:"Delete selected rows",id:"0",tooltip:"Delete selected rows",scope:this,handler:this.DeleteRecord,iconCls:"icon-minus",disabled:!(is_camm_admin==1)}]}),iconCls:"blist"}]});cacti.plugin.camm.syslogtab_grid.superclass.initComponent.apply(this,arguments)},onRender:function(){cacti.plugin.camm.syslogtab_grid.superclass.onRender.apply(this,arguments);this.bottomToolbar.plugins["1"].setPageSize(camm_start_var.camm_num_rows||50);this.bottomToolbar.plugins["0"].public_update(parseFloat(camm_start_var.camm_sys_tab_update)||0);this.on({scope:this,celldblclick:function(b,c){var a=this.store.getAt(c);this.win_FullSysMes.showSys({rec_id:a.data.id})}})},rendalert:function(e,a,b,f,d,c){if(b.data.status==0){a.css="record_new"}return e},onRowAction:function(c,a,d,e,b){switch(d){case"icon-edit-magnifier":this.win_FullSysMes.showSys({rec_id:a.data.id});break;case"x-icon-modify":if(is_camm_admin==1){MainTabs.activate("rule_tab_id");var f=MainTabs.items.item("rule_tab_id").items.item("rules_tab_rules_grid_id");if(f.getStore().getCount()==0){f.getStore().on("load",function(){MainTabs.items.item("rule_tab_id").items.item("rules_tab_rules_grid_id").win_addRule.showtab({mode:"add_on_sys",rec:a})},false,{single:true})}else{f.win_addRule.showtab({mode:"add_on_sys",rec:a})}}else{Ext.Msg.alert("error","You do not have rigth for this action")}break}},DeleteRecord:function(){var a=this.selModel;var b=this;if(a.getCount()>=1){Ext.Msg.show({title:"Delete record?",msg:"Do you really want to delete selected messages? There is no undo.",icon:Ext.Msg.QUESTION,buttons:Ext.Msg.YESNO,scope:this,fn:function(c){if("yes"!==c){return}this.getEl().mask("Deleting messages ... ");var d=a.getSelections();var f=[];for(i=0;i<a.getCount();i++){f.push(d[i].json.id)}var e=Ext.encode(f);Ext.Ajax.request({scope:b,url:"camm_db_admin.php",method:"POST",params:{task:"camm_delete_syslog_message",ids:e},callback:cacti.plugin.camm.requestCallback})}})}else{Ext.MessageBox.alert("Uh oh...","You must select at least one trap.")}}});Ext.reg("syslogGrid",cacti.plugin.camm.syslogtab_grid);cacti.plugin.camm.syslog_tab=Ext.extend(Ext.Panel,{title:"syslog",layout:"border",closable:false,initComponent:function(){this.camm_facility_store=new Ext.data.Store({autoLoad:false,proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"names"},[{name:"label"},{name:"value"}]),baseParams:{task:"camm_get_facilitys"}});this.camm_priority_store=new Ext.data.Store({autoLoad:false,proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"names"},[{name:"label"},{name:"value"}]),baseParams:{task:"camm_get_prioritys"}});this.syslogfilterCfg=[{id:"facility",label:"Facility",type:"string",availableValues:this.camm_facility_store,remoteStore:true},{id:"host",label:"hostname"},{id:"sys_date",label:"DateTime",type:"date",format:"Y-m-d H:i:s"},{id:"priority",label:"Priority",type:"string",availableValues:this.camm_priority_store,remoteStore:true},{id:"message",label:"Message"}],this.syslogfieldManager=new Ext.ux.netbox.core.FieldManager(this.syslogfilterCfg),this.syslogfilterModel=new Ext.ux.netbox.core.FilterModel(this.syslogfieldManager),this.sysloglocalFilterResolver=new Ext.ux.netbox.core.LocalStoreFilterResolver({filterModel:this.syslogfilterModel}),Ext.apply(this,{items:[{id:"pn_syslog_filter_grid",stateid:"stateid_panel_syslog_grid",layout:"fit",title:"Global Search (in database)",height:155,region:"north",split:false,collapsible:true,collapseMode:"mini",animCollapse:true,animate:true,collapsed:true,titleCollapse:true,items:[{filterModel:this.syslogfilterModel,id:"syslogfilter",colsNumber:3,labelWidth:45,labelAlign:"top",rowSize:40,ratio:33,labelPad:1,xtype:"staticFilter",itemCls:"filter",buttonAlign:"center",buttons:[{text:"Apply Filter",listeners:{click:{scope:this,fn:function(){this.apllyFilter()}}}},{text:"Clear Filter",listeners:{click:{scope:this,fn:function(){this.clearFilter()}}}}]}]},{xtype:"syslogGrid",region:"center",stateid:"stateid_syslog_grid",plugins:[new Ext.ux.netbox.core.FilterHeaderPlugin(this.syslogfilterModel)]},{xtype:"SyslogTGMenu",layout:"fit",width:"20%",minSize:220,maxSize:500,collapsible:true,collapseMode:"mini",animCollapse:true,region:"west"}]});cacti.plugin.camm.syslog_tab.superclass.initComponent.apply(this,arguments);this.gridPanel=this.items.itemAt(1);this.gridstore=this.gridPanel.store},afterRender:function(){cacti.plugin.camm.syslog_tab.superclass.afterRender.apply(this,arguments)},apllyFilter:function(){Ext.apply(this.gridstore.baseParams,{filter:Ext.util.JSON.encode(this.syslogfilterModel.getFilterObj())});this.gridstore.load({params:{start:0}})},clearFilter:function(){this.syslogfilterModel.setFilterObj(null);Ext.apply(this.gridstore.baseParams,{filter:null});this.gridstore.load({params:{start:0}})}});Ext.reg("syslog_tab",cacti.plugin.camm.syslog_tab);cacti.plugin.camm.SyslogTGMenu=Ext.extend(Ext.ux.maximgb.tg.GridPanel,{tree_id:"0",id:"id_SyslogTGMenu",initComponent:function(){this.tree_change=true;this.PercColumn=new Ext.ux.grid.ProgressColumn({header:"Percent",dataIndex:"perc",width:60,sortable:true,textPst:"%",colored:true});Ext.apply(this,{rootId:"0",store:new Ext.ux.maximgb.tg.AdjacencyListStore({autoLoad:false,rootId:"0",proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),baseParams:{task:"camm_get_topstat",type:"syslog",period:"all"},reader:new Ext.data.JsonReader({id:"_id",root:"data",totalProperty:"total",successProperty:"success"},[{name:"label"},{name:"hostname"},{name:"host_id",type:"int"},{name:"count",type:"int"},{name:"perc",type:"float"},{name:"_id",type:"auto"},{name:"_lvl",type:"auto"},{name:"_parent",type:"auto"},{name:"_is_leaf",type:"bool"}])}),master_column_id:"label",columns:[{header:"Type, Host, Event",width:130,id:"label",css:"padding-top:0px ! important;",renderer:this.rendmaster,sortable:true,dataIndex:"label"},{header:"Count",width:85,sortable:true,hidden:true,dataIndex:"count"},this.PercColumn],loadMask:true,stripeRows:true,autoExpandColumn:"label",viewConfig:{emptyText:"No rows to display"},plugins:[this.PercColumn,new Ext.ux.plugins.TreeGridStatefull({cp:Ext.state.Manager.getProvider()})],root_title:"",tbar:[new Ext.CycleButton({showText:true,prependText:"Period: ",items:[{text:"all",checked:true},{text:"week"},{text:"day"},{text:"hour"}],changeHandler:function(b,c){var a=this.getStore();Ext.apply(a.baseParams,{period:c.text});a.load({params:{period:c.text,anode:null,applySort:false}})},scope:this}),"->",{text:"refresh",iconCls:"x-tbar-loading",handler:function(){var a=this.getStore();a.reload({params:{anode:null}})},scope:this},"-",{text:"recreate",handler:function(){this.recreate_menu()},scope:this}]});cacti.plugin.camm.SyslogTGMenu.superclass.initComponent.apply(this,arguments)},onRender:function(){this.setSize(camm_start_var.camm_tree_menu_width);cacti.plugin.camm.SyslogTGMenu.superclass.onRender.apply(this,arguments);var a=Ext.getCmp("sysl_tab_sysl_grid_id");this.getStore().reload();a.getStore().reload({params:{start:0}});this.on({scope:this,cellclick:function(b,h,f,d){var j=b.getStore();var c=j.getAt(h);var k=b.getColumnModel().getDataIndex(f);if(k=="label"){var l=Ext.getCmp("sysl_tab_sysl_grid_id");if(!Ext.ux.Utility.isNullOrUndefined(l)){var g=l.getStore();delete g.baseParams.filter_chart;delete g.baseParams.rule_id;Ext.apply(g.baseParams,{tree_id:c.data._id});g.load({params:{start:0}})}}},rowcontextmenu:function(b,f,d){d.stopEvent();b.cm_rowIndex=f;if(!b.cmenu){b.cmenu=get_cmenu(b);b.cmenu.render();b.on({beforedestroy:function(e){e.cmenu.destroy()}})}var c=d.getXY();b.cmenu.showAt(c)}});this.store.on({scope:this,exception:cacti.plugin.camm.loadexception})},recreate_menu:function(){if(is_camm_admin==1){this.getEl().mask("ReCreate menu");Ext.Ajax.request({scope:this,url:"camm_db_admin.php",method:"POST",timeout:120000,params:{task:"camm_recreate_tree",type:"syslog"},callback:cacti.plugin.camm.requestCallback})}else{Ext.Msg.alert("error","You do not have rigth for this action")}},rendmaster:function(c,a,b){if(b.data._is_leaf==1){n_data='<div class="ux-maximgb-treegrid-detail"> </div><div  style="padding-left: 18px;">'+b.data.label+"</div>"}else{n_data=b.data.label}return n_data},rendperc:function(c,a,b){if(b.data._lvl==3){return c}else{return c}}});Ext.reg("SyslogTGMenu",cacti.plugin.camm.SyslogTGMenu);Ext.ns("cacti.plugin.camm");cacti.plugin.camm.trapstab_grid=Ext.extend(cacti.plugin.camm.def_grid,{id:"trap_tab_trap_grid_id",initComponent:function(){this.win_FullTrap=new cacti.plugin.camm.TrapWin();this.rowActions=new Ext.ux.grid.RowActions({header:"Actions",actions:[{iconCls:"icon-edit-magnifier",qtip:"Edit Record"},{iconCls:"x-icon-modify",qtip:"create rule based on this trap"}],widthIntercept:Ext.isSafari?4:2,id:"traps_actions"});this.rowActions.on("action",this.onRowAction,this);this.selmod=new Ext.grid.CheckboxSelectionModel();Ext.apply(this,{store:new Ext.data.GroupingStore({id:"TrpDataStore",proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"results",totalProperty:"total",id:"id"},[{name:"id",type:"int",mapping:"id"},{name:"device_id",type:"int",mapping:"device_id"},{name:"description",type:"string",mapping:"description"},{name:"eventname",type:"string",mapping:"eventname"},{name:"eventid",type:"string",mapping:"eventid"},{name:"trapoid",type:"string",mapping:"trapoid"},{name:"enterprise",type:"string",mapping:"enterprise"},{name:"community",type:"string",mapping:"community"},{name:"category",type:"string",mapping:"category"},{name:"hostname",type:"string",mapping:"hostname"},{name:"severity",type:"string",mapping:"severity"},{name:"traptime",type:"date",mapping:"traptime",dateFormat:"Y-m-d H:i:s"},{name:"formatline",type:"string",mapping:"formatline"},{name:"status",type:"int",mapping:"status"},{name:"rule_id",type:"string",mapping:"rule_id"},{name:"add",type:"string",mapping:"add"}]),baseParams:{task:"camm_get_traps_records",tree_id:"root",filter:""},sortInfo:{field:"traptime",direction:"DESC"}}),cm:new Ext.grid.ColumnModel([this.selmod,this.rowActions,{header:"id",dataIndex:"id",width:60,hidden:true},{header:"device id",dataIndex:"device_id",width:60,hidden:true},{header:"Description",readOnly:true,dataIndex:"description",width:210},{header:"EventName",readOnly:true,dataIndex:"eventname",width:140},{header:"EventId",dataIndex:"eventid",width:100,hidden:true},{header:"TrapOid",hidden:true,dataIndex:"trapoid",width:100},{header:"Enterprise",hidden:true,dataIndex:"enterprise",width:100},{header:"Community",hidden:true,dataIndex:"community",width:100},{header:"Category",hidden:true,dataIndex:"category",width:100},{header:"HostName",dataIndex:"hostname",width:110},{header:"Severity",dataIndex:"severity",width:60},{header:"Trap Time",readOnly:true,dataIndex:"traptime",renderer:Ext.util.Format.dateRenderer("Y-m-d H:i:s"),width:125},{id:"formatlinecolumn",header:"Message",dataIndex:"formatline",width:380,readOnly:true},{header:"Rule",dataIndex:"rule_id",renderer:this.rendalert,width:58},{header:"Additional",dataIndex:"add",width:180,hidden:true}]),view:new Ext.grid.GroupingView({forceFit:true,getRowClass:function(d,b){var a="";var c=Ext.util.Format.lowercase(d.data.severity);switch(c){case"normal":a="info-row";break;case"warning":case"warn":a="warning-row";break;case"major":a="error-row";break}return a},groupTextTpl:'{text} ({[values.rs.length]} {[values.rs.length > 1 ? "Items" : "Item"]})'}),selModel:this.selmod,viewConfig:{forceFit:true},columns:this.rowActions,plugins:[this.rowActions,new Ext.ux.plugins.CheckBoxMemory()],enableColLock:false,layout:"fit",autoExpandColumn:"formatlinecolumn",loadMask:true,footer:true,tbar:[{text:"Actions",tooltip:"Actions with selected rows",menu:new Ext.menu.Menu({id:"traps_mainMenu",items:[{text:"Delete selected rows",id:"0",tooltip:"Delete selected rows",scope:this,handler:this.DeleteRecord,iconCls:"icon-minus",disabled:!(is_camm_admin==1)}]}),iconCls:"blist"}]});cacti.plugin.camm.trapstab_grid.superclass.initComponent.apply(this,arguments)},onRender:function(){cacti.plugin.camm.trapstab_grid.superclass.onRender.apply(this,arguments);this.bottomToolbar.plugins["1"].setPageSize(camm_start_var.camm_num_rows||50);this.bottomToolbar.plugins["0"].public_update(parseFloat(camm_start_var.camm_trap_tab_update)||0);this.on({scope:this,celldblclick:function(b,c){var a=this.store.getAt(c);this.win_FullTrap.showTrap({rec_id:a.data.id})}})},rendalert:function(e,a,b,f,d,c){if(b.data.status==0){a.css="record_new"}return e},onRowAction:function(c,a,d,e,b){switch(d){case"icon-edit-magnifier":this.win_FullTrap.showTrap({rec_id:a.data.id});break;case"x-icon-modify":if(is_camm_admin==1){MainTabs.activate("rule_tab_id");var f=MainTabs.items.item("rule_tab_id").items.item("rules_tab_rules_grid_id");if(f.getStore().getCount()==0){f.getStore().on("load",function(){MainTabs.items.item("rule_tab_id").items.item("rules_tab_rules_grid_id").win_addRule.showtab({mode:"add_on_trap",rec:a})},false,{single:true})}else{f.win_addRule.showtab({mode:"add_on_trap",rec:a})}}else{Ext.Msg.alert("error","You do not have rigth for this action")}break}},DeleteRecord:function(){var b=this.selModel;var a=this;if(b.getCount()>=1){Ext.MessageBox.confirm("Confirmation","Are you sure you want to delete the following traps?",function(c){if(c=="yes"){var d=b.getSelections();var f=[];for(i=0;i<b.getCount();i++){f.push(d[i].json.id)}var e=Ext.encode(f);Ext.Ajax.request({scope:a,waitMsg:"Please Wait",url:"camm_db_admin.php",method:"POST",params:{task:"camm_delete_traps",ids:e},callback:cacti.plugin.camm.requestCallback})}})}else{Ext.MessageBox.alert("Uh oh...","You must select at least one trap.")}}});Ext.reg("TrapsGrid",cacti.plugin.camm.trapstab_grid);cacti.plugin.camm.traps_tab=Ext.extend(Ext.Panel,{title:"Traps",layout:"border",closable:false,initComponent:function(){this.camm_eventname_store=new Ext.data.Store({autoLoad:false,proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"names"},[{name:"label"},{name:"value"}]),baseParams:{task:"camm_get_eventnames"}});this.camm_severity_store=new Ext.data.Store({autoLoad:false,proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"names"},[{name:"label"},{name:"value"}]),baseParams:{task:"camm_get_severites"}});this.trapsfilterCfg=[{id:"eventname",label:"eventname",type:"string",availableValues:this.camm_eventname_store,remoteStore:true},{id:"hostname",label:"hostname"},{id:"severity",label:"severity",type:"string",availableValues:this.camm_severity_store,remoteStore:true},{id:"traptime",label:"traptime",type:"date",format:"Y-m-d H:i:s"},{id:"formatline",label:"formatline"}],this.trapsfieldManager=new Ext.ux.netbox.core.FieldManager(this.trapsfilterCfg),this.trapsfilterModel=new Ext.ux.netbox.core.FilterModel(this.trapsfieldManager),this.trapslocalFilterResolver=new Ext.ux.netbox.core.LocalStoreFilterResolver(this.trapsfilterModel);Ext.apply(this,{items:[{id:"pn_traps_filter_grid",stateid:"stateid_panel_traps_grid",layout:"fit",title:"Global Search (in database)",height:155,region:"north",split:false,collapsible:true,collapseMode:"mini",animCollapse:true,animate:true,collapsed:true,items:[{filterModel:this.trapsfilterModel,id:"trapsfilter",colsNumber:3,labelWidth:45,labelAlign:"top",rowSize:40,ratio:33,labelPad:1,xtype:"staticFilter",itemCls:"filter",buttonAlign:"center",buttons:[{text:"Apply Filter",listeners:{click:{scope:this,fn:function(){this.apllyFilter()}}}},{text:"Clear Filter",listeners:{click:{scope:this,fn:function(){this.clearFilter()}}}}]}]},{xtype:"TrapsGrid",region:"center",stateid:"stateid_traps_grid",plugins:[new Ext.ux.netbox.core.FilterHeaderPlugin(this.trapsfilterModel)]},{xtype:"TrapsTGMenu",width:"20%",minSize:220,maxSize:500,collapsible:true,collapseMode:"mini",animCollapse:true,region:"west"}]});cacti.plugin.camm.traps_tab.superclass.initComponent.apply(this,arguments);this.gridPanel=this.items.itemAt(1);this.gridstore=this.gridPanel.store},afterRender:function(){cacti.plugin.camm.traps_tab.superclass.afterRender.apply(this,arguments)},apllyFilter:function(){Ext.apply(this.gridstore.baseParams,{filter:Ext.util.JSON.encode(this.trapsfilterModel.getFilterObj())});this.gridstore.load({params:{start:0}})},clearFilter:function(){this.trapsfilterModel.setFilterObj(null);Ext.apply(this.gridstore.baseParams,{filter:null});this.gridstore.load({params:{start:0}})}});Ext.reg("traps_tab",cacti.plugin.camm.traps_tab);cacti.plugin.camm.TrapsTGMenu=Ext.extend(Ext.ux.maximgb.tg.GridPanel,{tree_id:"1",id:"id_TrapsTGMenu",initComponent:function(){this.tree_change=true;this.PercColumn=new Ext.ux.grid.ProgressColumn({header:"Percent",dataIndex:"perc",width:60,sortable:true,textPst:"%",colored:true});Ext.apply(this,{rootId:"0",store:new Ext.ux.maximgb.tg.AdjacencyListStore({autoLoad:false,rootId:"0",proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),baseParams:{task:"camm_get_topstat",type:"snmptt",period:"all"},reader:new Ext.data.JsonReader({id:"_id",root:"data",totalProperty:"total",successProperty:"success"},[{name:"label"},{name:"hostname"},{name:"host_id",type:"int"},{name:"count",type:"int"},{name:"perc",type:"float"},{name:"_id",type:"auto"},{name:"_lvl",type:"auto"},{name:"_parent",type:"auto"},{name:"_is_leaf",type:"bool"}])}),master_column_id:"label",columns:[{header:"Type, Host, Event",width:130,id:"label",css:"padding-top:0px ! important;",renderer:this.rendmaster,sortable:true,dataIndex:"label"},{header:"Count",width:85,sortable:true,hidden:true,dataIndex:"count"},this.PercColumn],loadMask:true,stripeRows:true,autoExpandColumn:"label",viewConfig:{emptyText:"No rows to display"},plugins:[this.PercColumn,new Ext.ux.plugins.TreeGridStatefull({cp:Ext.state.Manager.getProvider()})],root_title:"",tbar:[new Ext.CycleButton({showText:true,prependText:"Period: ",items:[{text:"all",checked:true},{text:"week"},{text:"day"},{text:"hour"}],changeHandler:function(b,c){var a=this.getStore();Ext.apply(a.baseParams,{period:c.text});a.load({params:{period:c.text,anode:null,applySort:false}})},scope:this}),"->",{text:"refresh",iconCls:"x-tbar-loading",handler:function(){var a=this.getStore();a.reload({params:{anode:null}})},scope:this},"-",{text:"recreate",handler:function(){this.recreate_menu()},scope:this}]});cacti.plugin.camm.TrapsTGMenu.superclass.initComponent.apply(this,arguments)},onRender:function(){this.setSize(camm_start_var.camm_tree_menu_width);cacti.plugin.camm.TrapsTGMenu.superclass.onRender.apply(this,arguments);var a=Ext.getCmp("trap_tab_trap_grid_id");this.getStore().reload();a.getStore().reload({params:{start:0}});this.on({scope:this,cellclick:function(b,j,g,f){var k=b.getStore();var c=k.getAt(j);var l=b.getColumnModel().getDataIndex(g);if(l=="label"){var d=Ext.getCmp("trap_tab_trap_grid_id");if(!Ext.ux.Utility.isNullOrUndefined(d)){var h=sys_grid.getStore();delete h.baseParams.filter_chart;delete h.baseParams.rule_id;Ext.apply(h.baseParams,{tree_id:c.data._id});h.load({params:{start:0}})}}},rowcontextmenu:function(b,f,d){d.stopEvent();b.cm_rowIndex=f;if(!b.cmenu){b.cmenu=get_cmenu(b);b.cmenu.render();b.on({beforedestroy:function(e){e.cmenu.destroy()}})}var c=d.getXY();b.cmenu.showAt(c)}});this.store.on({scope:this,exception:cacti.plugin.camm.loadexception})},recreate_menu:function(){if(is_camm_admin==1){this.getEl().mask("ReCreate menu");Ext.Ajax.request({scope:this,url:"camm_db_admin.php",method:"POST",timeout:120000,params:{task:"camm_recreate_tree",type:"traps"},callback:cacti.plugin.camm.requestCallback})}else{Ext.Msg.alert("error","You do not have rigth for this action")}},rendmaster:function(c,a,b){if(b.data._is_leaf==1){n_data='<div class="ux-maximgb-treegrid-detail"> </div><div  style="padding-left: 18px;">'+b.data.label+"</div>"}else{n_data=b.data.label}return n_data},rendperc:function(c,a,b){if(b.data._lvl==3){return c}else{return c}}});Ext.reg("TrapsTGMenu",cacti.plugin.camm.TrapsTGMenu);Ext.ns("cacti.plugin.camm");cacti.plugin.camm.unknown_tab_grid=Ext.extend(cacti.plugin.camm.def_grid,{id:"unk_tab_unk_grid_id",initComponent:function(){this.win_FullUnkTrap=new cacti.plugin.camm.UnkTrapWin();this.rowActions=new Ext.ux.grid.RowActions({header:"Actions",actions:[{iconCls:"icon-edit-magnifier",qtip:"Edit Record"}],widthIntercept:Ext.isSafari?4:2,id:"unktraps_actions"});this.rowActions.on("action",this.onRowAction,this);this.selmod=new Ext.grid.CheckboxSelectionModel();Ext.apply(this,{store:new Ext.data.GroupingStore({proxy:new Ext.data.HttpProxy({url:"camm_db.php",method:"POST"}),reader:new Ext.data.JsonReader({root:"results",totalProperty:"total",id:"id"},[{name:"id",type:"int",mapping:"id"},{name:"trapoid",type:"string",mapping:"trapoid"},{name:"enterprise",type:"string",mapping:"enterprise"},{name:"community",type:"string",mapping:"community"},{name:"hostname",type:"string",mapping:"hostname"},{name:"agentip",type:"string",mapping:"agentip"},{name:"traptime",type:"date",mapping:"traptime",dateFormat:"Y-m-d H:i:s"},{name:"formatline",type:"string",mapping:"formatline"}]),sortInfo:{field:"traptime",direction:"DESC"},baseParams:{task:"camm_get_unktraps_records",filter:""}}),cm:new Ext.grid.ColumnModel([this.selmod,this.rowActions,{header:"trapoid",sortable:true,dataIndex:"trapoid",width:120},{header:"enterprise",sortable:true,dataIndex:"enterprise",width:100},{header:"community",dataIndex:"community",sortable:true,hidden:true,width:110},{header:"hostname",dataIndex:"hostname",sortable:true,width:80},{header:"agentip",dataIndex:"agentip",sortable:true,width:80},{header:"Trap Time",readOnly:true,sortable:true,dataIndex:"traptime",renderer:Ext.util.Format.dateRenderer("Y-m-d H:i:s"),width:125},{id:"formatlinecolumn",header:"Format Line",dataIndex:"formatline",sortable:true,width:380,readOnly:true}]),view:new Ext.grid.GroupingView({forceFit:true,groupTextTpl:'{text} ({[values.rs.length]} {[values.rs.length > 1 ? "Items" : "Item"]})'}),selModel:this.selmod,viewConfig:{forceFit:true},plugins:[this.rowActions,new Ext.ux.plugins.CheckBoxMemory()],enableColLock:false,layout:"fit",autoExpandColumn:"formatlinecolumn",loadMask:true,footer:true,tbar:[{text:"Actions",tooltip:"Actions with selected rows",menu:new Ext.menu.Menu({id:"mainMenu",items:[{text:"Delete selected rows",tooltip:"Delete selected rows",iconCls:"icon-minus",scope:this,disabled:!(is_camm_admin==1),handler:this.DeleteRecord}]}),iconCls:"blist"}]});cacti.plugin.camm.unknown_tab_grid.superclass.initComponent.apply(this,arguments)},onRender:function(){cacti.plugin.camm.unknown_tab_grid.superclass.onRender.apply(this,arguments);this.bottomToolbar.plugins["1"].setPageSize(camm_start_var.camm_num_rows||0);this.bottomToolbar.plugins["0"].public_update(parseFloat(camm_start_var.camm_unktrap_tab_update)||0);this.on({scope:this,celldblclick:function(b,c){var a=this.store.getAt(c);this.win_FullUnkTrap.showTrap({rec_id:a.data.id})}})},onRowAction:function(c,a,d,e,b){switch(d){case"icon-edit-magnifier":this.win_FullUnkTrap.showTrap({rec_id:a.data.id});break}},DeleteRecord:function(){var a=this.selModel;var b=this;if(a.getCount()>=1){Ext.MessageBox.confirm("Confirmation","Are you sure you want to delete the following traps?",function(c){if(c=="yes"){var d=a.getSelections();var f=[];for(i=0;i<a.getCount();i++){f.push(d[i].json.id)}var e=Ext.encode(f);Ext.Ajax.request({waitMsg:"Please Wait",url:"camm_db_admin.php",method:"POST",scope:b,params:{task:"camm_delete_unktraps",ids:e},callback:cacti.plugin.camm.requestCallback})}})}else{Ext.MessageBox.alert("Uh oh...","You must select at least one trap.")}}});Ext.reg("UnkTrapsGrid",cacti.plugin.camm.unknown_tab_grid);cacti.plugin.camm.unktraps_tab=Ext.extend(Ext.Panel,{title:"Unknown Traps",layout:"border",closable:false,initComponent:function(){this.unktrapsfilterCfg=[{id:"trapoid",label:"trapoid"},{id:"enterprise",label:"enterprise"},{id:"community",label:"community"},{id:"hostname",label:"hostname"},{id:"agentip",label:"agentip"},{id:"traptime",label:"traptime",type:"date",format:"Y-m-d H:i:s"},{id:"formatline",label:"formatline"}],this.unktrapsfieldManager=new Ext.ux.netbox.core.FieldManager(this.unktrapsfilterCfg),this.unktrapsfilterModel=new Ext.ux.netbox.core.FilterModel(this.unktrapsfieldManager),this.unktrapslocalFilterResolver=new Ext.ux.netbox.core.LocalStoreFilterResolver(this.unktrapsfilterModel);Ext.apply(this,{items:[{id:"pn_unktraps_filter_grid",stateid:"stateid_panel_unktraps_grid",layout:"fit",title:"Global Search (in database)",height:195,region:"north",split:false,collapsible:true,collapseMode:"mini",animCollapse:true,animate:true,collapsed:true,items:[{filterModel:this.unktrapsfilterModel,id:"unktrapsfilter",colsNumber:3,labelWidth:45,labelAlign:"top",rowSize:40,ratio:33,labelPad:1,xtype:"staticFilter",itemCls:"filter",buttonAlign:"center",buttons:[{text:"Apply Filter",listeners:{click:{scope:this,fn:function(){this.apllyFilter()}}}},{text:"Clear Filter",listeners:{click:{scope:this,fn:function(){this.clearFilter()}}}}]}]},{xtype:"UnkTrapsGrid",region:"center",stateid:"stateid_unktraps_grid",plugins:[new Ext.ux.netbox.core.FilterHeaderPlugin(this.unktrapsfilterModel)]}]});cacti.plugin.camm.unktraps_tab.superclass.initComponent.apply(this,arguments);this.filterPanel=this.items.itemAt(0);this.gridPanel=this.items.itemAt(1);this.gridstore=this.gridPanel.store;this.gridPanel.on({scope:this,render:function(){this.gridstore.on({scope:this,beforeload:function(){Ext.apply(this.gridstore.baseParams,{filter:Ext.util.JSON.encode(this.unktrapsfilterModel.getFilterObj()),limit:this.gridPanel.bottomToolbar.getPageSize()})}});if(this.gridstore.getTotalCount()==0){this.gridstore.load({params:{start:0}})}}})},afterRender:function(){cacti.plugin.camm.unktraps_tab.superclass.afterRender.apply(this,arguments)},apllyFilter:function(){this.gridstore.load({params:{start:0}})},clearFilter:function(){this.unktrapsfilterModel.setFilterObj(null);this.gridstore.load({params:{start:0}})}});Ext.reg("unktraps_tab",cacti.plugin.camm.unktraps_tab);Ext.ns("cacti.plugin.camm");cacti.plugin.camm.settings_grid=Ext.extend(Ext.ux.wam.PropertyGrid,{id:"pg",frame:true,layout:"fit",buttonAlign:"center",initComponent:function(){Ext.apply(this,{store:new Ext.data.GroupingStore({proxy:new Ext.data.HttpProxy({url:"camm_db_admin.php",method:"POST"}),recordType:Ext.ux.wam.PropertyRecord,groupField:"group",remoteSort:true,sortInfo:{field:"text",direction:"DESC"},reader:new Ext.data.JsonReader({id:"name",root:"settings"},Ext.ux.wam.PropertyRecord),baseParams:{task:"camm_get_settings"}}),view:new Ext.grid.GroupingView({forceFit:true,emptyGroupText:"No Group",enableGroupingMenu:false,showGroupName:false,getRowClass:function(a){return(a.data.disabled==true)?"x-item-disabled":""}}),enableColLock:false,layout:"fit",autoExpandColumn:"name",loadMask:true,footer:true,buttons:[{text:"Save",iconCls:"icon-disk",scope:this,disabled:!(is_camm_admin==1),handler:this.commitChanges},{text:"Reload",iconCls:"arrow_refresh",scope:this,disabled:!(is_camm_admin==1),handler:function(){this.store.reload()}},{text:"Reset",iconCls:"icon-undo",scope:this,disabled:!(is_camm_admin==1),handler:function(){this.store.rejectChanges()}}]});cacti.plugin.camm.settings_grid.superclass.initComponent.apply(this,arguments)},onRender:function(){this.store.on({scope:this,datachanged:function(b){var a=this.store.getRange();if(!a.length){return}Ext.each(a,function(d,c){switch(d.data.type){case"date":d.data.value=new Date(Date.parseDate(d.data.value,"Y-m-d H:i:s"));break;case"boolean":d.data.value=Boolean(d.data.value);break;case"combobox":d.data.editor=new Ext.grid.GridEditor(new Ext.form.ComboBox({store:new Ext.data.SimpleStore({fields:["label","value"],data:d.data.editor}),listeners:{select:function(g,e,f){cur_rec=b.getById(d.data.name);if(!Ext.ux.Utility.isNullOrUndefined(cur_rec)){cur_rec.data.r_value=e.data.value}}},editable:false,typeAhead:true,displayField:"label",selectOnFocus:true,triggerAction:"all",forceSelection:true,mode:"local"}));break;case"numberfield":d.data.editor=new Ext.grid.GridEditor(new Ext.form.NumberField({allowDecimals:false,allowNegative:false,maxValue:d.json.max_value}));break}},this)},exception:cacti.plugin.camm.loadexception});this.store.load();cacti.plugin.camm.settings_grid.superclass.onRender.apply(this,arguments)},renderer_crenderer:function(a){return'<span style="color:'+a+';">'+a+"</span>"},commitChanges:function(){var a=this.store.getModifiedRecords();if(!a.length){return}this.getEl().mask("saving");var b=[];Ext.each(a,function(e,d){var f=e.getChanges();f.name=e.get("name");f.r_value=e.get("r_value");b.push(f)},this);var c={url:"camm_db_admin.php",method:"POST",callback:cacti.plugin.camm.requestCallback,scope:this,params:{task:"camm_save_settings",data:Ext.encode(b)}};Ext.Ajax.request(c)}});Ext.reg("SettingsGrid",cacti.plugin.camm.settings_grid);Ext.form.SliderField=Ext.extend(Ext.Slider,{isFormField:true,onRender:function(){Ext.form.SliderField.superclass.onRender.apply(this,arguments);this.nrField=this.el.createChild({tag:"input",type:"text",name:this.name,value:this.value,disabled:true,style:"position: relative; float:right; height:17px; left: 50px; margin-top:-20px; font-size:12px;width:40px;"})},setValue:function(a){if(this.maxValue&&a>this.maxValue){a=this.maxValue}if(a<this.minValue){a=this.minValue}Ext.form.SliderField.superclass.setValue.apply(this,arguments);this.nrField.dom.value=a+"%"},markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn,validate:function(){this.nrField.dom.disabled=false;return true}});Ext.reg("sliderfield",Ext.form.SliderField);cacti.plugin.camm.set_util_tab=Ext.extend(Ext.TabPanel,{closable:false,activeTab:0,initComponent:function(){Ext.apply(this,{items:[{layout:"fit",region:"center",title:"Settings",xtype:"SettingsGrid"},{region:"center",title:"Utils",items:[new Ext.FormPanel({title:"Fast delete rows",Height:150,defaults:{width:365},items:[{xtype:"label",style:"font-size:14px;",text:"Specify how many records (in percentage) to remove from each of the tables"},{fieldLabel:"Syslog",xtype:"sliderfield",value:0,increment:5,minValue:0,maxValue:100},{fieldLabel:"SNMP Trap",xtype:"sliderfield",value:0,increment:5,minValue:0,maxValue:100},{fieldLabel:"SNMP Unknown Trap",xtype:"sliderfield",value:0,increment:5,minValue:0,maxValue:100}]})]}]});cacti.plugin.camm.set_util_tab.superclass.initComponent.apply(this,arguments)},afterRender:function(){cacti.plugin.camm.set_util_tab.superclass.afterRender.apply(this,arguments)}});Ext.reg("set_util_tab",cacti.plugin.camm.set_util_tab);Ext.ns("cacti.plugin.camm");Ext.BLANK_IMAGE_URL="./images/default/s.gif";var MainTabs;var vt_email_test=/^:?([\w\-]+):?(\.[\w]+)*@:?([\w\-]+\.){1,5}:?([A-Za-z]){2,4}:?(:?(\,|\;)\ *:?([\w\-]+)(\.[\w]+)*@:?([\w\-]+\.){1,5}:?([A-Za-z]){2,4})*$/i;Ext.apply(Ext.form.VTypes,{vt_email:function(a){return vt_email_test.test(a)},vt_emailText:'This field should be an e-mail address in the format "user@domain.com"<br> or "user@domain.com; user1@domain.com"<br> or "user@domain.com,user1@domain1.com"',vt_emailMask:/[a-z0-9_\.\-@\;\ \,+]/i});cacti.plugin.camm.showError=function(b,a){Ext.Msg.show({title:a||"Error",msg:Ext.util.Format.ellipsis(b,2300),icon:Ext.Msg.ERROR,buttons:Ext.Msg.OK,minWidth:1230>String(b).length?360:600})};cacti.plugin.camm.loadexception=function(f,d,g,c,b,a){try{var j=Ext.decode(b.responseText)}catch(h){if(camm_start_var.is_camm_admin){if((b.statusText=="OK")&&(b.responseText.search("<br />\n<b>Fatal error</b>:")==0)){cacti.plugin.camm.showError(b.responseText,"Got PHP error from server")}else{if((b.statusText=="OK")&&(b.responseText.search("<br />\n<b>Parse error</b>:")==0)){cacti.plugin.camm.showError(b.responseText,"Got PHP parse error from server")}else{cacti.plugin.camm.showError(b.responseText,"Cannot decode JSON object")}}}else{cacti.plugin.camm.showError("It's like a error!","Cannot decode JSON object")}return}if(!Ext.ux.Utility.isNullOrUndefined(j)){if(true!==j.success){cacti.plugin.camm.showError(j.error||"Unknown error");return}}else{if(!Ext.ux.Utility.isNullOrUndefined(b.statusText)){cacti.plugin.camm.showError(b.statusText)}else{cacti.plugin.camm.showError("Unknown error")}}};cacti.plugin.camm.form_load_fail=function(a,b){try{var d=Ext.decode(b.response.responseText)}catch(c){if(camm_start_var.is_camm_admin){if((b.response.statusText=="OK")&&(b.response.responseText.search("<br />\n<b>Fatal error</b>:")==0)){cacti.plugin.camm.showError(b.response.responseText,"Got PHP error from server")}else{if((b.response.statusText=="OK")&&(b.response.responseText.search("<br />\n<b>Parse error</b>:")==0)){cacti.plugin.camm.showError(b.response.responseText,"Got PHP parse error from server")}else{cacti.plugin.camm.showError(b.response.responseText,"Cannot decode JSON object")}}}else{cacti.plugin.camm.showError("It's like a error!","Cannot decode JSON object")}return}if(!Ext.ux.Utility.isNullOrUndefined(d)){if(true!==d.success){cacti.plugin.camm.showError(d.error||"Unknown error");return}}else{if(!Ext.ux.Utility.isNullOrUndefined(b.response.statusText)){cacti.plugin.camm.showError(b.response.statusText)}else{cacti.plugin.camm.showError("Unknown error")}}};cacti.plugin.camm.requestCallback=function(options,success,response){this.getEl().unmask();MainTabs.getEl().unmask();if(true!==success){cacti.plugin.camm.showError(response.responseText);return}try{var o=Ext.decode(response.responseText)}catch(e){cacti.plugin.camm.showError(response.responseText,"Cannot decode JSON object");return}if(true!==o.success){cacti.plugin.camm.showError(o.error||"Unknown error");return}switch(options.params.task){case"camm_recreate_tree":this.getStore().reload();break;case"camm_delete_syslog_message":this.getStore().reload();break;case"camm_save_rule":var records=this.store.getModifiedRecords();Ext.each(records,function(r,i){if(o.insertIds&&o.insertIds[i]){r.set(this.idName,o.insertIds[i]);delete (r.data.newRecord)}});this.store.commitChanges();this.store.reload();break;case"camm_convert_json_to_sql_string":this.record.set("json_filter",Ext.util.JSON.encode(filterModel.getFilterObj()));this.record.set("sql_filter",o.sql_filter);Ext.getCmp("id_sql_filter_trFld").setValue(o.sql_filter);this.hide();break;case"camm_save_settings":var new_settings=Ext.decode(options.params.data);Ext.each(new_settings,function(setting,i){if(setting.name in camm_start_var){if(typeof(setting.r_value)!="undefined"){eval("camm_start_var."+setting.name+"="+setting.r_value)}else{eval("camm_start_var."+setting.name+"="+setting.value)}}switch(setting.name){case"camm_use_syslog":if(camm_start_var.camm_use_syslog){MainTabs.unhideTabStripItem("syslog_tab_id")}else{MainTabs.hideTabStripItem("syslog_tab_id")}break;case"camm_use_snmptt":if(camm_start_var.camm_use_snmptt){MainTabs.unhideTabStripItem("traps_tab_id");MainTabs.unhideTabStripItem("unktraps_tab_id")}else{MainTabs.hideTabStripItem("traps_tab_id");MainTabs.hideTabStripItem("unktraps_tab_id")}break}},this);this.store.reload();break;case"camm_delete_rule":this.store.reload();break;case"camm_delete_traps":this.store.reload();break;case"camm_delete_unktraps":this.store.reload();break;case"camm_clone_rule":var id=o.last_id;this.store.reload({callback:function(){var pos=this.store.find("id",o.last_id);if(pos>0){var record=this.store.getAt(pos);this.win_addRule.showtab({mode:"edit",rec:record})}},scope:this});break;case"camm_delete_records":Ext.Msg.show({title:"Removal process is completed ",msg:"Removal process is completed.<br>Click Yes to recreate Menu Tree.<br>NO - Only for update data in main grid",icon:Ext.Msg.QUESTION,buttons:Ext.Msg.YESNOCANCEL,scope:this,fn:function(response){if("cancel"==response){return}if("no"==response){if(o.type=="syslog"){var str_id="sysl_tab_sysl_grid_id"}else{if(o.type=="snmptt"){var str_id="trap_tab_trap_grid_id"}}var Grid=Ext.getCmp(str_id);if(!Ext.ux.Utility.isNullOrUndefined(Grid)){Grid.getStore().reload()}}if("yes"==response){if(o.type=="syslog"){var str_id="id_SyslogTGMenu"}else{if(o.type=="snmptt"){var str_id="id_TrapsTGMenu"}}var TGmenu=Ext.getCmp(str_id);if(!Ext.ux.Utility.isNullOrUndefined(TGmenu)){TGmenu.recreate_menu()}}}});break}};function get_cmenu(a){var b=new Ext.menu.Menu({items:[{text:"Delete oldest ...",menu:{defaults:{handler:function(){a.cmenu.cm_action(this.id,"")}},items:['<b class="menu-title">How many of the oldest<br>records will be deleted?</b>',{text:"90%",id:"cm_del_old_90"},{text:"75%",id:"cm_del_old_75"},{text:"50%",id:"cm_del_old_50"},{text:"35%",id:"cm_del_old_20"},{text:"20%",id:"cm_del_old_20"},{text:"10%",id:"cm_del_old_10"},{text:"5%",id:"cm_del_old_05"}]}},{text:"Delete earlier than ...",menu:new Ext.menu.DateMenu({id:"cm_del_old_date",maxDate:new Date(),listeners:{select:{fn:function(d,c){a.cmenu.cm_action("cm_del_dat",c.format("U"))}}}})},"-",{id:"cm_del_all",iconCls:"icon-cancel",text:"Delete ALL",handler:function(){a.cmenu.cm_action(this.id,"")}}]});b.cm_action=function(e,d){if(a.cm_rowIndex>0){var c=a.getStore().getAt(a.cm_rowIndex);Ext.Msg.show({title:"Do you really want to delete records?",msg:"Process of removal may take a long time. During this application may slow.<br>Click Yes to start the process in the background (without waiting for completion).<br>NO - for standart mode with timeout 180 ces.<br>You will be notified of the completion of the process.<br>There is no undo.",icon:Ext.Msg.QUESTION,buttons:Ext.Msg.YESNOCANCEL,scope:this,fn:function(f){if("cancel"==f){return}if("no"==f){MainTabs.getEl().mask("Deleting records ... ")}Ext.Ajax.request({scope:a,url:"camm_db_admin.php",method:"POST",timeout:180000,params:{task:"camm_delete_records",id:c.id,a_id:e,a_v:d},callback:cacti.plugin.camm.requestCallback})}})}};return b}Highcharts.setOptions({global:{useUTC:false}});var cp=new Ext.state.CookieProvider({path:window.location.pathname,domain:window.hostname,expires:new Date(new Date().getTime()+(1000*60*60*24*2))});Ext.state.Manager.setProvider(cp);Ext.onReady(function(){Ext.QuickTips.init();if(Ext.isIE){var b=new Ext.state.CookieProvider({expires:new Date(new Date().getTime()+(1000*60*60*24*7))});Ext.state.Manager.setProvider(b)}Ext.form.Field.prototype.msgTarget="side";Ext.data.Connection.prototype.timeout=60000;Ext.Panel.prototype.titleCollapse=true;RezultPanel=new Ext.ux.PanelBlind({items:[{xtype:"RezultGrid"}]});Ext.apply(Ext.data.Store.prototype,{callback:cacti.plugin.camm.requestCallback,exception:cacti.plugin.camm.loadexception});function c(g,k,f){if(true!==k){cacti.plugin.camm.showError(f.responseText);return}try{var j=Ext.decode(f.responseText)}catch(h){cacti.plugin.camm.showError(f.responseText,"Cannot decode JSON object");return}if(true!==j.success){cacti.plugin.camm.showError(j.error||"Unknown error");return}switch(g.params.task){case"camm_get_start_variable":LoadingIndicator.textContent="Ready to start";camm_start_var=j;is_camm_admin=camm_start_var.is_camm_admin;camm_start_var.is_camm_admin=(camm_start_var.is_camm_admin=="1"?true:false);camm_start_var.camm_date=(camm_start_var.camm_date?new Date(camm_start_var.camm_date).format("Y-m-d H:i:s"):new Date().format("Y-m-d H:i:s"));a();break}if(camm_start_var.count_output_mess>0){d()}}function d(){RezultPanel.items.item(0).getStore().load();MainTabs.showBlind(0)}function a(){if((camm_start_var.camm_startup_tab=="0")&&!(camm_start_var.camm_use_syslog)){camm_start_var.camm_startup_tab="1"}if(((camm_start_var.camm_startup_tab=="1")||(camm_start_var.camm_startup_tab=="2"))&&!(camm_start_var.camm_use_snmptt)){camm_start_var.camm_startup_tab="5"}camm_start_var.camm_tree_menu_width=document.body.clientWidth*(Ext.ux.Utility.isNullOrUndefined(camm_start_var.camm_tree_menu_width)?20:camm_start_var.camm_tree_menu_width)/100;MainTabs=new ux.TabPanel({id:"MainTabs",region:"center",toolbars:[{id:"id2",width:270,align:"right",tbar:[{xtype:"themecyclebutton"},"-",{id:"clock",width:50}]}],plugins:[RezultPanel],deferredRender:true,margins:"2 3 0 3",resizeTabs:true,region:"center",activeTab:camm_start_var.camm_startup_tab,defaults:{autoScroll:true},items:[{xtype:"syslog_tab",defaults:{split:true,layout:"fit"},id:"syslog_tab_id",title:"Syslogs"},{xtype:"traps_tab",defaults:{split:true,layout:"fit"},id:"traps_tab_id",title:"SNMP Traps"},{xtype:"unktraps_tab",defaults:{split:true,layout:"fit"},id:"unktraps_tab_id"},{xtype:"rule_tab",defaults:{split:true,layout:"fit"},id:"rule_tab_id"},{xtype:"stat_tab",id:"stat_tab_id",defaults:{split:true,layout:"fit"}},{xtype:"set_util_tab",id:"set_util_tab_id",title:"Settings & Utils",defaults:{split:true,layout:"fit"},disabled:(!camm_start_var.is_camm_admin)}]});var e=new Ext.Viewport({layout:"border",minWidth:600,items:[new Ext.BoxComponent({region:"north",el:"cacti_north"}),MainTabs,{region:"south",el:"cacti_south",collapseMode:"mini",collapsed:true,split:true,height:100,minSize:100,maxSize:200,collapsible:true,margins:"0 0 2 0"}]});if(!(camm_start_var.camm_use_syslog)){MainTabs.hideTabStripItem("syslog_tab_id")}if(!(camm_start_var.camm_use_snmptt)){MainTabs.hideTabStripItem("traps_tab_id");MainTabs.hideTabStripItem("unktraps_tab_id")}setTimeout(function(){Ext.get("loading-mask").fadeOut({remove:true})},650);cacti.plugin.camm.OpenTabFilter=function(k,n){if(!Ext.ux.Utility.isNullOrUndefined(k)){if(!Ext.ux.Utility.isNullOrUndefined(n)){if(k=="syslog"){var g="syslog_tab_id"}if(k=="snmptt"){var g="traps_tab_id"}var f=MainTabs.items.find(function(q){return q.id==g});if(!Ext.ux.Utility.isNullOrUndefined(f)){MainTabs.setActiveTab(f);var p=f.findById(k+"_tree_menu");if(!Ext.ux.Utility.isNullOrUndefined(p)){var l=p.getRootNode();if(!l.expanded){l.expand()}var m=p.getNodeById("root");if(!m.expanded){m.expand()}var o=m.findChild("text",n.type_id);if(!o.expanded){o.expand()}var j=o.findChild("text",n.host_id);if(n._lvl==3){if(!j.expanded){j.expand()}var h=j.findChild("text",n.evn_id);h.ensureVisible();h.select()}else{j.ensureVisible();j.select()}}}}}}}LoadingIndicator=Ext.get("loading-text");LoadingIndicator.dom.textContent="Loading startup variables";Ext.Ajax.request({url:"camm_db.php",method:"POST",params:{task:"camm_get_start_variable"},callback:c})});